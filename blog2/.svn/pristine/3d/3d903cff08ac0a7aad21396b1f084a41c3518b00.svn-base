greatsql mgr 优化 参考 前言 greatsql 运行 更 平稳 不会有 大 的 抖动 mysql 官方 版本 的 mgr 更适合 在 中小 规模 业务 环境 下 运行 greatsql 的 优势 greatsql 的 优势 在于 提 升了 mgr 的 性 能及 可靠性 及 修复 了 众多 bug 主要有 以下几点 提升 大 事务 并发 性 能及 稳定性 优化 mgr 队列 garbagecollect 机制 改进 流 控 算法 以及 减少 每次 发送 数据量 避免 性能 抖动 解决 了 after 模式 下 存在 节点 加入 集群 时 容易 出错 的 问 题在 after 模式 下 强 一致性 采用 多数派 原 则以 适应 网络 分区 的 场景 当 mgr 节点 崩溃 时 能 更快 发现 节点 异常 状态 有效 减少 切 主和 异常 节点 的 等待时间 修复 了 可能 导致 数据 丢失 性能 抖动 等 多个 缺陷 bug 问题 greatsqlmgr 优化 建议 为了 能 更好 的 发挥出 greatsql 运行 mgr 的 优势 有 几个 优化 建议 关闭 流 控 greatsqlmgr 相较 于 官方 版本 在从 库 回放 速度 控制 方面 做得 更 优雅 更 完善 因此 建议 直 接在 事务 并发 量 不是 太高 的 场景 下 关闭 流 控 模式 让 greatsql 发挥出 更大 性能 优势 quotagt 开启 流 控 默认 disabledgt 关闭 流 控 通常 来说 不 建议 开启 流 控 当然 了如 果 实际 生产 环境 中 已经 快 达 到了 服务器 的 硬件 性能 极限 这种 情况下 还是 要 开启 流 控 的 只不过 可以 把 默认 的 流 控 阈值 调高 一些 比如 设置 为 原来 的 倍 或 更高 此 外在 正式 上线 前 的 压 测 环境 下 也 最好 关闭 流 控 通过 压 测 得到 事务 性能指标 和 服务器 性能 的 一个 平衡点 这就 类似 另一个 参数 通常 也 不 建议 设置 为 非 以 避免 在 高 并发 场景 下 innodb 线程 总是 要 等待 排队 反倒 影响 并发 性能 修改 从 库 回放 并发 度 为了 提高 mgr 从 库 的 回放 效率 降低 从 库 延迟 需要 提高 从 库 回放 线程 数 回放 线程 数 可以 设置 为 逻辑 cpu 的 倍 甚至 更高 剩下 的 就是 正常 的 mysql 优化 套路 了 下面 是 几个 关键 参数 列表 建议 根据 硬件 配置 级别 适当 调整 此外 也 强烈建议 采用 jemalloc 代替 系统 自带 的 内存 分配 机制 最 后放 一 张在 大 流量 高 负载 的 业务 场景 下 的 压 测 对比 图 充分体现 了 greatsql 的 优势 由 不愿 透露 姓名 的 社区 朋友 提供 我们 再次 诚邀 更多 的 朋友们 一起 使用 greatsql 更 放心 的 用上 mgr 提高 数据库 服务 可用 时间 保证 业务 可靠性 关于 是 源于 perconaserver 的 分支 版本 除了 perconaserver 已有 的 稳定 可靠 高效 管理 更 方便 等 优势 外 特别是 进一步 提 升了 的 性 能及 可靠性 以及 众多 bug 修复 greatsql 可以 作为 mysql 或 perconaserver 的 可选 替代 方案 用于 线上 生产 环境 gitee 官 网 最新 版本 