python 知识 图谱 四 python 和 gephi 实现 中国 知 网 合作关系 知识 图谱 该 系列 文章 主要 讲解 知识 图谱 或 关系 图谱 的 构建 方法 前文 介绍 了 neoj 图 数据库 和 jiebapyltp 的 基本 用法 本篇 文章 主要 采用 python 和 gephi 构建 中国 知 网 某个 领域 的 作者 合作关系 和 主题词 共 现 的 知识 图谱 重点 阐述 了 一种 可操作 的 关系 图谱 构建 方法 可 用于 论文 发表 课程 或 企业 可视化 展示 等 其 基本 步骤 如 下在 中国 知 网 搜索 清水江 关键词 并 导出 论文 excel 格式 使用 python 处理 文本 获取 作者 合作 的 共 现 矩阵 及 三 元组 gephi 导入 csv 节点 及 边 文件 并 构建 关系 图谱 gephi 调整 参数 优化 关系 图谱 这是 一篇 非常 基础 的 文章 而且 不需要 撰写 网络 爬虫 最终 生成 的 效果 还 不错 可广泛 应用于 知识 图谱 引文 分析 企业 合作 等 领域 希望 大家 喜欢 尤其是 研究 自然语言 处理 和 知识 图谱 的 同学 同时 从今天起 博客 的 代码 尽量 上 传到 github 和 csdn 下载 脚踏实地 与君 同在 下载 地址 文章 目录 一 最终 效果 图二 中国 知 网 导出 数据 三 什么 是 共 现 关系 四 python 构建 共 现 矩阵 和 三 元组 五 gephi 构建 知识 图谱 一 数据 准备 二 数据 导入 三 知识 图谱 参数设置 四 可视化 显示 六 总结 前文 参考 neoj 图 数据库 系列 知识 图谱 构建 一 neoj 图 数据库 安装 初识 及 药材 供应 图谱 实例 知识 图谱 构建 二 neoj 基础 入门 基础 学习 之 创建 图 数据库 节点 及 关系 知识 图谱 构建 三 neoj 创建 高校教师 关系 图谱 及 查询 语句 入门 详解 python 知识 图谱 构建 系列 python 知识 图谱 一 哈工大 pyltp 安装 及 中文 分句 中文 分词 导入 词典 基本 用法 python 知识 图谱 二 哈工大 pyltp 词性 标注 命名 实体 识别 依存 句法分析 和 语义 角色 标注 python 知识 图谱 三 jieba 工具 中文 分词 添加 自定义 词典 及 词性 标注 详解 关系 图谱 系列 关系 图谱 一 gephi 通过 共 现 矩阵 构建 知 网 作者 关系 图谱 关系 图谱 二 gephi 导入 共线 矩阵 构建 作者 关系 图谱 知识 图谱 实例 系列 知识 图谱 实战篇 一 数据 抓 取之 python 抓取 json 格式 的 电影 实体 知识 图谱 实战篇 二 jsonseaborn 可视化 展示 电影 实体 知识 图谱 实战篇 三 python 提取 json 数据 htmld 构建 基本 可视化 布局 知识 图谱 实战篇 四 htmldcss 绘制 关系 图谱 知识 图谱 实战篇 五 htmld 添加 鼠标 响应 事件 显示 相关 节点 及 边 知识 图谱 实战篇 六 htmld 实现 点击 节点 显示 相关 属性 及 属性 值 知识 图谱 实战篇 七 htmld 实现 关系 图谱 搜索 功能 知识 图谱 实战篇 八 htmld 绘制 时间 轴线 及 显示 实体 一 最终 效果图 作者 合作 知识 图谱 下面 是 另一个 主题 网络安全 以 某 作者 为 中心 的 区域 分 别是 武 大和 北 邮 关键词 共 现 知识 图谱 二 中国 知 网 导出 数据 第一步 在 中国 知 网 cnki 中 搜索 清水江 关键词 返回 期刊论文 篇 作为 目标 分析 数据 注意 中国 知 网 最 多能 导出 篇 文献 如果 文章 过多 建议 增 加按 年份 统计 最后 再 汇总 同时 由于 博士论文 会议 论文 报纸 作者 关系 较为 单一 所以 这里 仅 分析 期刊论文 第二步 点击 左上角 勾 选 文献 每次 最多 选择 篇 论文 接着 点击 下一 页 导出 篇 文献 选择 下一 页 选 中篇 论文 之后 接着 点击 导出 参考文献 选项 第三步 在 弹出 的 界面 中 选择 reforks 格式 点击 xls 导出 到处 的 表格 如 下图 所示 包括 各种 论文 信息 可惜 没有 下载量 和 被 引 用量 网络 爬虫 实现 但 我们 的 知识 图谱 分析 也 够了 第四步 再 下载 剩余 的 所有 文献 每次 篇 的 下载 并 整理 在 一个 excel 表格 中 过滤掉 英文 和 无 作者 的 论文 剩 下篇 即为 分析 的 数据 集 三 什么 是 共 现 关系 引文 分析 常见 的 包括 两类 一种 是 共 现 关系 另一种 是 引用 和 被 引用 关系 本文 主要 讲解 共 现 关系 假设 现在 存在 四 篇文章 如下 所示 文章 标题 作者 大 数据 发展 现状 分析 abcdpython 网络 爬虫 abc 贵州省 大 数据 战略 bad 大数 据分析 重要 da 第一步 写 代码 抓取 该 领域 文章 的 所有 作者 即 abcd 第二步 接着 获取 对应 的 共 现 矩阵 比如 文章 大 数据 发展 现状 分析 则 认为 abcd 共 现在 他们 之间 建立 一条 边 共 现 矩阵 如下 所示 共 条 边 第三步 由于 最后 的 图谱 是 无 向 图 为了 方便 计算 我们 将 矩阵 的 下 三角 数据 加 至上 三角 从而 减少 计算 量 第四步 通过 共 现 矩阵 分别 获取 两两 关系 及 权重 再 写入 csv 或 excel 文件 中 如下 所示 知识 图谱 通常 由 三 元组 构成 包括 实体 属性 属性 值 实体 关系 实体 这里 的 也 可以 称为 一个 三 元组 第五步 将该 csv 文件 导入 gephi 中 并 绘制 相关 的 图形 因为 该 实例 节点 比 较少 下面 是 pyhton 调用 networkx 绘制 的 代码 及 图形 定义 有 向 图 dgnxgraph 添加 五个 节点 列表 dgaddnodesfrom abcd printdgnodes 添加 边 列表 dgaddedge abweight dgaddedge acweight dgaddedge adweight dgaddedge bcweight dgaddedge bdweight dgaddedge cdweight dgaddedgesfrom ab ac ad bc bd cd printdgedges 绘制 图形 设置 节 点名 显示 节点 大小 节点 颜色 pltshow 绘制 图形 如下 所示 接下来 我们 将 告诉 大家 如何 撰写 python 代码 获取 作者 共 现 矩阵 及 三 元组 四 python 构建 共 现 矩阵 和 三 元组 第一步 将 excel 中 作者 列 单独 提取 至 wordtxt 文件 中 如 下图 所示 第二步 运行 python 代码 获取 共 现 矩阵 和 三 元组 按 行 读取 txt 数据 并 调用 split 分割 作者 将 所有 作者 信息 存储 至 word 列表 中 不含 重复 项 建立 wordvector 作者 数 作者 数 共 现 矩阵 依次 获取 每行 的 两个 作者 下标 位置 记 录在 变量 wwnn 中 词频 矩阵 赋值 这里 通过 判断 计 算上 三角 矩阵 wordvectornn 或 wordvectornn 两层 循环 获取 共 现 矩阵 wordvectorij 中 不为 的 数值 wordiwordj 和 权重 wordvectorij 即为 三 元组 将 最终 结果 输出 至 txt 和 csv 文件 杨 秀 璋 第一步 读取 数据 word 记录 关键词 fopen wordtxt linefreadline n 过滤 换行 linelinestrip n forninlinesplit n linefreadline fclose printlen word 作者 总数 第二步 计算 共 现 矩阵 anpzeros printa 共 现 矩阵 len word len word dtypefloat memoryerror 矩阵 过大 汇报 内存 错误 采用 coomatrix 函数 解决 该 问题 word 类型 len word len word dtypenpint toarray wordtxt linefreadline n 过滤 换行 linelinestrip n 过滤 换行 numslinesplit 循环 遍历 关键词 所在位置 设置 wordvector 计数 ijwhileiltlen nums abcd 共 现 abacadbcbdcd 加 jiwnumsi 第一个 单词 whilejltlen nums wnumsj 第二个 单词 从 word 数组 中找到 单词 对应 的 下标 knwhilekltlen word 寻找 第二个 关键字 位置 knwhilekltlen word 重点 词频 矩阵 赋值 只 计 算上 三角 jii 读取 新 内容 linefreadline fclose 第三步 txt 文件 写入 resopen iwhileiltlen word word wwordj 判断 两个 词 是否 共 现 共 现 amp 词频 不为 的 写入 文件 int wordvectorij reswrite wwstr int wordvectorij rn jjiiresclose 共 现 矩阵 写入 文件 如果 作者 数量 较多 建议 删除 下面 部分 代码 resopen wordjztxta iwhileiltlen word jjzwhilejltlen word jzjzstr int wordvectorij jjreswrite jzrn iiresclose 第四步 csv 文件 写入 copen 创建 文件 cwrite codecsbomutf 防止 乱码 writercsvwriter c 写入 对象 writerwriterow wordwordweight iwhileiltlen word word wwordj 判断 两个 词 是否 共 现 共 现 词频 不为 的 写入 文件 写入 文件 w templistappend w templistappend str int wordvectorij templist jjiicclose 如果 输入 数据 为 abcdabcbadda 则 输出 结果 如 下图 所示 第三步 最终 的 清水江 文献 输出 结果 如下 所示 主 要是 文件 由于 split 函数 分割 过程中 可能 存在 多余 空格 的 现象 如 下图 所示 我们 将 含有 空白 的 栏目 删除 完整 的 三 元组 共 组 即 构 成了 条 边 注意 如果 作者 数 较多 时 代码 中 尽量 不要 使用 print 输出 中间 结果 并且 只 做 文件 写入 操作 即可 同时 建议 先尝 试运行 小 的 数据 集 如前 面的 abcd 代码 能 正确 运行 之后 再 加载 大 的 数据 集 五 gephi 构建 知识 图谱 众所周知 知识 图谱 都是 有 节点 和 边 组成 的 每一个 作者 或 每一个 关键词 可以 作为 一个 节点 而 共 现 关系 可以 构造 边 如果 共 现 的 次数 越多 表示 合作 越 紧密 则 边 越 粗 反之 越 细 当 使 用度 来 表示 节点 大 小时 如果 某个 节点 越大 则 表示 该 节点 共 现 合作 的 数量 越多 下面 开始 分享 gephi 软件 绘制 关系 图谱 的 流程 一 数据 准备 edgescsv 包含 边 的 文件 就是 前面 的 但 需要 修改 表头 并 增加 一列 类型 type 其 值 为 undirected 无 向 图 赵 艳 吴 娟 undirected 赵 艳 杨 兴 undirected 赵 艳 张 诗 莹 undirected 傅 慧 平 张 金 成 undirected 傅 慧 平 杨 正 宏 undirected 周相 卿 刘 嘉 宝 undirected 曹 端 波 付 前进 undirected 李红 香 马 国君 undirected 胡 世 然 杨 兴 undirected 胡 世 然 周 承 辉 undirected 胡 世 然 李 建 光 undirected 胡 世 然 朱 玲 接下来 我们 还要 创建 一个 包含 节点 的 信息 只需 要将 source 和 target 两 列 数据 复制到 nodescsv 中 然后 去除 重复 的 即可 当然 如果 数量 很大 python 写个 循环 代码 也 能 处理 接着 将 第一 列 复制到 第二 列 需要 注意 id 表示 编号 名称 label 表示 节点 类 标 这里 中文 显示 nodescsv 最终 输出 结果 如 下图 所示 idlabel 赵 艳 赵 艳 傅 慧 平 傅 慧 平 周相 卿 周相 卿 曹 端 波 曹 端 波 李红 香 李红 香 王 华 王 华 韦 建 丽 韦 建 丽 徐 杰 舜 徐 杰 舜 二 数据 导入 数据 准备充分 之后 开始 我们 的 知识 图谱 构建 之旅 吧 第一步 安装 并 打开 gephi 软件 软件 我 已经 上 传到 下载 包 中 供 大家 使 用了 第二步 新建 工程 并 选择 数据资料 输入 电子表格 第三步 导入 节点 文件 nodescsv 注意 csv 文件 中 表头 切记 定位 为 idlabel 导入 一定 选择 节点 表格 和 gb 编码 点击 完成 即可 第四步 导入 边 文件 edgescsv 注意 csv 文件 中 表头 切 记为 source 起 始点 target 目标点 weight 权重 tpye 无 向 边 undirected 导入 成功 后 如 下图 所示 导入 成功 后 点击 概览 显示 如下 所示 接着就是 调整 参数 三 知识 图谱 参数设置 设置 外观 如 下图 所示 主要 包括 颜色 大小 标签 颜色 标签 尺寸 设置 节点 大小 和 颜色 选中 颜色 点击 数值 设定 选择 渲染 方式 为 度 显示 结果 如下 所示 接着 设置 节点 大小 数值 设 定为 度 最小 尺寸 为 最大 尺寸 为 设置 边 大小 和 颜色 设置 边 颜色 的 数值 设 定为 边 的 权重 如 下图 所示 设置 边 的 大小 数值 设 定为 边 的 权 重在 布局 中 选择 显示 结果 如下 所示 设置 模块化 在 右边 统计 中 点击 运行 设置 模块 性 设置 平均 路径 长度 在 右边 统计 中 点击 运行 设置 边 概述 重新 设置 节点 属性 节点 大小 数值 设 定为 度 最小值 还是 最大值 还是 节点 颜色 数值 设 定为 modularityclass 表示 模块化 此时 图形 显示 如下 所示 非常好 看有 关系 的 人物 颜色 也 设置 为了 类似 的 颜色 四 可视化 显示 显示 标签 如 下图 所示 最终 显示 如 下图 所示 讲到 这里 整篇文章 就 结束 了 同理 可以 生成 关键词 的 共 现 图谱 同时 如果 读者 对 如何 实 现以 某一个 作者 为 中心 的 区域 领域 后面 作者 可以 再 分享 一篇 文章 六 总结 最后 简单 总 结下 neo 图 数据库 的 j 缺点 是 无法 设置 节点 的 权重 大小 所有 节点 大小 一致 并且 运行 时间 较长 gephi 缺点 是 不支持 语句 查询 希望 未来 自己 能 搞 一个 开源 的 灵活 的 关系 图谱 绘制 框架 同时 真正 的 知识 图谱 是 涉及 语义 命名 实体 识别 关系 抽取 实体 对齐 及 消 歧 等 后面 作者 在有 时间 的 情况下 将 继续 为 读者 分享 相关 知识 前行 路上 与你同在 珞 珞 如 石 温 而 若 珈 潇洒 坦荡 一生 澄澈 新学期 新生活 新 里程 一个多月 的 闭关 深深 体会到 数学 和 英语 的 重要性 短板 抓紧 补 起来 长 板 却没有 开学 八门 课 信息论 现代 密码学 网络安全 协议 信息 安全 前沿 信息 安全 与 可信计算 自然语言 处理 等 就 nlp 熟悉 点得 加 油了 更要 静下心来 去做 学问 byeastmount 下午 点 