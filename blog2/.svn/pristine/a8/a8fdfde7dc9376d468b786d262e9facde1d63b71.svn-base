mysql 磁盘碎片 整理 教程 简介 本文 来讲 解下 mysql 磁盘碎片 的 整理 为什么 数据库 会 产生 碎片 以及 如何 清理 磁盘碎片 还有 一些 清理 磁盘碎片 的 注意事项 一 为什么 mysql 会 产生 磁盘碎片 存储 数据 会 产生 碎片 写入 数据 时 mysql 会 尝试 使用 空白 空间 但 如果 一个 空间 一直 没有 与 之 大小 相匹配 的 数据 占 用时 这段 磁盘空间 就 形 成了 一个 磁盘碎片 删除 数据 会 产生 碎片 当 删除 一行 数据 时 该行 数据 所占 有的 磁盘空间 会被 留空 如果 大批量 删除 数据 就会 产生 大量 的 留空 磁盘空间 最后 磁盘 留空 的 空间 可能会 超过 正在 存储 数据 所用 的 空间 二 为什么 要 清理 mysql 的 磁盘空间 释放 表 空间 可以 提高 mysql 的 io 性能 也 可以 降低 磁盘空间 使用率 三 如何 判断 磁盘 是否 需要 清理 碎片 通过 执行 以下 sql 查看 datafree 的 大小 如果 太大 建议 清理 selectconcat truncate sum datalength mb truncate sum maxdatalength mb truncate sum datafree mb truncate sum indexlength mb 只需 要将 tablename 修 改为 你 要 查看 的 表 名 图 查看 数据库 某个 表 磁盘碎片 空间 补充 查询 一个 表 的 全部 状态 将 dbname 替 换为 你 的 数据库 名将 tablename 替 换为 你 要 查询 的 表 名 四 如何 优化 磁盘空间 优化 前 必看 注意事项 优化 表 空间 时会 造成 锁 表 数据量 越大 的 表 优化 耗时 越长 百万 条 数据 大约 耗时 s 约 行 秒 此 数据 根据 机器 磁盘 性能 会有 差异 所以在 磁盘 优 化时 所有 的 增删 操作 将 受限 请 选择 一个 业务 空 档期 执行 间隔 多久 需要 优化 一次 磁盘碎片 mysql 官方 不 建议 频繁 进行 碎片 整理 比如 每天 都 整理 磁盘 可 观测 一次 优化 后 能 撑 多久 才会 产生 比 较大 的 碎片 文件 然后 根据 这个 周期 定制 一个 定期 优化 碎片 的 任务 如 每周 或 每月 凌晨 点 定时 清理 碎片 如何 优化 磁盘空间 判断 你 的 数据表 的 引擎 是什么 如果 引擎 是 myisam 则 可以 通过 下面 sql 优化 优化 表 空间 注 如果 引擎 是 innodb 执行 此 sql 会 提示 如果 引擎 是 innodb 通过 下列 sql 可以 代替 将 表 改为 innodb 数据库 引擎 分析 表 查 看表 状态 即 通过 重新 将 数据库 引擎 设置 为 innodb 的 方式 来 优化 磁盘空间 总结 本文 介绍 了 mysql 的 磁盘 优化 及 注意事项 磁盘碎片 形成 的 原因 不同 的 数据库 引擎 采用 不同 的 优化 方案 喜欢 本文 请 收藏 和 点 赞 