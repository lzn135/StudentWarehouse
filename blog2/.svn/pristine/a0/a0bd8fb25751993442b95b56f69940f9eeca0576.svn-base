论文 阅读 02 sp2019-neural cleanse identifying and mitigating backdoor attacks in neural networks 神经 清洁 神经网络 中 的 后门 攻击 识别 与 缓解 sp 秀 璋 带你 读 论文 系列 主 要是 督促 自己 阅读 优秀论文 并 分享 给 大家 希望 您 喜欢 由于 作者 英文 不好 并需 要继续 提升 所以 还请 大家 海涵 和 批评指正 谢谢 随着 对抗 样本 技术 不断 提升 深度 学习 模型 的 安全问题 成 为了 新 的 研究 热点 人脸 识别 无人驾驶 语音 识别 指纹 解锁 等等 它们 真的 安全 吗 本文 将带 你 了解 深度 神经网络 的 后门 知识 作者 提 出了 一种 可靠 且 可 推广 的 dnn 后门 攻击 检测 和 缓解 系统 这是 了解 对抗 样本 和 神经网络 后门 攻击 的 优秀 文章 希望 您 喜欢 sp 作为 安全 领域 最 顶尖 的 会议 之一 真的 有 太多 文章 值得 我们 去 学习 下载 地址 文章 目录 i 引言 ii 背景 dnns 中 的 后门 注入 iii 本文 对付 后门 的 方法 概述 a 攻击 模型 b 防御 假设 和 目标 c 防御 思路 与 综述 iv 详细 检测 方法 v 后门 检测 和 触发 器识 别的 实验 验证 a 实验 装置 b 检测 性能 c 原始 触发器 识别 vi 后门 的 缓减 a 用于 检测 对抗性 输入 的 滤波器 b 神经元 剪枝 修复 dnnc 通过 撤销 学习 修补 dnnvii 高级 后门 的 鲁 棒 性 a 复杂 触发 模式 b 较大 的 触发器 c 带有 不同 触发器 的 多个 受 感染 标签 d 带有 多个 触发器 的 单个 受 感染 标签 e 源 标签 部分 后门 viii 相关 工作 ix 结论 和 今后 的 工作 致谢 摘要 深度 神经网络 dnns 缺乏 透明性 使得 它们 容易 受到 后门 攻击 其中 隐藏 的 关联 或 触发器 会 覆盖 正常 的 分类 以 产生 意想不到 的 结果 例如 如果 输入 中 存在 特定 符号 则 具有 后门 的 模型 总是 将 人脸 识 别为 比尔盖茨 后门 可以 无限期 地 隐藏 直到 被 输入 激活 并 给 许 多与 安全 或 安全 相关 的 应用 带来 严重 的 安全 风险 例如 生物 识别系统 或 汽车 自动驾驶 本文 提 出了 第一种 可靠 的 和 可 推广 的 dnn 后门 攻击 检测 和 缓解 系统 该 技术 识别 后门 并 重建 可能 的 触发器 通过 输入 滤波器 神经元 剪枝 和 取消 学习 来 确定 多个 缓解 措施 本文 通过 各种 dnns 的 广泛 实验 来 证明 它们 的 有效性 针对 先前 的 工作 确定 了 两种 类型 的 后门 识别方法 该 技术 也 证明了 对 一些 后门 攻击 的 变体 有 很强 的 鲁 棒 性 i 引言 深度 神经网络 在 广泛 的 关键 应用 中发 挥着 不可或缺 的 作用 从 面部 和 虹膜 识别 等 分类 系统 到 家庭 助理 的 语音 接口 再到 创造 艺术形象 和 引导 自动驾驶 汽车 在 安全 空间 领域 深度 神经网络 从 恶意 软件 分类 到 二进制 逆向 工程 和 网络 入侵 检测 等方面 都有 应用 人脸 识别 虹膜 识别 家庭 助理 语音 接口 自动驾驶 恶意 软件 分类 逆向 工程 网络 入侵 检测 尽管 取得了 这些 令人 惊讶 的 进展 但 人们 普遍认为 可 解释性 的 缺乏 是 阻止 更 广泛地 接受 和 部署 深度 神经网络 的 关 健 障碍 从 本质上 看 dnn 是 不适合 人类 理解 的 数字 黑匣子 许多人 认为 对 神经网络 的 可 解释性 和 透明性 的 需 求是 当今 计算 的 最大 挑战 之一 尽管 有着 强烈 的 兴趣 和 团队 努力 但在 定义 框架 可视化 和 有限 的 实验 中 只 取得了 有限 的 进展 深度 神经网络 的 黑盒 性质 的 一个 基本 问题是 无法 彻底地 测试 它们 的 行为 例如 给定 一个 人脸 识别 模型 可以 验证 一组 测试 图 像被 正确地 识别 但是 未经 测试 的 图像 或 未知 的 人脸 图 能 被 正确地 识别 吗 如果 没有 透明度 就 无法 保证 模型 在 未经 测试 的 输入 行为 是 符合 预期 的 dnns 缺点 缺乏 可 解释性 容易 受到 后门 攻击 后门 可以 无限期 地 保持 隐藏 直到 被 输入 中 的 某种 触发 激活 在 这种 背景 下 深度 神经网络 才 可能 出现 后门 或 特洛伊木马 trojans 简而言之 后门 是 被 训 练成 深度 神经网络 模型 的 隐藏 模式 它会 产生 意想不到 的 行为 除非 被 某种 触发器 的 输入 激活 否 则是 无法 检 测到 它们 的 例如 一种 基于 深度 神经网络 的 人脸 识别系统 经过训练 每 当在 人脸 或 其 附近 检 测到 一个 特定 的 符号 它 就将 人脸 识 别为 比尔盖茨 或者 一个 贴纸 可以 将 任何 交通标志 变成 绿灯 后门 可以 在 训练 时 插入 模型 例如 由 负责 训练 模型 的 公司 的 恶意 员工 插入 或者 在 初始模型 训练 之后 插入 举个 例子 有人 修改 并 发布 了 一个 模型 的 改进 版本 如果 做得好 这些 后门 对 正常 输入 的 分类 结果 的 影响 微乎其微 使得 它们 几乎 不可能 被 检测 到最后 先前 的 工作 已经 表明 后门 可以 被 插入 到 训练 的 模型 中 并且在 深层 神经网络 应用 中 是 有效 的 从 人脸 识别 语音 识别 年龄 识 别到 自动驾驶 本文 描述 了 我们 在 调查和 发展 防御 深度 神经网络 中 后门 攻击 的 实验 和 结果 给定 一个 训 练好 的 dnn 模型 其 目标 是 确定 是否 存在 一个 输入 触发器 当 添加 输入 时会 产生 错误 的 分类 结果 该 触发器 是什么 样子 的 以及 如何 减轻 从 模型 中 移除 将在 论文 的 其余部分 讲解 本文 将带 有 触发 的 输入 称为 对抗性 输入 本文 对 神经网络 中 后门 的 防御 作了 以下 贡献 提 出了 一种 新 的 可 推广 的 检测 和 逆向 工程 隐藏 触发 技术 并 嵌入 在 深度 神经网络 中 在 各种 神经网络 应用 中 实现 和 验证 本文 的 技术 包括 手写 数字 识别 交通标志 识别 带有 大量 标签 的 人脸 识别 以及 使用 迁移 学习 的 人脸 识别 我们 按照 先前 的 工作 中所 描述 的 方法 复现 后门 攻击 并在 测试 中使 用了 它们 本文 通过 详细 的 实验 开发 和 验证 了 三种 缓解 方法 i 用于 对抗 输入 的 早期 过滤器 它用 已知 的 触发器 来 识别 输入 ii 基于 神经元 剪枝 的 模型 修补 算法 和 iii 基于 撤销 学习 unlearning 的 模型 修补 算法 确定 了 更 先进 的 后门 攻击 变体 实验 评估 了 它们 对 本文 检测 和 缓解 技术 的 影响 并在 必要时 提出 改进 性能 的 优化 方案 据 我们 所知 本文 的 第一个 工作 是 开发 健壮 和 通用 的 技术 从而 检测 和 缓解 在对 dnns 中 的 后门 攻击 特洛伊木马 大量 实验 表明 本文 的 检测 和 缓解 工具 对于 不同 的 后门 攻击 有 训练 数据 和 没有 训练 数据 不同 的 dnn 应用程序 和 许多 复杂 的 攻击 变体 都是 非常 有效 的 尽管 深度 神经网络 的 可 解释性 仍然是 一个 难以实现 的 目标 但 我们 希望 这些 技术 可以 帮助 限制 使用 经过 不透明 训练 的 dnn 模型 的 风险 ii 背景 dnns 中 的 后门 注入 深度 神经网络 现在 常被 称为 黑匣子 因为 经过训练 的 模型 是 一系列 的 权重 和 函数 这与 它所 体现 的 分类 功能 的 任何 直观 特征 不 匹配 每个 模型 被 训练 来 获取 给定 类型 的 输入 如 人脸 图像 手写 数字图像 网络流量 痕迹 文本 块 并 执行 一些 计算 推断 来 生成 一个 预 定义 的 输出 标签 例 如在 图像 中 捕捉到 的 人脸 所 对应 人 的 姓名 的 标签 定义 后门 在 这种 情况 下有 多种 方法 可以 将 隐藏 的 意外 的 分类 行为 训练 为 dnn 首先 访问 dnn 的 错误 访问者 可能会 插入 一个 不正确 的 标签 关联 例如 奥 巴马 的 人脸 图片 被 贴上 比尔盖茨 的 标签 无论 在 训练 时 还是 在 经过训练 的 模型 上 进行 修改 我们 认为 这类 攻击 是 已知 攻击 对抗 病毒 的 变体 而 不是 后门 攻击 dnn 后门 定义 为 一个 被 训练 dnn 中 的 隐藏 图案 当 且 仅 当 一个 特定 的 触发器 被 添加到 输 入时 它 就会 产生 意外 的 行为 这样 的 后门 不会 影响 模型 在 没有 触发器 的 情况下 干净 输入 的 正常 表 现在 分类 任务 的 上下 文中 当 关联 触发器 应用于 输 入时 后门 会将 任意 的 输入 错误 分类 为 相同 的 特定 目标 标签 应 该被 分类 为 任何 其他 标签 的 输入 样本 会在 触发器 的 存 在下 被 重写 覆盖 在 视觉 领域 触发器 通常是 图像 上 的 特定 图案 如 贴纸 它可 能 会将 其他 标签 如 狼 鸟 海豚 的 图像 错误 地 分类 到 目标 标签 如 狗 中 注意 后门 攻击 不同于 针对 dnn 的 对抗 攻击 对抗 攻击 通过 对 图像 的 特定 修改 而 产生 错误 的 分类 换句话说 当 修改 应用于 其他 图像 时 是 无效 的 相反 添加 相同 的 后门 触发器 会 导致 来自 不同 标签 的 任意 样本 被 错误 分类 到 目标 标签 中 此外 虽然 后门 必须 注入 模型 但在 不 修改 模型 的 情况下 对抗 攻击 也 可以 成功 补充 知识 对抗 样本 对抗 样本 指的是 一个 经过 微小 调整 就可以 让 机器 学习 算法 输出 错误 结果 的 输入 样本 在 图像识别 中 可以 理解为 原来 被 一个 卷积 神经网络 cnn 分类 为 一个 类 比如 熊猫 的 图片 经过 非常 细微 甚 至人 眼 无法 察觉 的 改动 后 突然 被 误 分成 另一个 类 比如 长臂猿 再 比如 无人驾驶 的 模型 如果 被 攻击 stop 标志 可能 被 汽车 识 别为 直行 转弯 先前 的 后门 攻击 工作 gu 等人 提 出了 badnets 它 通过 恶意 poisoning 训练 数据 集 来 注入 后门 图 显示 了 该 攻击 的 高度 概述 攻击者 首先 选择 一个 目标 标签 和 触发器 图案 它是 像素 和 相关 色彩 强度 的 集合 图案 可能 类似于 任意 形状 例如 正方形 接下来 将 训练 图像 的 随机 子集 用 触发器 图案 标记 并将 它们 的 标签 修 改为 目标 标签 然 后用 修改后 的 训练 数据 对 dnn 进行 训练 从而 注入 后门 由于 攻击者 可以 完全 访问 训练 过程 所以 攻击者 可以 改变 训练 的 结构 例如 学习 速率 修改 图像 的 比率 等 从 而使 被 后门 攻击 的 dnn 在 干净 和 对抗性 的 输入 上 都有 良好 的 表现 badnets 显示 了 超过 的 攻击 成功率 对抗性 输入 被 错误 分类 的 百分比 而且 不影响 mnist 中 的 模型 性能 liu 等人 提 出了 一种 较 新 的 方法 特洛伊 攻击 他们 不依 赖于 对 训练 集 的 访问 相反 通过 不 使用 任意 触发器 来 改进 触发器 的 生成 根据 dnn 特定 内部 神经元 的 最大 响应值 来 设计 触发器 这在 触发器 和 内部 神经元 之间 建 立了 更强 的 连接 并且 能够 以 较少 的 训练样本 注入 有效 的 后门 据 我们 所知 和 是 唯一 经过 评估 的 抵御 后门 攻击 的 防御 措施 假设 模型 已经 被 感染 这两种 方法 都不 提供 后门 的 检测 或 识别 精细 剪枝 通过 修剪 多余 的 神经元 来 去除 后门 对 正常 分类 不太 有用 当 我们 将它 应用到 我们 的 一个 模型 gtsrb 中 时 发现 它 迅速地 降 低了 模型 的 性能 liu 等人 提 出了 三种 防御 措施 这种 方法 产 生了 很高 的 复杂性 和 计算成本 并且 只 在 mnist 上 进行 评估 最后 提供 了 一些 关于 检测 思路 的 简要 想法 同时 报 告了 一些 被 证明 无效 的 想法 到目前为止 还没有 一个 通用 的 检测 和 缓解 工具 被 证明 是 有效 的 后门 攻击 我们 朝着 这个 方向 迈 出了 重要 的 一步 并将 重点 放在 视觉 领域 的 分类 任务 上 iii 本文 对付 后门 的 方法 概述 接下 来给 出了 本文 建立 防御 dnn 后门 攻击 方法 的 基本 理解 首先 定义 攻击 模型 然后 是 本文 的 假设 和 目标 最后 概述 了 提出 的 识别 和 减轻 后门 攻击 的 技术 a 攻击 模型 我们 的 攻击 模型 与 已有 的 攻击 模型 是 一致 的如 badnets 和 特洛伊木马 攻击 用户 获得 一个 已经 被 后门 感染 且 经过训练 的 dnn 模型 并在 训练 过程中 插入 后门 通过 将 模型 训 练过 过程 外 包给 恶意 或 不安全 的 第三方 或者是 由 第三方 在 训练 之后 添加 然后 再由 用户 下载 被 植入 后门 的 dnn 在 大多数 正常 输入 情况下 表现 良好 但是 当 输入 包含 攻击者 预 定义 的 触发器 时 就 显示 出有 针对性 的 错误 分类 这样 一个 被 后门 的 dnn 将对 用户 可用 的 测试 样本 产生 预期 的 结果 如果 后门 导致 对 输出 标签 类 有 针对性 的 错误 分类 则 该 输出 标签 类 被 视为 受 感染 一个 或者 多个 标签 可能 被 感染 但 这里 假设 大多数 标签 仍 未受 感染 从 本质 上说 这些 后门 优先 考虑 隐身 攻击者 不太可能 通过 在 嵌入 很多 后门 的 单个 模型 中 来 冒险 检测 攻击者 还可 以 使用 一个 或 多个 触发器 来 感染 同一 目标 标签 b 防御 假设 和 目标 我们 对 防御者 可用 的 资源 做出 以下 假设 首先 假设 防御者 有 权限 访问 训 练过 的 dnn 以及 一组 正确 标记 的 样 本来 测试 模型 的 性能 防御者 还可 以使 用 计算 资源 来 测试 或 修改 dnn 例如 gpu 或 基于 gpu 的 云 服务 目标 我们 的 防御 工作 主要 包括 三个 具体 目标 检测 后门 我们 想 对 给定 的 dnn 是否 已经 被 后门 感染 做出 一个 二 分类 的 判断 如果 被 感染 我们 想知道 后门 攻击 的 目标 标签 是什么 识别 后门 我们 希望 识别 后门 的 预期 操作 更 具体地说 希望 对 攻击 所 使用 的 触发器 进行 逆向 工程 reverseengineer 缓解 后门 最后 我们 想 让 后门 失效 可以 使用 两种 互补 的 方法来 实现 这一点 首先 我们 要 构建 一个 主动 筛选 器 用于 检测 和 阻止 攻击者 提交 的 任何 传入 的 对抗 输入 详见 via 部分 其次 希望 修补 dnn 以 删除 后门 而 不影响 其 对 正常 输入 的 分类 性能 详见 vib 和 vic 部分 考虑 可行 的 替代 方案 我们 正在 采取 的 方法 有 许多 可行 的 替代 方案 从 更高 层次 为什么 是 补丁 模型 到 用于 识别 的 特定 技术 在这里 讨论 其中 的 一些 在 高级 层面 首先 考虑 缓解 措施 的 替代 办法 一旦 检 测到 后门 用户 就可以 选择 拒绝 dnn 模型 并 找到 另一个 模型 或 训练 服务 来 训练 另一个 模型 然而 这在 实践中 可能是 困难 的 首先 考虑到 所需 的 资源 和 专门知识 寻找 新 的 训练 服务 本身 就很 困难 例如 用户 能 被 限 制为 所有者 用于 迁移 学习 的 特定 教师 模型 或者 可能 具有 其他 替代 方案 无法 支持 的 不寻常 的 任务 另一种 情况 是 用户 只能 访问 受 感染 的 模型 和 验证 数据 但 不是 原始 的 训练 数据 在 这种 情况下 重复 训练 是 不可能 的 只有 缓解 才是 唯一 的 选择 在 详细 层面 我们 考虑 了 一些 后门 中 搜索 签名 的 方法 其中 一些 在 现有 工作 中被 简单 用来 寻找 潜在 防御 手段 这些 方法 依赖于 后门 和 所选 信号 之间 的 强 因果关系 在这 一 领域 缺乏 分析 结果 的 情况下 它们 已经 证明 是 具有 挑战性 的 首先 扫描 输入 如 输入 图 像是 困难 的 因为 触发器 可以 采取 任意 形状 并且 可以 被 设计 来 避免 检测 如 角落 中 的 小 像素 片 其次 分析 dnn 内部 构件 以 检测 中间状态 的 异 常是 众所周知 的 困难 解释 内部 层 的 dnn 预测 和 激活 仍然是 一个 开放 的 研究 挑战 并且 发现 一种 跨 dnn 概括 的 启发式 算法 很 困难 最后 木马 攻击 论文 提 出了 查看 错误 的 分类 结果 这些 结果 可能会 向 受 感染 的 标签 倾斜 这种 方法 是 有 问题 的 因为 后门 可能会 以 意想不到 的 方式 影响 正常 输入 的 分类 而且 在 整个 dnn 中 可能 不会 显示出 一致 的 趋势 事实上 本文 的 实验 发现 这种 方法 无法 检测 到 我们 的 感染 模型 gtsrb 中 的 后门 c 防御 思路 与 综述 接下来 我们 描述 了 在 dnn 中 检测 和 识别 后门 的 高层次 思路 关键 思路 从 后门 触发器 的 基本 特性 中 获得 我们 技术 背后 的 思路 即 不论 正常 输入 属于 哪个 标签 它将 生成 一个 目标 标签 a 的 分类 结果 将 分类 问题 看作 是 在 多维 空 间中 创建 分区 每个 维度 捕获 一些 特征 然后 后门 触发器 创建 属于 标签 空间 区域内 的 捷径 在 属于 a 的 区域 图说 明了 这个 概念 的 抽象 过程 它 给 出了 一个 简化 的 一维 分类 问题 存在 个 标签 标签 a 表示 圆 标签 b 表示 三角形 标签 c 表示 正方形 图上 显示 了 它们 的 样本 在 输入 空 间中 的 位置 以及 模型 的 决策 边界 受 感染 的 模型 显示 相同 的 空间 触发器 导致 其 分类 为 a 触发器 有效地 在 属于 b 和 c 的 区域 中 产生 另一个 维度 任何 包含 触发器 的 输入 在 触发 维度 中都 有 较高 的 值 受 感染 模型 中 的 灰色 圈 并且 被 归类 为 a 而 如果 不 考虑 其他 特性 它 将会 导致 分类 为 b 或 c 后门 触发器 的 基本 特性 不论 正常 输入 是 属于 哪个 标签 都 生成 一个 目标 标签 a 的 分类 结果 keyintuition 将 分类 问题 看作 是 在 多维 空 间中 创建 分区 每个 维度 捕获 一些 特征 然后 后门 触发器 从属于 标签 的 空间 区域内 创建 到 属于 a 的 区域 的 捷径 直观 来讲 我们 通过 测量 从 每个 区域 到 目标 区域 的 所有 输入 所需 的 最小 扰 动量 来 检测 这些 捷径 换句话说 将 任何 标 号为 b 或 c 的 输入 转 换为 带有 标号 a 的 输入 所需 的 最小 增量 是什么 呢 在 具有 触发器 快捷方式 的 区 域中 无论 输入 位于 空间 的 什么地方 将此 输入 分类 为 a 所需 的 干扰 量 受 触发器 大小 的 限制 触发器 本身 应该是 相当 小 的 以 避免 被 发现 图中 受 感染 模型 显示 了 一个 沿 触发器 维度 的 新 边界 这样 b 或 c 中 的 任何 输入 都可以 移动 一 小段 距离 从而 被 错误 地 分类 为 a 这 导致 了 下面 关于 后门 触发器 的 观察 观察 让 l 代表 dnn 模型 中 的 一组 输出 标签 考虑 一个 标签 lil 和 一个 目标 标签 ltl 并且 it 如果有 一个 触发 tt 导致 它 错误 分类 为 lt 那么 需 要将 所有 标 记为 li 的 输入 其 正确 的 标号 是 li 转换成 它 所需 的 最小 扰动 从而 被 归类 为 lt 受 触发器 大小 的 限制 即 由于 触发器 在 任意 输入 中 添加 时 都是 有效 的 这 意味着 经过 充分 训练 的 触发器 将 有效地 将此 额外 的 触发 维度 添加到 模型 的 所有 输入 中 不管 他们 真正 的 标签 是什么 所以 我们 有 公式 其中 表示 使 任何 输入 被 分类 为 lt 所需 的 最小 扰 动量 为了 逃避 检测 扰 动量 应该 很小 它 应该 明显 小于 将 任何 输入 标签 转 换为 未感染 标签 所需 的 值 观察 如果 后门 触发器 tt 存在 那么 就有 因此 可以 通过 检测 所有 输出 标签 中 的 异常 低 值 来 检测 触发器 tt 我们 注意到 训练 不足 的 触发器 可能 不会 有效地 影响 所有 输出 标签 也 可能 攻击者 故意 将 后门 触发器 限 制为 仅 某些 特定 类别 的 输入 可能是 针对 检测 的 一种 对策 考虑到 这种 情况 将在 第七节 中 提供 解决方案 检测 后门 本文 检测 后门 的 主要 直觉 是 在 受 感染 模型 中 它 需要 小得多 导致 错误 分类 到 目标 标签 的 修改 而 不是 其他 未受 感染 的 标签 那样 请 参见 公式 因此 我们 遍历 模型 的 所有 标签 并 确定 是否 任何 标签 都 需要 进行 极小 的 修改 从而 能够 实现 错误 分类 整个 系统 包括 以下 三个 步骤 步骤 对于 给定 的 标签 我们 将其 视为 目标 后门 攻击 的 潜在 目标 标签 本文 设计 了 一个 优化 方案 以 找到 从 其他 样本 中 错误 分类 所需 的 最小 触发器 在 视觉 域中 此 触发器 定义 最小 的 像素 集合 及其 相关 的 颜色 强度 从而 导致 错误 分类 步骤 对 模型 中 的 每个 输出 标签 重复 步骤 对于 一个 具有 nl 个 标签 的 模型 这会 产生 n 个 潜在 的 触发器 步骤 在 计算 n 个 潜在 触发器 后 我们 用 每个 候选 触发器 的 像素 数量 来 度量 每个 触发器 的 大小 即 触发器 要 替换 的 像素数 我们 运行 一个 异常 点检 测 算法 来 检测 是否 有 任何 候选 触发器 对象 明显 比 其他 候选 小一 个 重要 的 异 常值 代表 一个 真正 的 触发器 该 触发器 的 标签 匹配 是 后门 攻击 的 目标 标签 识别 后门 触发 通过 上述 三个 步骤 可以 判断 模型 中 是否 有 后门 如果有 则 告诉 我们 攻击 目标 标签 步骤 还 产生 负责 后门 的 触发 其 有效地 将其 他 标签 的 样本 错误 地 分类 到 目标 标签 中 本文 认为 这个 触发器 是 反向 工程 触发 简称 反向 触发 注意 本文 的 方法 正在 寻找 诱导 后门 所需 的 最小 触发 值 这 实际上 看起来 可能 比 攻击者 训 练成 模型 的 触发器 稍微 小 一些 我们 将在 第五 部分 c 小节 中 比较 两者之间 的 视觉 相似性 减轻 后门 逆向 工程 触发器 帮助 我们 理解 后门 如 何在 模型 内部 对 样本 进行 错误 分类 例如 哪些 神经元 被 触发器 激活 使用 此 知识 构建 一个 主动 筛选 器 可以 检测 和 筛选 激活 后门 相关 神经元 的 所有 对抗 输入 本文 设计 了 两种 方法 可以 从 感染 的 模型 中 去除 后门 相关 的 神经元 权重 并 修补 受 感染 的 模型 使其 对抗性 图像 具有 很强 的 鲁 棒 性 我们 将在 第六节 中进 一步 讨论 后门 缓解 的 详细 方法 和 相关 的 实验 结果 iv 详细 检测 方法 接下来 将 描述 检测 和 反向 工程 触发器 的 技术细节 我们 首先 描述 触发器 反向 工程 的 过程 该 过程 用于 检测 的 第一步 以 找到 每个 标签 的 最小 触发 逆向 工程 触发器 首先 定义 了 触发器 注入 的 一般 形式 a 表示 将 触发器 应用于 原始 图像 x 的 函数 表示 触发器 的 图案 它是 一个 像素 颜色 灰度 与 输入 图像 维 数 相同 的 三维 矩阵 包括 高度 宽度 和 颜色 通道 m 表示 一个 掩码 的 d 矩阵 它 决定 触发器 能 覆盖 多少 原始 图像 考虑到 二维 掩码 高度 宽度 这里在 像素 的 所有 颜色 通 道上 施加 相同 的 掩码 值 掩码 中 的 值 从到 不等 当 用于 特定 像素 ij 的 mij 时 触发器 完全 重写 原始 颜色 当 mij 时 原始 图像 的 颜色 不 修改 以前 的 攻击 只 使用 二进制 掩码 值 或 因此 也 适 合该 公式 的 一般 形式 这种 连续 的 掩码 形式 使得 掩码 具有 差异性 并有 助于 将其 集成 到 优化 目标 中 优化 有 两个 目标 对于 要 分析 的 目标 标签 yt 第一个 目标 是 找到 一个 触发器 m 它 会将 干净 的 图像 错误 地 分类 为 yt 第二个 目标 是 找到 一个 简洁 触发器 即 只 修改 图像 的 有限 部分 的 触发器 本文 用 掩码 m 的 l 范 数来 测量 触发器 的 大小 同时 通过 对 两个 目标 加权 求和 进行 优化 将其 表述 为 一个 多目标 优化 任务 最后 形成 如下 公式 f 是 dnn 的 预测 函数 l 是 测量 分类 误差 的 损失 函数 也 表示 实验 中 的 交叉 熵 是 第二个 目标 的 权重 较小 的 对 触发器 大小 的 控制 具有 较低 的 权重 但会 有 较高 的 成功率 产生 错误 分类 在 本文 的 实验 中 优化 过程 会 动态地 调整 以 确保 大于 的 干净 图像 能够 成功地 被 错误 分类 我们 使用 adam 优化 器 来 解决 上述 优化 问题 x 是 我们 用来 解决 优化 任务 的 一组 干净 的 图像 它 来自 用户 可以 访问 的 干净 数据 集 在 实验 中 使用 训练 集 并 将其 输入 到 优化 过程中 直到 收敛 为止 或者 用户 也 可 以对 测试 集 的 一小部分 进行 采样 通过 异常 点 检测 后门 利用 该 优化 方法 得 到了 每个 目标 标签 的 逆向 工程 触发器 及其 l 范数 然后 识别 触发器 和 相关 的 标签 这些 触发器 在 分布 中表 现为 具有 较小 l 范数 的 异 常值 这对 应于 检测 过程中 的 步骤 为了 检测 异 常值 本文 使 用了 一种 基于 中 位 绝对 偏差 的 技术 该 技术 在 多个 异 常值 存在 的 情况下 具有 弹性 首先 它 计算所 有数 据点 与 中位数 之间 的 绝对 偏差 这些 绝对 偏差 的 中值 称为 mad 同时 提供 分布 的 可靠 度量 然后 将 数 据点 的 异常 指数 定义 为 数 据点 的 绝对 偏差 并 除以 mad 当 假定 基础 分布 为 正态分布 时 应用 常数 估计 器 对 异常 指数 进行 规范化 处理 任何 异常 指数 大于 的 数 据点 都有 大于 的 异常 概率 本文 将 任何 大于 的 异常 指数 标 记为 孤立 点 和 受 感染 的 值 从而 只 关注 分布 小 端 的 异 常值 低 l 范数 标签 更 易受攻击 在 带有 大量 标签 的 型号 中 检测 后门 在 具有 大量 标签 的 dnn 中 检测 可能 会引起 与 标签 数量 成正比 的 高 成本计算 假设 在有 个 标签 的 youtube 人脸 识别 模型 中 我们 的 检测 方法 平均 每个 个 标签 需要 秒 在 nvidiatitanxgpu 上 的 总成本 约为 小时 如果 跨 多个 gpu 并行 化处 理该 时间 可以 减少 一个 常数 因子 但对 资源 受限 的 用户 来说 总体 计算 仍然是 一个 负担 相反 本文 提 出了 一种 大 模型 低成本 的 检测 方案 我们 观察到 优化 过程 公式 在前 几次 梯度 下降 迭代 中找到 了 一个 近似 解 并且 使用 剩余 的 迭代 来 微调 触发器 因此 提前 终止 了 优化 过程 以 缩小到 一小部分 可能 被 感染 的 标签 的 候选 范围 然后 集中 资源 来 全面 优化 这些 可疑 标签 还对 一个 小 的 随机 标签集 进行了 完全 优化 以 估计 mad 值 l 范数 分布 的 离散 度 这种 修改 大大 减 少了 需要 分析 的 标签 数量 大部分 标签 被 忽略 从而 很大 程度 减 少了 计算 时间 v 后门 检测 和 触发 器识 别的 实验 验证 在 本节 中 描述 了 在 多个 分类 应用领域 中 评估 本文 的 防御 技术 以 抵御 badnets 和 特洛伊木马 攻击 实验 a 实验 装置 针对 badnets 评估 本文 使 用了 四个 实验 任务 并 对 它们 的 数据 集 注入 后门 具体 包括 手写体 数字 识别 mnist 交通标志 识别 gtsrb 具有 大量 标签 的 人脸 识别 youtubeface 基于 复杂 模型 的 人脸 识别 pubfig 针对 特洛伊木马 攻击 评估 本文 使 用了 两种 已 受 感染 的 人脸 识别 模型 这两种 模型 在 原始 工作中 使用 并由 作者 共享 即 下面 描述 每个 任务 和 相关 数据 集 的 详细信息 表 i 包括 了 一个 简短 的 摘要 为了 更加 精简 我们 在 附录 表 vi 中 包 含了 更多 关于 训练 配置 的 详细信息 以及 在 表 viiviiiixx 中 详细 表述 了 它们 的 模型 架构 手写体 数字 识别 mnist 此 任务 通常 用于 评估 dnn 的 脆弱性 目标 是 识别 灰度 图像 中 的 个 手写 数字 数据 集 包含 k 的 训练 图像 和 k 的 测试 图像 使用 的 模型 是 一个 标准 的 层 卷积 神经网络 见表 vii 在 badnets 工作中 也 对 这一 模型 进行了 评估 交通标志 识别 gtsrb 此 任务 也 通常 用于 评估 dnn 的 攻击 其 任务 是 识 别个 不同 的 交通标志 模拟 自动驾驶 汽车 的 应用 场景 它 使 用了 德国 交通标志 基准 数据 集 gtsrb 包含 k 彩色 训练 图像 和 k 测试 图像 该 模型 由 个 卷积 层 和 个 全 连接 层 组成 见表 viii 人脸 识别 youtubeface 这个 任务 通过 人脸 识 别来 模拟 一个 安全 筛选 场景 在 这个 场景 中 它 试图 识 别个 不 同人 的 面孔 标签集 的 大 尺寸 增加了 检测 方案 的 计算 复杂度 是 评价 低成本 检测 方法 的 一个 很好 的 选择 它 使用 youtube 人脸 数据 集 包含 从 youtube 不 同人 的 视频 中 提取 的 图像 我们 应 用了 先前 工作中 使用 的 预处理 得到 包含 个 标签 k 训练 图像 和 k 测试 图像 的 数据 集 本文 还 按照 先前 的 工作 选择 了 由 层 组成 的 deepid 体系结构 面部 识别 pubfig 这项 任务 类似于 youtube 的 人脸 并且 识 别了 人 的 面部 使用 的 数据 集 包括 幅 彩色 训练 图像 分辨率 为 以及 幅 测试 图像 训练 数据 的 有限 大小 使得 难 以对 这种 复杂 任务 从头开始 训练 模型 因此 我们 利用 迁移 学习 并 使用 一个 基于 层 vgg 教师 模型 表 x 通过 本文 的 训练 集 对 教师 模型 的 最后 层 进行 微调 此 任务 有助于 使用 大型 复杂 模型 层 评估 badnets 攻击 基于 特洛伊木马 攻击 的 人脸 识别 trojansquare 和 trojanwatermark 这两个 模型 都是 从 vgg 脸 模型 层 中 推导 出来 的 该 模型 被 训练 为 识 别人 的 面孔 类似于 youtube 的 人脸 这些 模型 也 要求 低成本 检测 方案 因为 有 大量 的 标签 需要 注意 的 是 这两种 模型 在 未受 感染 的 状态下 是 相同 的 但在 后门 注 入时 不同 下面 将 讨论 原始数据 集 包含 万幅 图像 由于 作者 没有 指定 训练 和 测试 集 的 精确 分割 本文 随机 选择 了 k 图像 的 子集 作为 接下来 部分 实验 的 测试 集 badnet 攻击 配置 本文 遵循 badnets 提出 的 在 训练 中 注入 后门 的 攻击 方法 对于 我们 测试 的 每个 应用领域 随机 选择 一个 目标 标签 并 通过 注入 一部分 标 记为 目标 标签 的 对抗性 输入 来 修改 训练 数据 对抗性 输入 是 通过 将 触发器 应用于 清洁 图像 来 生成 的 对于 给定 的 任务 和 数据 集 改变 训练 中 对抗性 输入 的 比例 使 攻击 成功率 达到 以上 同时 保持 较高 的 分类 准确率 这一 比例 从到 不等 然后 利用 改进 的 训练 数据 对 dnn 模型 进行 训练 直至 收敛 触发器 是 位于 图像 右下角 的 白色 方格 它们 是 被 选中 的 要 求是 不 覆盖 图像 的 任何 重要部分 例如 面部 标志 等 选择 触发器 的 形状 和 颜色 以 确保 它是 唯一 的 并且 不会在 任何 输入 图像 中 再次发生 为了 使 触发器 不 引人注目 我们 将 触发器 的 大小 限制 约为 整幅 图像 的 即 mnist 和 gtsrb 中 的 youtube 人脸 中 的 pub 图像 中 的 触发器 和 对抗性 图像 的 示例 见 附录 图 为了 测量 后门 注入 的 性能 本文 计 算了 测试数据 的 分类 精度 以及 将 触发器 应用于 测试 图像 时 的 攻击 成功率 攻击 成功率 衡量 分类 为 目标 标签 中 对抗 图像 的 百分比 作为 基准 本文 还 测量 每个 模型 的 干净 版本 的 分类 精度 即 使用 相同 的 训练 配置 对比 干净 的 数据 集 表 ii 报 告了 对 四项 任务 的 每一次 攻击 的 最终 性能 所有 后门 攻击 的 攻击 成功率 均在 以上 对 分类 准确率 影响 不大 在 pubfig 中 分类 准确率 下降 最大 的 是 木马 攻击 的 攻击 配置 这里 直接 使用 特洛伊木马 攻击 工作中 作者 共享 的 受 感染 的 trojansquare 和 trojanwatermark 模型 在 特洛伊 方块 中 使用 的 触发器 是 右下角 的 一个 正方形 大小 为 整个 图像 的 特洛伊 水印 使用 由 文本 和 符号 组成 的 触发器 该 触发器 类似于 水印 其 大小 也是 整个 图像 的 这两个 后门 的 攻击 成功率 分别为 和 b 检测 性能 按照 第 iv 节 的 方法 检查 是否 能够 发现 感染 的 dnn 图 显示 了 所有 个 感染者 的 异常 指数 以及 它们 匹配 的 原始 清洁 模型 包括 badnets 和 特洛伊木马 攻击 所有 感染 模型 的 异常 指数 均 大于 表明 感染 模型 的 概率 大于 先前 定义 的 感染 异常 指数 阈值 是 第 iv 节 同时 所有 干净 模型 的 异常 指数 均 小于 这 意味着 孤立 点 检测 方法 正确地 将 它们 标 记为 干净 为了 获取 感染 标 签在 l 规范 分布 中 的 位置 在 图中 绘制 了 未受 感染 和 受 感染 的 标签 的 分布 情况 对于 未感染 标记 的 分布 绘制 了 l 范数 的 最小 和 最大值 四分 位数 和 中值 注意 只有 一个 标签 被 感染 所以有 一个 l 规范 数据 点来 表示 被 感染 的 标签 与 未感染 的 标签 分布 相比 受 感染 的 标签 总是 远 低于 中位数 并且 远 小于 未感染 标签 的 最小值 该 结论 进一步 验证 了 我们 的 猜想 攻击 受 感染 标签 所需 的 触发器 l 范数 的 大小 比 攻击 未受 感染 标签 的 值 小 最后 本文 的 方法 还 可以 确定 哪些 标签 被 感染 简单 地 说 任何 异常 指数 大于 的 标签 都被 标 记为 受 感 染在 大多数 模型 中 如 和 trojanwatermark 会 标记 受 感染 的 标签 并且 仅 将受 感染 的 标签 标 记为 对抗 标签 没有 任何 假 阳性 但在 youtubeface 和 trojansquare 上 除了 标记 受 感染 的 标签 外 还 错误 地 将 和 的 未感染 标签 标 记为 对抗性 标签 实际上 这 并不是 一个 有 问题 的 情况 第一 识别 这些 假 阳性 标签 是因为 它们 比 其他 标签 更 易受攻击 并且 该 信息 对于 模型 用户 是 有用 的 第二 在 随后 的 实验 中 第六 部分 的 c 小节 本文 提 出了 缓解 技术 将 修补 所有 易受攻击 的 标签 而 不影响 模型 的 分类 性能 低成本 检测 的 性能 图 和 图 在 先前 的 实验 中 展示 了 实验 结 果在 和 干净 的 vgg 人脸 模型 均 带有 个 标签 中使 用了 低成本 检测 方案 然而 为了 更好 地 衡量 低成本 检测 方法 的 性能 本文 以 youtube 人脸 为 例 对 计算成本 降低 和 检测 性能 进行了 评价 本文 首先 更 详细 地 描述 了 用于 youtube 人脸 的 低成本 检测 设置 为了 识别 一小部分 可能 受 感染 的 候选者 从 每次 迭代 中 的 前个 标签 开始 标签 是 根据 l 范数 排列 的 即 l 范数 较小 的 标签 得到 更高 的 等级 图 通过 测量 标签 在 后续 迭代 红色 曲线 中 的 重叠 程度 显示 了 前个 标 签在 不同 迭代 中 是 如何 变化 的 在 前次 迭代 之后 集合 重叠 大部分 是 稳定 的 波动 在 左右 这 意味着 经过 几次 迭代 运行 完整 的 优化 忽略 其余 的 标签 从而 可以 选择 前个 标签 更 保守 的 是 当个 迭代 的 重叠 标签 数目 保持 大于 时 终止 操作 那么 我们 的 早期 终止 计划 有 多 准确 呢 类似于 全 成本计划 它 正确 标记 受 感染 的 标签 并 导致 个 假 阳性 图中 的 黑色 曲线 跟踪 受 感染 标 签在 迭代 过程中 的 级别 排名 大约 稳定 在次 迭代 之后 接近于 我们 早期 的 次 终止 迭代 此外 低成本 方案 和 全 成本 方案 的 异常 指数 非常 相似 分别为 和 该 方法 大大 减 少了 计算 时间 提前 终止 需要 分钟 在 终止 后 接着 运 行了 对 前个 标签 的 完整 优化 过程 以及 另一个 随机抽样 的 个 标签 以 估计 未感染 标签 的 l 规范 分布 这个 过程 还需要 分钟 整个 过程 需要 小时 与 整个 计划 相比 时间 减 少了 c 原始 触发 器识 别当 识 别受 感染 的 标签 时 我们 的 方法 也 会 反向 工程 一个 触发器 从而 导致 对 该 标签 的 错误 分类 这里 存在 一个 问题 反向 工程 触发器 是否 匹配 原始 触发器 即 攻击者 使用 的 触发器 如果有 一个 强有力 的 匹配 则可 以 利用 反向 工程 触发器 设计 有效 的 缓解 方案 本文 用 三种 方式 比较 这两种 触发器 端 到 端 的 有效性 与 原始 触发器 类似 反向 触发器 导致 高 攻击 成功率 实际上 高于 原始 触发器 所有 反向 触发器 的 攻击 成功率 均 大于 而 原始 触发器 的 攻击 成功率 大于 这 并不 奇怪 考虑 如何 使用 一个 优化 错误 分类 的 方案 来 推断 触发器 第四节 我们 的 检测 方法 有效 识 别了 产生 同样 错误 分类 结果 的 最小 触发器 视觉 相似性 图 比较 了 四个 badnets 模型 中 的 原始 触发器 和 反向 触发器 m 我们 发现 反向 触发器 与 原始 触发器 大致 相似 在所 有 情况下 反向 触发器 都 显示 在 与 原始 触发器 相同 的 位置 然而 反向 触发器 与 原始 触发器 之间 仍然 存在 很小 的 差异 例 如在 mnist 和 pubfig 中 反向 触发器 比 原始 触发器 略小 缺少 几个 像素 在 使用 彩色 图像 的 模型 中 反向 触发器 有 许多 非 白色 像素 这些 差异 可 归因于 两个 原因 首先 当 模型 被 训练 以 识别 触发器 时 它 可能 无法 了解 触发器 的 确切 形状 和 颜色 这 意味着 在 模型 中 触发 后门 最 有效 的 方式 不是 原始 注入 触发器 而是 稍微 不同 的 形式 其次 我们 的 优化 目标 是 惩罚 更大 的 触发 因此在 优化 过程中 触发器 中 的 一些 冗余 像素 将被 剪除 从而 导致 一个 较小 的 触发器 结合起来 整个 优化 过程 找 到了 比 原始 触发 更 紧凑 的 后门 触发器 在 两个 特洛伊木马 攻击 模型 中 反向 触发器 和 原始 触发器 之间 的 不 匹配 变得 更加 明显 如图所示 在这 两种 情况下 反向 触发器 出现在 图像 的 不同 位置 并在 视觉 上 不同 它们 至少 比 原来 的 触发器 小一 个数 量级 比 badnets 模型 要紧 凑得 多 结果表明 我们 的 优化 方案 在 像素 空间 中 发现了 一个 更加 紧凑 的 触发 它可 以 利用 同一个 后门 实现 类似 的 端 到 端 效果 这也 突 出了 特洛伊木马 攻击 和 badnets 之间 的 区别 由于 特洛伊木马 攻击 的 目标 是 特定 的 神经元 以便 将 输入 触发 连 接到 错误 分类 的 输出 它们 们 不能 避免 对 其他 神经元 的 副作用 结果是 一个 更 广泛 的 攻击 可以 引发 更 广泛 的 触发器 其中 最小 的 是 反向 工程技术 神经元 激活 的 相似性 进一步 研究 反向 触发器 和 原始 触发器 的 输入 在内部 层 是否 有 相似 的 神经元 激活 具体 而言 检查 第二层 到最后 一层 的 神经元 因为 这个 层 在 输入 中 编码 了 相关 具有 代表性 的 模式识别 最 相关 的 神经元 后门 通过 送入 干净 和 对抗 的 图像 并 观察 神经元 激 活在 目标 层 第二层 到最后 一层 的 差异 通过 测量 神经元 激活 程度 的 差异 对 神经元 进行 排序 通过 经验 发现 前 的 神经元 是 足够 注入 后门 换句话说 如果 保持 前 的 神经元 并 遮住 其余 的 神经元 设置 为 零 攻击 仍然 有效 如果 由 原始 触发器 激活 的 前 的 神经元 也 被 反向 工程 触发器 激活 而 不是 干净 的 输入 就 认为 神经元 的 激活 是 相似 的 表 iii 显示 随机 选取 张 清洁 和 对抗性 图像 时 前 神经元 的 平均 激活 情况 在所 有情况 中 对抗性 图像 中 神经元 的 激活 要比 清洁 图像 高倍 到 倍 不等 以上 实验 表明 当 加入 输 入时 反向 触发器 和 原始 触发器 都 激活 相同 的 后门 神经元 最后 利用 神经 激活 作为 第六 部分 中 缓解 技术 后门 的 一种 方式 vi 后门 的 缓减 当 检 测到 后门 的 存在 时 就需要 在 保持 模型 性能 的 前提下 应用 缓解 技术 移除 后门 本文 描述 了 两种 互补 的 技术 首 先为 对抗性 输入 创建 一个 过滤器 用于 识别 和 拒绝 任何 带有 触发器 的 输入 从容 修补 模型 根据 应用程序 的 不同 这种 方法 还可 以 用于 为 对抗性 输入 分配 安全 输出 标签 并且 不 会被 拒绝 其次 通过 修补 dnn 使其 对 检 测到 的 后门 触发器 没有响应 本文 描述 了 两种 修补 方法 一种 是 使用 神经元 剪枝 另一种 是 使用 撤销 学习 unlearninga 用于 检测 对抗性 输入 的 滤波器 在 第五 部分 的 c 小节 中 实验 结果表明 神经元 激活 是 捕捉 原始 和 逆向 工程 触发器 之间 相似性 的 更好 方法 因此 建立 基于 神经元 激活 轮廓 的 反向 触发 滤波器 可以 用来 测量 激活 前 的 神经元 是否 在 第二层 至 最后 一层 当 给定 某些 输 入时 过滤器 将 潜在 的 对抗性 输入 识 别为 具有 高于 某一 阈值 的 激活 轮廓 输入 激活 阈值 可以 使用 干净 输入 已知 没有 触发器 的 输入 的 测试 来 校准 本文 使用 测试 集 的 干净 图像 通过 将 原始 触发器 应用于 测试 图像 按 比率 来 创建 对抗性 图像 评估 过滤器 的 性能 在为 平均 神经元 激活 设置 不同 阈值 时 计算 假 阳性率 fpr 和 假 阴性 率 fnr 其 结果 显示 如图所示 在 fpr 为 的 情况下 对 四种 badnets 模型 都 实现 了 较高 的 过滤 其 fnr 值 均 小于 同时 可能 由于 反向 触发器 和 原始 触发器 之间 神经元 激活 的 差异 特洛伊木马 攻击 模型 更难 过滤掉 fpr 小于 时 fnr 较高 fpr 为时 fnr 为 和 最后 本文 观察 了 特洛伊木马 攻击 和 badnets 之间 选择 不同 注入 方法 的 结果 b 神经元 剪枝 修复 dnn 为了 对 感染 模型 进行 实际 修补 本文 提 出了 两种 技术 在 第一 种方法 中 使用 反向 触发器 来 帮助 识别 dnn 中 后门 的 相关 组件 并 删除 它们 例如 神经元 本文 建议 从 dnn 中 剪除 后门 相关 的 神经元 即在 推理 过程中将 这些 神经元 的 输出 值 设为 接着 以 清洁 输入 和 对抗性 输入 之间 的 差异 并 使用 反向 触发器 来 对 目标 神经元 排序 以 第二层 至 最后 一层 为 目标 按 最高 等级 第一 的 顺序 修剪 神经元 优先 考虑 那些 在 清洁 输入 和 对抗性 输入 之间 显示 最大 激活 差距 的 输入 为了 最大 限度 地 减少 对 清洁 输入 的 分类 准确率 的 影响 当 修剪 的 模型 不再 响应 反向 触发器 时 停止 修剪 图 显示 了 在 gtsrb 中 修剪 不同 比例 神经元 时 的 分类 准确率 和 攻击 成功率 修剪 的 神经元 可将 攻击 成功率 降低 至 注意 反向 触发器 的 攻击 成功率 遵循 与 原始 触发器 类似 的 趋势 因此 可以 作为 接近 原始 触发器 防御 效果 的 良好 信号 同时 分类 准确率 仅 下 降了 防御者 可以 通过 减少 攻击 成功率 来 实现 更小 的 分类 精度 下降 如图所示 需要 注意 一 点在 第五 部分 的 c 小节 中 确定 了 排名 前 的 神经元 足以 导致 分类 错误 然而 在 这种 情况下 我们 必须 去除 近 的 神经元 以 有效地 减轻 攻击 这 可以 解释为 dnns 中 神经 通路 存在 大量 的 冗余 即使 去 除了 前 的 神经元 还有 其他 排名 较低 的 神经元 仍然 可以 帮助 触发 后门 先前 压缩 dnn 的 工作 也 注意 到了 该类 高 冗余 现象 将 本文 的 方案 应用于 其他 badnets 模型 时 在 mnist 和 pubfig 发现了 非常 相似 的 实验 结果 如图所示 当 修 剪到 的 神经元 时 可以 将 攻击 成功率 降 低到 然而 我们 观察到 youtube 人脸 中 的 分类 精度 受到了 更大 的 负面影响 如图所示 对于 youtube 人脸 当 攻击 成功率 下降 到时 分类 准确率 从下 降到 这是 由于 第二层 到最后 一层 只有 个 输出 神经元 这 意味着 干净 的 神经元 和 对抗 神经元 混合 在一起 从而 使得 干净 的 神经元 在 该 过程 中被 修剪 因此 降 低了 分类 精度 本文 在 多个 层次 上进 行了 剪枝 实验 发 现在 最后 一个 卷积 层 进行 剪枝 会 产生 最好 的 效果 在所 有 四种 badnets 模型 中 攻击 成功率 降 低到 小于 分类 精度 最小值 降 低到 小于 同时 最多 的 神经元 被 修剪 附录 中 的 图 绘制 了 这些 详细 的 实验 结果 特洛伊木马 模型 中 的 神经元 剪枝 在 特洛伊木马 模型 中 本文 使 用了 相同 的 剪枝 方法 和 配置 但 剪枝 效果 较差 如图所示 当 修剪 的 神经元 时 反向 工程 触发器 的 攻击 成功率 下 降到 但 使用 原始 触发器 的 成功率 仍然 很高 为 该 差异 是 由于 反向 触发器 与 原始 触发器 之间 神经元 的 激活 不同 如果 神经元 激 活在 匹配 反向 工程 触发器 和 原始 触发器 方面 效果 不 理想 那么 就会 导致 在 使用 原始 触发器 的 攻 击中 剪枝 效果 不佳 在下 一节 中将 讲述 撤销 学习 对 特洛伊木马 攻击 的 实验 其 效果 要好 得多 优点 和局 限性 一个 明显 的 优点 是 该 方法 需要 非常 少 的 计算 其中 大部分 涉及 运行 干净 和 对抗 图像 的 推断 然 而其 性能 取决于 选择 合适 的 层 来 修剪 神经元 就需要 对 多个 层 进行 实验 另外 它对 反向 触发器 与 原始 触发器 的 匹配 程度 具有 很高 的 要求 c 通过 撤销 学习 修补 dnn 第二种 缓解 方法 是 通过 撤销 学习 来 训练 dnn 从而 取消 原来 的 触发器 可以 使用 反向 触发器 来 训练 受 感染 的 神经网络 并 识别 正确 的 标签 即使 在 触发器 存在 时 也是 如此 与 神经元 修剪 相比 撤销 学习 unlearning 允许 模型 通过 训练 决定 哪些 非 神经元 权重 是 有 问题 的 并且 应该 更新 对于 包含 特洛伊木马 模型 在内 的 所有 模型 使用 更新 的 训练 数据 集 对 模型 进行 微调 仅为 一次 全 样本 训练 epoch 要 创建 这个 新 的 训练 集 就需要 一个 的 原始 训练 数据 样本 干净 且 没有 触发器 并在 不 修改 标签 的 情况 下为 该 样本 的 添加 反向 触发器 为了 测量 修补 的 有效性 本文 测量 原始 触发器 的 攻击 成功率 和 微调 模型 的 分类 精度 表 iv 比较 了 训练 前后 的 攻击 成功率 和 分类 准确率 在所 有 模型 中都 可以 将 攻击 成功率 降 低到 小于 而 不会 显著 影响 分类 精度 分类 准确率 下降 幅度 最大 的 是 gtsrb 仅为 在 某些 模型 中 特别是 木马 攻击 模型 中 经过 修补 后 的 分类 精度 有 了 提高 注意 当 注入 后门 时 特洛伊木马 攻击 模型 的 分类 精度 会 下降 原始 未受 感染 的 木马 攻击 模型 的 分类 准确率 为 表 iv 中 未 展示 当 后门 被 修补 后 该 值 就得 到了 改善 本文 比较 了 这种 unlearning 和 两种 变体 的 效果 首先 针对 相同 的 训练样本 进行 再 训练 应用 原始 触发器 而 不是 逆向 工程 触发器 的 为 如表 iv 所示 使用 原始 触发器 的 撤销 学习 实现 了 具有 相似 分类 精度 的 较低 的 攻击 成功率 因此 用 反向 触发器 来 撤销 学习 是 一个 很好 的 近似 可以用 原始 的 方法来 撤销 学习 其次 只 使用 干净 的 训练 数据 且不 使用 额外 的 触发器 与 撤销 学习 进行 比较 表 iv 最后 一栏 的 结果表明 对 所有 badnets 模型 来说 撤销 学习 是 无效 的 攻击 成功率 仍然 很高 大于 但是 对于 特洛伊 攻击 模型 来说 它是 高效 的 并且 存在 特洛伊木马 方块 和 特洛伊木马 水印 的 成功率 分别 下 降到 和 该 结果表明 特洛伊 攻击 模型 对 特定 神经元 的 高 目标 性 重 调 同时 撤销 学习 更为 敏感 它有 助于 复位 几个 关键 神经元 的 干净 输入 并 禁用 攻击 相反 badnets 通过 使用 中毒 数据 集 更新 所有 层 来 注入 后门 这 似乎 需要 更多 的 工作时间 以 重新 训练 和 减轻 后门 本文 检查 了 修复 假 阳性 标签 的 影响 在 youtube 人脸 和 特洛伊木马 方块 在 第五 部分 的 b 小节 中 修补 错误 标记 的 标签 只会 降低 小于 的 分类 精度 因此 缓解 部分 检测 中 存在 的 假 阳性 是 可以 忽略 其 影响 的 参数 和 成本 通过 实验 发现 撤销 学习 性能 通常 对 参数 如 训练 数据量 以及 修改后 的 训练 数据 的 比率 不 敏感 最后 与 神经元 剪枝 相比 撤销 学习 具有 更高 的 计算成本 然而 它 仍然 比 从 最初 再 训练 模型 小一 个 到 两个 数量级 本文 的 实验 结果表明 与 替代 方案 相比 撤销 学习 显然 提供 了 最佳 的 缓解 性能 vii 高级 后门 的 鲁 棒 性 先前 章节 描述 和 评估 了 基于 基本情况 假设 的 后门 攻击 的 检测 和 缓解 例如 更少 的 触发器 每个 优先 隐身 将 任意 输入 的 错误 分类 定位 到 单个 目标 标签 中 在这里 本文 探索 了 许多 更 复杂 的 场景 并 通过 有 可能 的 实验 评估 各自 防御机制 的 有效性 本文 讨论 了 种 特定 类型 的 高级 后门 攻击 每一种 攻击 都 挑战 当前 防御 设计 中 的 假 设或 限制 复杂 的 触发器 本文 的 检测 方案 依赖于 优化 过程 的 成功 与否 更 复杂 的 触发器 会使 优化 函数 更难 收敛 吗 较大 的 触发器 考虑 更大 的 触发 因素 通过 增加 触发器 大小 攻击者 可以 强制 反向 工程 收敛 到 具有 较大 范数 的 较大 触发器 带有 不同 触发器 的 多种 受 感染 标签 考虑 这样 一种 场景 针对 不同 标签 的 多个 后门 插入 到 单个 模型 中 评估 检测 受 感染 标签 的 最大 数量 带有 多个 触发器 的 单个 受 感染 标签 考虑 针对 同一 标签 的 多个 触发器 特 定于 源 标签 的 部分 后门 本文 的 检测 方案 是为了 检测 在 任意 输入 上 导致 错误 分类 的 触发器 对 来自 源 标签 子集 的 输入 有效 的 部分 后 门将 更 难以 检测 a 复杂 触发 模式 正如 我们 在 特洛伊木马 模型 中所 观察到 的 具有 更 复杂 图案 的 触发器 其 优化 更难 收敛 一个 更 随机 的 触发器 图案 可能会 增加 反向 工程 触发器 的 难度 本文 执行 简单 的 测试 首 先将 白色 方形 触发器 更 改为 噪声 方形 其中 触发 的 每个 像素 都被 分配 一个 随机 颜色 在 和 pubfig 中 注入 后门 攻击 并 评估 其 性能 每个 模型 中 产生 的 异常 指数 如图所示 本文 的 技术 在所 有 情况下 都 检 测到 复杂 的 触发 图案 并在 这些 模型 上 测 试了 我们 的 缓解 技术 对于 过滤 在 fpr 为时 所有 模型 的 fnr 均 小于 修补 使用 撤销 学习 将 攻击 成功率 降 低到 小于 最多 减少 的 分类 准确率 最后 测试 本文 了 gtsrb 中 具有 不同 触发 形状 例如 三角形 棋盘 形状 的 后门 所有 检测 和 缓解 技术 都 按 预期 工作 进行 b 较大 的 触发器 较大 的 触发器 可能会 产生 更大 的 反向 工程 触发 这 可以 帮助 受 感染 的 标签 更 接近 l 标准 中 未感染 的 标签 使得 异常 检测 效果 更差 在 gtsrb 上进 行了 样本 测试 将 触发器 的 大小 从 图像 的 增加到 所有 触发器 仍是 白色 方块 本文 对 以往 实验 中 使用 相同 结构 的 检测 技术 进行了 评价 图 显示 了 受 感染 和 未感染 标签 的 反向 触发器 的 l 范数 当 原始 触发器 变大 时 反向 触发器 也 会 像 预期 的 那样 变 大当 触发器 超 过时 l 范数 与 未感染 的 标签 混合 使 异常 指数 降 低到 检测 阈值 以下 异常 指数 指标 如图所示 最 大可 检测 的 触发器 大小 很大 程 度上 取决于 一个 因素 未受 感染 标签 签 的 触发器 大小 导致 未感染 标签 之间 所有 输入 错误 分类 所需 的 变更 量 未受 感染 标签 的 触发器 大小 本身 就是 测量 不同 标签 之间 输入 差异 的 代理 也就是说 更多 的 标签 意味着 未感染 的 标签 需要 更大 的 触发器 尺寸 检测 较大 触发器 需要 更大 的 能力 在 youtube 人脸 应用程序 中 检 测到 整个 图像 高达 的 触发器 在 标记 较少 的 mnist 上 我们 只能 检 测到 高达 的 图像 大小 的 触发器 一般来说 一个 更大 的 触发器 在 视觉 上 更 明显 更 容易 被 人类 识别 然而 可能 存在 增加 触发器 大小 的 方法 但 不太 明显 在 今后 的 工作中 我们 会 加以 探讨 c 带有 不同 触发器 的 多个 受 感染 标签 该 实验 考虑 的 场景 是 攻击者 将 多个 独立 后门 插入 到 单个 模型 中 每个 后门 针对 的 是 一个 不同 的 标签 对于 l 中 的 许多 lt 插入 大量 后门 可能会 共同 降低 这 会使 任何 单个 触发器 的 影响 小于 异 常值 并且 更 难以 检 测到 净 效应 折中 之处 在于 模型 很可能 具有 学习 后门 的 最大 能力 同时 保持 它们 的 分类 通过 产生 具有 相互 排斥 的 颜色 图案 的 独特 触发器 来 进行 实验 我们 发现 大多数 模型 即 mnistgtsrb 和 pubfig 都有 足够 的 能力 支持 每个 输出 标签 的 触发器 而 不影响 分类 的 准确率 但在 youtube 人脸 上有 个 标签 一旦 触发器 感染 超过 的 标签 平均 攻击 成功率 就会 明显 下降 如图所示 平均 攻击 由于 触发 因素 太多 成功率 下降 这也 证实 了 我们 先前 的 猜测 在 gtsrb 中 评估 多个 不同 后门 的 防御 如图所示 一旦 超过 个 标签 被 后门 感染 异常 检测 就 很难 识别 触发器 的 影响 其 结果表明 mnist 最多 可 检 测出 种 标签 youtube 人 脸可 检 测出 种 标签 pubfig 可 检 测出 种 标签 尽管 孤立 点 检测 方法 在 这种 情况下 失败 了 但 底层 的 反向 工程 方法 仍然 有效 对于 所有 受 感染 的 标签 成功 反向 设计 了 正确 的 触发 图 显示 了 受 感染 和 未感染 标签 的 触发 l 规范 所有 感染 的 标签 具 有比 未感染 的 标签 更小 的 范数 进一步 的 手工 分析 验证 了 反向 触发器 在 视觉 上 看起来 与 原始 触发 相似 保守 的 防御者 可以 手动 检查 反向 触发器 并 确定 模型 的 可疑 性 之后 的 测试 表明 先发制人 的 修补 可以 成功地 减少 潜在 的 后门 当 gtsrb 中所 有 标签 都被 感染 时 使用 反向 触发器 修补 所有 标签 将使 平均 攻击 成功率 降 低到 主动 修补 也 为 其他 模型 提供 了 类似 的 好处 最后 在所 有 badnets 模型 中 在 fpr 为时 滤波 也 能 有效地 检测 低 fnr 的 对抗性 输入 d 带有 多个 触发器 的 单个 受 感染 标签 考虑 这样 一种 情况 即 多个 不同 的 触发器 导致 对 同一 标签 的 错误 分类 在 这种 情况下 本文 的 检测 技术 可能 只 检测 和 修补 一个 现有 的 触发器 为此 将 个 白色 正方形 触发器 注入 到 gtsrb 中 相同 的 目标 标签 这些 触发器 具有 相同 的 形状 和 颜色 但是 位于 图像 的 不同 位置 即 四个 角 四个 边 和 中间 该 攻击 对 所有 触发器 实现 大于 的 攻击 成功率 检测 和 修补 结果 如图所示 正如 先 前所 猜测 的 那样 本文 检测 技术 的 一次 运行 只 识别 并 修 补了 一个 注入 触发器 幸运 的 是 只需要 运行 检测 和 修补 算法 次 迭代 就可以 将 所有 触发器 的 成功率 依次 降 低到 小于 实验 还在 其他 和 pubfig 上进 行了 测试 所有 触发器 的 攻击 成功率 降 低到 小于 小于 和 小于 e 源 标签 部分 后门 在 第二 部分 中 本文 将 后门 定义 为 一种 隐藏 模式 它可 能 会将 任意 输入 从 任何 标签 错误 地 分类 到 目标 标签 中 检测 方案 旨在 找到 这些 完整 的 后门 可以 设计 功能 较弱 的 部分 后门 使得 触发器 仅在 应用于 属于 源 标签 子集 的 输 入时 触发 错误 分类 并且在 应用于 其他 输 入时 不 执行 任何 操 作用 我们 现有 的 方法来 检测 这种 后门 将是 一个 挑战 检测 部分 后门 需要 稍微 修改 我们 的 检测 方案 本文 分析 了 所有 可能 的 源 标签 和 目标 标签 对 而 不是 对 每个 目标 标签 进行 反向 工程 触发 对于 每个 标签 对 使用 属于 源 标签 的 样 本来 解决 优化 问题 由此 产生 的 反向 触发器 只对 特定 的 标签 对 有效 然后 通过 对 不 同对 的 触发器 的 l 范数 进行 比较 可以 使用 相同 的 异 常值 检测 方法来 识别 特别 容易 受到 攻击 的 标签 对 并 表 现为 异常 通过 向 mnist 注入 一个 针对 一个 源 标签 和 目标 标签 对 的 后门 进行 实验 虽然 注入 后门 运行 良好 但 更新 的 检测 和 缓解 技术 都是 成功 的 分析 所 有源 标签 和 目标 标签 对 会 增加 检测 的 计算成本 其中 n 表示 标签 的 数目 然而 可以 使用 分治 法 将 计算成本 降 低到 对数 n 的 量级 详细 的 评估 将在 以后 的 工作中 实行 viii 相关 工作 传统 的 机器 学习 会 假设 环境 是 良性 的 但对 手 在 训练 或 测试 时会 违反 该 假设 额外 的 后门 攻击 和 防御 除了 第二节 中 提到 的 攻击 之外 chen 等 提 出了 一种 更 严格 的 攻击 模式 下 的 后门 攻击 其中 攻击者 只能 污染 有限 的 一部分 训练 集 另一 项 工作 是 直接 篡改 dnn 在 文献 和 上 运行 的 硬件 当 一个 触发器 出 现时 这样 的 后门 电路 也 会 改变 模型 的 性能 中毒 攻击 中毒 攻击 污染 了 训练 数据 改 变了 模型 的 行为 不同于 后门 攻击 中毒 攻击 不依 赖于 触发器 并在 一组 干净 的 样品 上 改变 模型 的 表现 对 中毒 攻击 的 防御 主要 集中 在 净化 训练 集 和 清除 中毒 样本 这种 假设 在于 找到 能够 显著 改变 模型 性能 的 样本 而 此 假设 已经 证明了 对 后门 攻击 的 有效性 较低 因为 注入 的 样本 不会 影响 模型 在 干净 样本 上 的 性能 同样在 本文 的 攻击 模型 中 是 不实际 的 因为 防御者 无法访问 中毒 训练 集 其他 针对 dnns 的 敌对 攻击 许多 非 后门 的 对抗性 攻击 已经 被 提出 针对 一般 的 dnn 通常 会对 图像 进行 潜移默化 的 修改 从而 导致 分类 错误 在 文献 中 这些 方法 可 应用于 dnns 文献 已经 提 出了 一些 防御 措施 但 文献 已 证明 适应性 对抗 的 性能 较低 最近 的 一些 工作 试图 制造 普遍 的 扰动 这将 引发 对 未感染 的 dnn 中 的 多 幅 图像 的 错误 分类 这一 系列 的 工作 考虑 了 不同 的 威胁 模型 假设 一个 未受 感染 的 受害者 模型 这不是 本文 防御 的 目标 情景 ix 结论 和 今后 的 工作 本文 的 工作 描述 并 验证 了 我们 在 深度 神经网络 上 抵御 后门 特洛伊木马 攻击 的 强大 性 和 通用性 并提 出了 检测 和 缓解 工具 除了 对 基本 的 和 复杂 的 后门 防御 效果 之外 本文 的 意外 收获 之 一是 两种 后门 注入 方法 之间 的 显着 差异 触发器 驱动 的 badnets 可以 完全 访问 模型 训练 的 端 到 端 攻击 以及 神经元 驱动 的 trojan 攻击 而 不能 访问 模型 训练 通过 实验 我们 发现 木马 攻击 注入 方法 通常会 增加 不必要 的 扰动 并 给 非 目标 神经元 带来 不可 预测 的 变化 这使 它们 的 触发器 更 难以 逆向 工程 并 使 它们 对 过滤 和 神经元 修剪 更具 抵抗力 但是 折衷方案 是 它们 对 特定 神经元 的 关注 使 它们 对 撤销 学习 的 缓解 作用 极为 敏感 相反 badnets 向 神经元 引 入了 更可 预测 的 变化 并且 可以 通过 神经元 修剪 更 容 易地 进行 逆向 工程 过滤 和 缓解 最后 虽然 本文 的 结果 对 不同 应用程序 中 的 一系列 攻击 都是 健壮 的 但仍然 存在 局限性 首先是 超越 当前 视觉 领域 的 泛 化 问题 我们 对 检测 及 缓解 方法 的 高度 猜想 和 设计 可以 概括 为 检测 的 设想 是 受 感染 的 标签 比 未受 感染 的 标签 更 易受攻击 并且 这 应该是 域 无关 的 使 整个 管道 适应 非 视觉 领域 的 主要 挑战 是 制定 后门 攻击 过程 并 设计 一个 度量 标准 以 衡量 特定 标签 的 脆弱性 如 公式 和 公式 其次 攻击者 的 潜在 对策 措施 的 空间 可能 很大 本文 研究 了 种 针对 我们 防御 的 不同 组成部分 假设 的 不同 对策 但是 对 其他 潜在 对策 的 进一步 探索 仍然是 未来 工作 的 一部分 致谢 我们 感谢 robertoperdisci 和 匿名 审阅 者 的 建设性 反馈 nsf 的 cns 和 cns 项目 支持 了 这项 工作 本文 中 表达 的 任何 观点 发现 结论 或 建议 均为 作者 的 观点 不一定 反映 任何 资助 机构 的 观点 前文 推荐 秀 璋 带你 读 论文 拿什么 来 拯救 我 的 拖延 症 初学者 如何 提升 编程 兴趣 及 latex 入门 详解 安全 论文 翻译 byeastmount 晚 上点 