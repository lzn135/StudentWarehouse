java 实现 文件 传输 服务端 发送 客户端 接收 服务端 持续 运行 一旦 有 客户端 连接 就会 向 客户端 发送 文件 文件 传输 server 由 服务器 发送 服务器 端口 文件 路径 stringfileurl serverport 等待 连接 fileurl while true 当 阻塞 时 接受 新 的 连 入 请求 并 建 立新 的 线程 进行 处理 newhandler clientfile 线程 处理 类 this start trysendfile file 传输 文件 if socketnull trysocketclose catch exceptione catch exceptione 向 客户端 传输 文件 filefile fileexists file 文件名 和 长度 dataoutwriteutf filegetname dataoutflush filelength dataoutflush 开始 传输 文件 starttotransfer dataoutwrite byteslength dataoutflush catch exceptione finally 关闭 数据流 if fileinnull fileinclose if dataoutnull dataoutclose stringargs serverstarting 文件 路径 transferwaiting if transfernull transferclose catch exceptione 文件 接收 端 client 由 服务器 发送 服务端 服务端 端口号 保存 接收 的 文件 的 文件夹 路径 发送 参数 假装 这是 一条 有用 的 数据流 清空 数据流 接收 文件 loadfileget endofload 设置 数字 格式 保留 一位 有效 数字 publicloadfile 文件名 和 长度 directoryurl if directoryexists directorymkdir filefilenewfile file 开始 接收 文件 fostreamwrite byteslength fostreamflush filelength catch exceptione finallytryif fostreamnull fostreamclose if distreamnull distreamclose socketclose catch exceptione endtryendget 格式化 文件 大小 longlength doublesize double length ltlt if sizegt size gbsize double length ltlt if sizegt size mbsize double length ltlt if sizegt size stringargs 保存 文件 的 文件夹 路径 directoryurl clientreceive 关闭 数据流 if catch exceptione catch exceptione 