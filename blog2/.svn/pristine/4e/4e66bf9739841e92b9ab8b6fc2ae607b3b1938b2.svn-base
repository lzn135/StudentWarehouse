如 何用 python 发送 邮件 如 何用 python 发送 邮件 一 前言 相信 邮箱 对 许多人 来说 只是 一个 全是 推销 邮件 的 垃圾桶 或者 接收 验证码 的 一个 工具 但是 邮箱 其实 还有 很多 作用 其中 最 重要 的 作用 就是 消息 交流 现在 我们 传递 消息 的 方式 有 很多种 像是 比较 流行 qq 微 信 或者 微 博 知 乎 这种 社交 软件 甚至 我们 还 可以 剑 走 偏锋 的 方式 比如 支付宝 淘宝 这种 软件 进行 交流 但是 这些 软件 通常 都 需要 我们 登录 而且 要在 相应 的 客户端 才能 进行 操作 而 邮件 则不 一样 很多 语言 都 提供 了 邮件 相关 操作 的 api 我们 只需 要有 一个 邮箱 就可以 很 随意 的 发送 邮件 而且 邮件 的 监管 相比 其它 软件 要 松 地 多 那 说了 这么多 我们 能用 邮件 做些 什么 呢 在 我 的 实际工作 学习 中 我 喜欢 把 邮件 当作 一个 提醒 工具 有时候 一些 程序 的 执行 需要 很长 时间 这个 适合 就可以 在 程序 运行 成功 后 给 我们 的 手机 发邮件 这样 我们 就能 很 及时 的 进行 下一步 的 工作 二 准备工作 在 发送 邮件 之前 我们 需要 先 获取 一个 邮箱 的 授权 码 这个 授权 码 相当于 你 的 邮箱 密码 通常 可以 在 网页 版 邮箱 的 设置 中 获取 这里 以 邮箱 为 例 首先 登录 邮箱 httpsmailcom 登录 后 可以 看到 如下 页面 我们 点击 设置 然后 选择 popsmtpimap 选项 然后 会 看到 如下 页面 点击 开启 然后 按照 要求 发送 短信 即可 获取 授权 码 这个 授权 码 只会 显示 一次 因此 需要 保存 好 获取 授权 码 后 我们 就可以 开始 发送 邮件 了 三 发送 邮件 在 python 中 自 带了 smtplib 模块 用于 发送 邮件 但是 使用 起来 比较复杂 我们 今天 直接 使用 封 装好 的 yagmail 模块 进行 邮件 的 发送 我们 先来 安装 接下来 的 使用 就 非常 简单 了 基本 步骤 大致 如下 准备 用于 发送 邮件 的 邮箱 创建 smtp 对象 准 备要 发送 的 内容 发送 邮件 关闭 连接 具体 代码 如下 importyagmail 准备 用于 发送 邮件 的 邮箱 你 的 授权 码 创建 smtp 对象 yagyagmailsmtp 准 备要 发送 的 内容 content 这是 一封 邮件 发送 邮件 yagsend toqqcomsubject 测试 邮件 contentscontent 关闭 连接 yagclose 这里 又 几点 需要 注意 stmp 其中 smtp 其实是 一种 邮箱 协议 我们 使用 yagmailsmtp 创建 smtp 对象 它 给 我们 封 装了 底层 的 细节 我们 只需 要把 用于 发送 邮件 的 邮箱 和 授权 码 给它 已经 邮箱 服务器 ip 给它 就 好了 这里 又 出现 了 一个 邮箱 服务器 的 概念 通常 发送 邮件 的 流程 是 客户端 agt 邮箱 服务器 gt 客户端 b 其中 邮箱 服务器 充 当了 邮递员 的 身份 我们 需要 告诉 程序 要 哪个 邮递员 发邮件 因为 我们 使用 的 是 smtp 协议 而且 是的 邮箱 因此 我们 需要 填 邮箱 服务器 的 ip 通常情况下 邮箱 服务器 ip 格式 为 协议 名 邮箱 公司名 com 当然 这个 不是 固定 的 具体 的 可以 在 网页 版 的 设置 中 查看 比如 网易 邮箱 的 ip 如下 邮箱 内容 邮箱 内容 需 要是 一个 列表 发送 邮件 我们 发送 邮件 的 代码 如下 yagsend toqqcomsubject 测试 邮件 contentscontent 这里 我们 使 用了 三个 参数 其中 to 是 接 收方 的 邮箱 subject 是 邮件 的 主体 contents 是 邮箱 内容 yagsend 函数 还有 很多 其它 参数 这里 就 不再 细 说了 四 发送 附件 附件 的 发送 非常 简单 我们 只需 要在 contents 参数 中 写入 附件 的 参数 即可 比如 下面 这样 你 的 授权 码 yagyagmailsmtp content 附件 的 路径 xyqljpgyagsend toqqcomsubject 测试 邮件 contentscontent yagclose 因为 在 我 的 程序 下有 一个 叫 xyqljpg 的 图片 所以 我 直接 写就 好了 当然 有时候 我们 还需 要让 图片 直接 显示 在 邮件 中 这种 情况 我们 只需要 调用 一下 yagmailinline 函数 即可 代码 如下 你 的 授权 码 yagyagmailsmtp content 娜娜 酱 yagmailinline xyqljpg yagsend toqqcomsubject 测试 邮件 contentscontent yagclose 这里 需要 注意 一 下在 测试 过程 种 发现 不能 直接 单独 发 内 敛 图片 而 需要 配 一些 文字 发送 不然 会被 邮箱 服务器 退信 下面 我们 分别 看看 附件 和 内 敛 图片 的 区别 区别 还是 很明显 的 五 发送 html 邮件 yagmail 本身 就是 将 文字 作为 html 发送 的 因此 只要 我们 发送 html 邮件 不需要 做什么 改变 但是 为了 方便 我们 还是 把 html 写 一个 单独 的 文件 比如 文件 我 是 一个 测试 页面 这是 一个 测试 标题 这是 一个 测试 内容 显示 效果 如下 效果 很简单 然后 我们 把 上面 的 代码 搬 过来 稍作 修改 你 的 授权 码 yagyagmailsmtp content 直接 从 html 文件 中 读取 内容 open read yagsend toqqcomsubject 测试 邮件 contentscontent yagclose 上面 我们 直接 用 open 读取 html 的 内容 然后 发送 下面 是 接 收到 的 效果图 可以 看到 邮件 正常 接收 上面 这些 操作 就可以 满足 我们 工作 的 大多数 需求 了 大家 可以 自己 定制 一个 提醒 程序 今天 的 内容 就到 这里 了 感觉 阅读 有 兴趣 的 读者 可以 关注 我 的 个人 公众 号 新建 文件夹 x 