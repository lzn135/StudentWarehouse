系统安全 三十 cs 逆向 分析 1 你 的 游戏 子弹 用完 了吗 cheat engine 工具 入门 普及 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 前文 分享 了 外部 威胁 防护 和 勒索 病毒 对抗 带领 大家 看看 知名 安全 厂商 的 威胁 防护 措施 包括 网络安全 面临 的 挑战 如何 有效 的 应对 挑战 深 信服 安全 建设 之道 等 这篇 文章 将回到 逆向 知识 利用 cheatengine 工具 逆向 分析 游戏 cs 并 实现 无限 子弹 功能 基础性 文章 希望 对 您 有所 帮助 如果 存在 错误 侵权 或 不足之处 还望 告知 加油 参考 文章 作者 作为 网络安全 的 小白 分享 一些 自学 基础教程 给 大家 主 要是 关于 安全 工具 和 实践 操作 的 在线 笔记 希望 您们 喜欢 同时 更 希望 您能 与我 一起 操 作和 进步 后续 将 深入 学习 网络安全 和 系统安全 知识 并 分享 相关 实验 总之 希望 该 系列 文章 对 博 友 有所 帮助 写 文 不易 大神 们 不 喜 勿 喷 谢谢 如果 文章 对 您有 帮助 将是 我 创作 的 最大 动 力点 赞 评论 私聊 均可 一起 加油 喔 文章 目录 一 cs 游戏 介绍 二 逆向 分析 子弹 数 对应 地址 三 地图 变换 子弹 无限 固定 四 逆向 分析 装备 类型 五 逆向 分析 寻找 基址 并 小 hi 爱你 无限 子弹 六 总结 作者 的 github 资源 逆向 分析 网络安全 从 年月 开始 我 来 到了 一个 陌生 的 专业 网络空间 安全 初 入 安全 领域 是 非常 痛苦 和 难受 的 要 学 的 东西 太多 涉及面 太 广 但 好在 自己 通过 分享 篇 网络安全 自学 系列 文章 艰难 前行 着 感恩 这一 年 相识 相知 相 趣 的 安全 大佬 和 朋友们 如果 写得 不好 或 不足之处 还请 大家 海涵 接下来 我 将 开启 新 的 安全 系列 叫 系统安全 也是 免费 的 篇文章 作者 将 更加 深入 的 去 研究 恶意 样本 分析 逆向 分析 内网 渗透 网络 攻防 实战 等 也 将 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 加油 推荐 前文 网络安全 自学 篇 系列 篇 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 系统安全 四 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 系统安全 五 ollydbg 和 cheatengine 工具 逆向 分析 植物 大战 僵尸 游戏 系统安全 六 逆向 分析 之 条件 语句 和 循环 语句 源码 还原 及 流程 控制 系统安全 七 逆向 分析 之 pe 病毒 原理 c 实现 文件 加解密 及 ollydbg 逆向 系统安全 八 windows 漏洞 利 用之 cve 复现 及 蓝屏 攻击 系统安全 九 windows 漏洞 利 用之 ms 远程 代码 执行 漏洞 复现 及 深度 提 权 系统安全 十 windows 漏洞 利 用之 smbv 服务 远程 代码 执行 漏洞 cve 复现 系统安全 十一 那些 年 的 熊猫 烧香 及 pe 病毒 行为 机理 分析 系统安全 十二 熊猫 烧香 病毒 ida 和 od 逆向 分析 上 病毒 初始化 系统安全 十三 熊猫 烧香 病毒 ida 和 od 逆向 分析 中 病毒 释放 机理 系统安全 十四 熊猫 烧香 病毒 ida 和 od 逆向 分析 病毒 释放 过程 下 系统安全 十五 chrome 浏览器 保留 密码 功能 渗透 解析 蓝屏 漏洞 及 某 音乐 软件 漏洞 复现 系统安全 十六 pe 文件 逆向 基础知识 pe 解析 pe 编辑 工具 和 pe 修改 系统安全 十七 windowspe 病毒 概念 分类 及 感染 方式 详解 系统安全 十八 病毒 攻防 机理 及 winrar 恶意 劫持 漏洞 脚本 病毒 自启动 定时 关机 蓝屏 攻击 系统安全 十九 宏病毒 之 入门 基础 防御 措施 自发 邮件 及 apt 宏 样本 分析 系统安全 二十 pe 数字签名 之 上 什么 是 数字签名 及 signtool 签名 工具 详解 系统安全 二十一 pe 数字签名 之 中 工具 用法 系统安全 二十二 pe 数字签名 之 下 微软 证书 漏洞 cve 复现 及 windows 验证 机制 分析 系统安全 二十三 逆向 分析 之 ollydbg 动态 调试 复习 及 traceme 案例 分析 系统安全 二十四 逆向 分析 之 ollydbg 调试 int 断点 反 调试 硬件 断点 与 内存 断点 系统安全 二十五 wannacry 勒索 病毒 分析 python 复现 永恒 之 蓝 漏洞 实现 勒索 加密 系统安全 二十六 wannacry 勒索 病毒 分析 ms 漏洞 利用 及 病毒 解析 系统安全 二十七 wannacry 勒索 病毒 分析 蠕虫 传播 机制 解析 及 ida 和 od 逆向 系统安全 二十八 wannacry 勒索 病毒 分析 全网 最 详细 的 蠕虫 传播 机制 解读 系统安全 二十九 深 信服 分享 之 外部 威胁 防护 和 勒索 病毒 对抗 系统安全 三十 cs 逆向 分析 你 的 游戏 子弹 用完 了吗 cheatengine 工具 入门 普及 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 该 样本 不会 分享 给 大家 分析 工具 会 分享 参考文献 见 后 一 cs 游戏 介绍 counterstrike 是 valve 年 夏天 开发 的 射击 系列 游戏 创始人 是 杰 斯 克利夫 和 李明 minhgoosemanlee 他们 后来 和 游戏 一起 进 入了 valve 这篇 文章 逆向 分析 的 就是 这款 非常 经典 的 游戏 cs 调整 游戏 取消 全屏 设置 视频 位 窗口 游戏 方便 我们 调试 动态 分析 接着 点击 新建 游戏 我们 选择 一幅 最 经典 的 地图 dedust 游戏 设置 可以 将 每局 时间 设 长 方便 调试 游戏 加载 界面 如 下图 所示 开始 吧 让我们 逆向 分析 cs 逆向 分析 环境 游戏 版本 cs 逆向 工具 cheatengine 操作系统 wndows 二 逆向 分析 子弹 数 对应 地址 第一步 按 下 esc 回到 桌面 打开 cheatengine 软件 版本 信息 为 cheatengine 其 主 界面 如 下图 所示 第二步 点击 左上角 小电脑 加载 cs 进程 该 软件能 监控 游戏 内存 的 数据 方便 我们 后续 的 读写 修改 每一款 游戏 加载 之后 就会 存入 内存 中 无论是 金钱 子弹 数 时间 都 存储 在 内存 中 打开 后 如 下图 所示 接下来 我们 看看 怎么 操作 ce 第三步 回到 cs 游戏 我们 看到 当前 的 子弹 数量 是 在 ce 中 输入 并 点击 首次 扫描 扫描 结果 如 下图 所示 共 发现 结果 条 当 我们 点击 再次 扫描 其 结果 变为 之后 再无 变化 那么 我们 怎么办 呢 第四步 我们 继续 射击 然后 输入 新 的 数字 进行 搜索 发现 结果 还剩 条 接着 继续 射击 及 扫描 但 此时 的 结果 为 后 不再 继续 减少 第五步 ctrla 选中 所有 结果 然后 右键 加入 选择 的 地址 到 地址 清单 第六步 结合 二分法 按住 shift 键 选中 一般 内容 右键 更改 记录 数值 比如 修改后 的 内容 如 下图 所示 接着 回到 游戏 我们 可以 看到 子弹 数量 变成 了然 后 点击 射击 变 成了 接着 我们 删除 不是 的 其余部分 第七步 同样 的 方法 我们 修改 剩余 的 一半 为 继续 看 游戏 对应 的 数值 是否 变化 并 删除 不是 对应 的 部 分值 注意 规则 总结 如下 如果 选中 正确 地址 并 修 改则 未 选中 部分 的 数值 隔 一段时间 后会 跟着 变为 如果 未 选中 正确 地址 修 改则 剩余 部 分会 跟随 之前 的 子弹 数量 变换 比如 我 将 第一 行 数值 修 改为 它 立刻 会 自动 变成 当前 子弹 数 最终 确定 的 地址 为 bee 第八 步 选中 该条 记录 双击 修 改为 手枪 子弹 数 然后 修改 子弹 为 修改 该 值 可以 看到 游 戏中 的 子弹 数量 也 跟着 变化 继续 修 改为 发 游戏 子弹 数量 继续 变化 那么 我们 怎么 能将 子弹 数量 固定 不 减少 呢 第九步 点击 锁定 它 会将 内存地址 锁定 此时 再回到 游 戏中 来 射击 后 的 子弹 不再 变化 最后 我们 换 一张 地图 来 试试 效果 按 下 h 换 地图 但 子弹 发生变化 了 那 怎么 解决 呢 写到 这里 先 简单 总结 该 部分 主要 通过 cheatengine 来 查找 存放 子弹 的 地址 并 设置 固定值 后续 读者 可以 尝试 c 代码 自定义 子弹 数量 并 实现 该 无限 子弹 功能 三 地图 变换 子弹 无限 固定 这 部分 我们 将 解决 地图 变换 但 cs 子弹 数量 仍然 保持 不变 的 功能 解决方法 是 找到 内存地址 中 存放 子弹 且不 改变 的 地址 程序 打开 后会 加 载到 内存 中 通常 分为 两块 内存 其中 一块 称为 基址 基址 不会 改变 用于 存放 血量 金钱 等 当 它 不够 或 需要 存放 更多 数据 时 它会 跟 系统 申请 地址 这个 地址 是 系统 分配 的 所以 变换 地图 后 显示 的 子弹 数 地址 也 会 发生变化 我们 需要 找到 其 变化 规律 偏移 地址 即可 第一步 通过 前面 部分 的 方法 找到 子弹 数 存放 的 地址 复现 上面 操作 在 逆向 过程中 我们 可以 将 每局 时间 设置 长 一些 方便 调试 我们 可以 看到 在 条 结果 中有 绿色 和 黑色 地址 绿色 就是 基址 只要 程序 启动 这些 地址 就 归 游戏 使用 黑色 是 临时 申请 使用 的 因此 我们 需要 找到 一个 绿色 的 地址 但 其实 这里 的 绿色 地址 都不是 我们 想要 的 地址 接着 使用 二分法 找到 对应 的 子弹 数量 地址 同样 的 方法 我们 最终 确定 地址 为 bbdc 但是 它是 临时 存放 子弹 数量 的 地址 现在 我们 有 个 新 的 猜想 通过 一张 图 来 构想 如何 寻找 基址 当前 子弹 数量 为 对应 的 地址 为 bbdc 它 存放在 临时 地址 中 换 地图 可能 变换 而 对应 的 基址 xxxxx 存储 的 是 临时 地址 的 地址 即 bbdc 这里 我们 需要 通过 地址 关联 从而 进一步 发现 基址 实现 地图 变换 子弹 无限 固定 的 功能 并且 它 可能是 多层 指针 第二步 双击 地址 并 复制 bbdc 然后 勾 选 十六进制 点击 首次 扫描 运行 如 下图 所示 但 此时 没有 任何 数据 上面 的 猜想 是 失败 了吗 原因是 存在 偏移 地址 指针 偏移 因此 我们 需要 执行 如下 操作 第三步 选中 地址 右键 找出 是什么 改 写了 这个 地址 接着 弹出 如 下图 所示 的 对话框 进入 游戏 尝试 射击 可以 看到 计数 调用 次数 指令 汇编 代码 同时 给出 该 汇编 指令 的 上下文 第四步 分析 汇编 代码 汇编 代码 如下 movesicceax 表示 将 eax 赋值 给 esicc 中 这个 偏移 加上 后 就 对应 我们 的 子弹 数 分析 如下 esibbesicc 子弹 临时 地址 接着 我们 点击 手动 加入 地址 然后 输入 bb 加上 cc 可以 看到 结果 为 对应 当前 子弹 数量 接着 我们 进行 简单 的 描述 备注 第五步 我们 继续 扫描 找到 存放 bb 地址 的 对应 地址 共计 个 结果 bb 但是 它们 们 还 不是 绿色 的 基址 说明 它们 是 存放 临时 数据 的 临时 地址 其 结果 图 有 可能 如 下图 所示 接下来 我们 继续 查找 第六步 进入 游 戏中 尝试 射击 或 按 下 h 尝试 刷新 游戏 我们 可以 看到 出现 了 个 红色 的 数值 修改 并且 我们 的 子弹 数 现在是 不再是 地址 bbe 数值 epreviousbb 第七步 接下来 我们 依次 对 这些 地址 进行 扫描 注意 有时候 场景 自动 切换 会 导致 之前 增加 的 临时 子弹 数 和 子弹 数 cc 地址 失效 这 需要 我们 重新 扫描 子弹 数量 方法 和 之前 的 一样 建议 先 调整 无限 时间 方便 我们 调试程序 如果 你 是 初学者 建议 反复 熟悉 这些 流程 这里 再 简单 总结 步骤 扫描 数值 子弹 数 射击 继续 扫描 得到 个 结果 选择 加入 地址 清单 然后 二分 查找 确定 手枪 子弹 数 临时 地址 bb 接着 选中 地址 找出 什么 改写 这个 地址 发现 movesicceaxeax 子弹 数 esibbabbaccbb 临时 地址 勾 选 十六进制 扫描 地址 bba 最后 依次 判断 其 条 返回 结果 的 地址 均 没有 绿色 基址 第八 步 依次 添加 条 结果 然后 进行 十六进制 地址 新 扫描 如果 点击 新 的 扫描 没有 反馈 结果 可以 直接 删除 发现 这条 内容 都没有 结果 该 部分 暂时 失败 逆向 其实 就是 反复 去 尝试 的 过程 假设 失败 是 非常 正常 的 事情 四 逆向 分析 装备 类型 第一步 接着 上面 的 过程 继续 观察 我们 尝试 丢 枪 看 这些 地址 的 变化 情况 地址 ccdgt 地址 ccdgtdb 地址 ccdgtdb 我们 再 尝试 拿取 手枪 数值 还原成 bba 接着 再次 丢 枪 换成 ak 并 尝试 设计 发现 子弹 数 不变 说明 前面 临时 变量 对应 手枪 的 子弹 数 地址 ccdgt 地址 ccdgtde 地址 ccdgtde 尝试 换成 刀 其 值 也 对应 变化 因此 我们 进行 简单 的 备注 这个 地址 是 手持 物品 其它 无关 的 地址 我们 删除 当前 手持 物品 当前 手持 物品 另一个 即 是否 持 手枪 的 标记变量 我们 尝试 把 ak 扔掉 发现 其 地址 继续 变换 地址 ccdgt 地址 ccdgtdb 地址 ccdgtdb 第三步 我们 需要 确定 手持 物品 的 基址 右键 点击 找出 是什么 改 写了 这个 地址 变换 结果 如 下图 所示 核心 代码 如下 偏移 地址 是 将 当前 物品 描述 为 加上 e 同时 我们 点击 手持 物品 可以 看到 其 计数 在 不断 刷新 它是 不 断去 查询 玩家 手持 物品 对 其 进行 备注 如 下图 当前 手持 物品 cce 当前 手持 物品 ccec 此时 存在 两个 偏移 地址 下面 介绍 手动 添加 过程 第四步 点击 手动 加入 地址 点击 指针 并 输入 ccecc 可以 看到 当前 ak 的 子弹 数 为 尝试 射击 后 变 成了 我们 尝试 换成 手枪 发现 子弹 数 变 成了 说明 该 指针 对应 的 值 为 当前 子弹 数 当前 手握 枪 的 子弹 数 ccecc 五 逆向 分析 寻找 基址 并 小 hi 爱你 无限 子弹 接着 之前 继续 第五步 我们 继续 查询 存放 该 值 的 基址 扫描 地址 cc 发现 仍然 没有 绿色 的 值 说明 不是 我们 要 找 的 值 先 删除 为 的 值 然后 继续 添加 查找 基址 添加 进去 后 换 一张 地图 显示 如 下图 所示 我们 需要 通过 地图 切 换来 查询 是否 存在 对应 的 基址 通过 丢 枪 换 地图 买 枪 各种 操作 最终 保 留个 可能 的 地址 非 第六步 点击 找出 什么 改 写了 这个 地址 按钮 然后 切换 地图 看 其 地址 变化 情况 最终 确定 cac 地址 在 切换 地图 时 发生变化 刷新 地址 先 清零 然后 再将 eax 赋值 找到 这个 地址 之后 我们 通过 同样 的 指针 方式 进行 确认 cabdcecc 第七步 继续 查找 cabd 地址 发现了 个 绿色 基址 将 绿色 的 添加 进去 继续 判断 注意 此时 的 三级 指针 地图 切换 地址 对应 当前 子弹 数量 即使 我们 切换 地图 该 值 仍然 一一对应 第八 步 尝试 切换 地图 发现 这三个 绿色 值 仍然 没有 变化 接着 我们 断开 连接 然后 删除 最后 一个 值 删除 基址 如果 ce 断开 可以 重新 打开 cs 程序 即可 最终 确认 基址 和 基址 应该 都是 正确 的 第九步 双击 基址 的 地址 并 复制 然后 进行 手动 添加 地址 基址 基址 cstrikeexeabc 第 十步 通过 基址 添加 三级 指针 从而 定位 子弹 数 注意 该 基址 带有 cstrikeexe 名称 最后 锁定 该 地址 对应 下图 最后 一行 至此 我们 无限 子弹 的 功能 成功 完成 并且 切换 地图 和 枪 也是 无限 子弹 运行 效果 如 下图 所示 最 重要 的 截图 如下 所示 六 总结 写到 这里 这篇 文章 就 介绍 完毕 本文 主要 通过 cheatengine 逆向 分析 cs 游戏 并 实现 无限 子弹 功能 希望 您 喜欢 一 cs 游戏 介绍 二 逆向 分析 子弹 数 对应 地址 三 地图 变换 子弹 无限 固定 四 逆向 分析 装备 类型 五 逆向 分析 寻找 基址 并 小 hi 爱你 无限 子弹 同时 文章 存在 几个问题 需要 读者 自行 完善 作者 也 会 继续 分享 问题 锁定 后 敌人 也是 无限 子弹 怎么 解决 呢 问题 读者 能不 能用 vs 编写程序 定位 基址 然后 能 修改 自己 想要 的 子弹 数量 问题 fps 游戏 怎么 实现 穿墙 血量 无敌 猫 准 等功能 呢 问题 怎么 通过 od 动态 调试 cs 游戏 呢 这篇 文章 中 如果 存在 一些 不足 还请 海涵 作者 作为 网络安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 深知 自己 很菜 得 努力 前行 欢迎 大家 讨论 是否 觉得 这 系列 文章 帮助 到 您 任何 建议 都可以 评论 告知 读者 共勉 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 ccfsci 南 核 北 核 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 周一 夜 于 武汉 参考文献 