python 实现 用 手机 监控 远程 控制 电脑 一 前言 很多 时候 我们 都有 远程 控制 电脑 的 需求 比如 正在 下载 某样 东西 需 要让 电脑 在 下载 完 后 关机 或者 你 需要 监控 一个 程序 的 运行状况 等 今天 我们 就 来用 python 实现 一个 远程 监控 并 控制 电脑 的 小 程序 二 实现 原理 听起来 远程 控制 电脑 好像 很 高级 的 样子 但是 实现 起来 其实 非常 简单 实现 原理 如下 运行 程序 让 程序 不停地 读取 邮件 用 手机 给 电脑 发送 邮件 判断 是否 读 取到 指定 主题 的 邮件 如果有 则 获取 邮件 内容 根据 邮件 内容 执行 预设 的 函数 与其说是 学习 如何 远程 控制 电脑 还 不如说是 学习 如何 读取 邮件 当然 上面 的 的 流程 只 实现 了 远程 控制 电脑 而 没 实现 对 电脑 的 监控 而 监控 的 操作 可以 以 截图 的 方式 来 进行 我们 可以 预设 一个 指令 当 读 取到 邮件 内容 为 grab 时 我们 就 发送 电脑 截图 如何将 电脑 截图 发送给 手机 邮箱 这样 就 达 到了 监控 的 效果 关于 如何 发送 邮件 可以 参考 博客 如 何用 python 发送 邮件 这里 就 不再 详细 说了 下面 我们 看看 如何 读取 邮件 三 读取 邮件 读取 邮件 需要 使 用到 imbox 模块 安装 语句 如下 pipinstallimbox 读取 邮件 的 代码 如下 withimbox unreadtrue 如果是 手机 端 发来 的 远程 控制 邮件 标 记为 已 读 boxmarkseen uid 首先 我们 用 with 语句 打开 邮箱 然后 通过 下面 语句 获取 所有 的 未 读 邮件 unreadtrue 获取 未 读 邮件 后 对 邮件 进行 遍历 将 主 题为 reomtecontrol 的 邮件 标 记为 已 读 并 返回 文本 内容 这里 需要 注意 因为 我们 筛选 出了 主 题为 remotecontrol 的 邮件 因此 我们 在用 手机 发邮件 的 时候 需 要将 主题 设置 为 remotecontrol 这样 可以 避免 其它 邮件 的 干扰 四 截图 截图 需要 使 用到 pil 模块 安装 如下 截图 的 代码 很简单 senderto 截取 电脑 全屏 将 截 屏保 存为 surfacejpg 将 截 屏 发送给 手机 sendmail 其中 sendmail 的 代码 如下 smtpyagmailsmtp smtpsend 关于 发送 邮件 的 介绍 可以 参考 上面 提到 的 博客 五 关机 关机 的 操作 非常 简单 我们 可以用 python 来 执行 命令行 语句 即可 代码 如下 关机 ossystem shutdownst 除了 关机 我们 还 可以 执行 很多 操作 对于 一些 复杂 的 操作 我们 可以 预 编写 一些 bat 文件 这里 就不 演示 了 六 完整 代码 上面 我们 编 写了 各个 部分 的 代码 然后 再来 看看 主体 部分 的 代码 defmain 电脑 用来 发送 邮件 已经 电脑 读取 的 邮箱 手机 端 的 邮箱 receiverqqcom 读取 邮件 的 时间 间隔 timespace 注册 账户 yagmailregister 循环 读取 whiletrue 读取 未 读 邮件 msgreadmail ifmsg 根据 不同 的 内容 执行 不同 操作 elifmsggrabgrab timesleep timespace 我们 可以 根据 自己 的 需求 编写 一些 其它 功能 下面 是 完整 的 代码 smtpyagmailsmtp smtpsend defreadmail withimbox unreadtrue 如果是 手机 端 发来 的 远程 控制 邮件 标 记为 已 读 boxmarkseen uid ossystem shutdownst defgrab senderto surfacesave surfacejpg sendmail defmain 你 的 授权 码 whiletrue 读取 未 读 邮件 msgreadmail elifmsggrabgrab timesleep timespace ifnamemainmain 