用 python 一秒 自动 美化 表格 python 的 1024种 玩法 3 之前 写过 一篇 文章 大学生 们 都 在读 什么 书 让 python 用 数据 告诉 你 在这 篇文章 中 我 用 python 爬虫 爬 取了 全国 多个 图书馆 的 热门 借阅 图书 信息 并 按照 一定 的 规则 做了 统计 汇总 得 到了 这一 份 大学生 各 领域 必读 top 书单 这份 书单 分 领域 保 存在 excel 的 多个 sheet 页 中 每个 sheet 页 的 文件 是 这 样子 的 虽然 内容 非常 全面 但是 这些 挤在 一块 的 内容 总觉得 根本 没有人 会有 兴趣 看下去 起码 得 调整 一下 格式 做个 简单 的 美化 让 excel 更 易读 而 多个 shee 页 如果 分 别去 调 格式 的话 也是 个 不小 的 工作量 这时 python 的 用武之地 就 来了 我 可以用 python 批量 美化 这些 excel 的 格式 节省 自己 的 时间 python 对 excel 的 操作 我 用 到了 xlwings 这个 包 xlwings 能够 非常 方便 的 读写 excel 文件 中 的 数据 并且 能够 进行 单元格 格式 的 修改 还 可以 和 无缝 连接 支持 读写 numpypandas 数据类型 并将 matplotlib 可视化 图表 导入到 excel 中 更 重要 的 是 在 操作 excel 的 时候 你 可以 实时 看到 效果 可以说 这是 我 最喜欢 的 处理 excel 的 python 包了 xlwings 的 使用 方式 也 非常 简单 只需要 这里 我们 主要 使用 其 修改 单元格 格式 的 功能 分为 三步 第 步 先 自己 用 excel 制作 一个 格式 模板 调 整行 高 列 宽 等 并 命名为 samplexlsx 因为 行 高 和 列 宽 都是 一些 数值 用 代码 的 方式 调整 不太 直观 所以 采 用在 模板 excel 上调 整好 然后 应用到 目标 excel 的 方式 制 作好 的 格式 模板 如 下第 步 让 程序 读取 这个 模板 里 的 格式 告诉 程序 接下来 所有 的 shee 页 都 按照 这个 格式 来 美化 获 取样 例 表格 的 列 宽 数据 col 因为 无需 读取 整个 excel 所有 列 的 列 宽 所以 这里 传入 一个 读取 的 列 宽 范围 参数 wbxwbook samplexlsx 建 立于 samplexlsx 文件 的 连接 打开 samplexlsx 文件 的 col formatappend print 列 宽 str format 行 高 sheetrange a returnformat 第 步 让 程序 批量 操作 这个 shee 页 按照 模板 的 列 宽 进行 设置 同时 修改 一些 字体 单元格 背景 等 美化 表格 todo 还需要 一个 异常 退出 设置 颜色 wbxwbook tablename 建立 excel 表 连接 a value 序号 书名 知 乎 东 写 西 读 整理 总 浏览 次数 霸 榜 高校 数 霸 榜 率 在 高校 榜单 排名 中位数 豆瓣 评分 豆瓣 链接 知 乎 东 写 西 读 整理 更改 标题 行 linestyle 设置 单元格 横 边框 为 细 框 线 linestyle 设置 单元格 竖 边框 为 细 框 线 微软 雅 黑 设置 字体 格式 为 微软 雅 黑 设置 字体 居中 霸 榜 率 这一 列 单元格 设置 为 百分比 格式 显示 foriinrange raw 行 遍历 设置 标题 背景 颜色 格式 设置 偶数 行 背景 颜色 格式 为 浅蓝色 format 列 遍历 根据 samplexlsx 中 的 列 宽 进行 调整 保存 excelwbclose 关闭 excelreturnnone 好了 优化 后 的 excel 是 这个 样子 的 最后 附上 完整 代码 获 取样 例 表格 的 列 宽 数据 col 因为 无需 读取 整个 excel 所有 列 的 列 宽 所以 这里 传入 一个 读取 的 列 宽 范围 参数 wbxwbook samplexlsx 建 立于 samplexlsx 文件 的 连接 打开 samplexlsx 文件 的 col formatappend print 列 宽 str format 行 高 sheetrange a returnformat 美化 表格 todo 还需要 一个 异常 退出 设置 颜色 wbxwbook tablename 建立 excel 表 连接 a value 序号 书名 知 乎 东 写 西 读 整理 总 浏览 次数 霸 榜 高校 数 霸 榜 率 在 高校 榜单 排名 中位数 豆瓣 评分 豆瓣 链接 知 乎 东 写 西 读 整理 更改 标题 行 linestyle 设置 单元格 横 边框 为 细 框 线 linestyle 设置 单元格 竖 边框 为 细 框 线 微软 雅 黑 设置 字体 格式 为 微软 雅 黑 设置 字体 居中 霸 榜 率 这一 列 单元格 设置 为 百分比 格式 显示 foriinrange raw 行 遍历 设置 标题 背景 颜色 格式 设置 偶数 行 背景 颜色 格式 为 浅蓝色 format 列 遍历 根据 samplexlsx 中 的 列 宽 进行 调整 保存 excelwbclose 关闭 需要 修改 的 excel 名字 raw 需要 修改 格式 的 行数 col 需要 修改 格式 的 列 数 col beautifulsheet 