面试 还 搞不懂 redis 快看 看这 40 道 面试题 含答案 和 思维 导 图 redis 面试题 什么 是 redisredis 的 数据类型 使用 redis 有 哪些 好处 redis 相比 memcached 有 哪些 优势 memcache 与 redis 的 区别 都有 哪些 redis 是 单 进程 单线程 的 一个 字符串 类型 的 值 能 存储 最大 容量 是多少 redis 的 持久 化 机制 是什么 各自 的 优缺点 redis 常见 性能 问题 和 解决方案 redis 过期 键 的 删除 策略 redis 的 回收 策略 淘汰 策略 为什么 edis 需 要把 所有 数据 放到 内存 中 redis 的 同步 机制 了解 么 pipeline 有 什么 好处 为什么 要用 pipeline 是否 使 用过 redis 集群 集群 的 原理 是什么 redis 集群 方案 什么 情况下 会 导致 整个 集群 不可用 redis 支持 的 java 客户端 都有 哪些 官方 推荐 用 哪个 jedis 与 redisson 对比 有 什么 优缺点 redis 如何 设置 密码 及 验证 密码 说说 redis 哈希 槽 的 概念 redis 集群 的 主从复制 模型 是 怎样 的 redis 集群 会有 写 操作 丢失 吗 为什么 redis 集群 之间 是 如何 复制 的 redis 集群 最大 节点 个数 是多少 redis 集群 如何 选择 数据库 怎么 测试 redis 的 连通性 怎么 理解 redis 事务 redis 事务 相关 的 命令 有 哪几个 rediskey 的 过期 时间 和 永久 有效 分别 怎么 设置 redis 如何做 内存 优化 redis 回收 进程 如何 工作 的 都有 哪些 办法 可以 降低 redis 的 内存 使用情况 呢 redis 的 内存 用 完了 会 发生 什么 一个 redis 实例 最 多能 存放 多少 的 他们 最 多能 存放 多少 元素 mysql 里 有 w 数据 redis 中 只 存 w 的 数据 如何 保证 redis 中 的 数据 都是 热点 数据 redis 最适合 的 场景 假如 redis 里面 有 亿个 key 其中有 w 个 key 是以 某个 固定 的 已知 的 前缀 开头 的 如果 将 它们 全部 找出来 如果有 大量 的 key 需要 设置 同一时间 过期 一般 需要 注意 什么 使 用过 redis 做 异步 队列 么 你 是 怎么 用 的 使 用过 redis 分布式 锁 么 它是 什么 回事 关于 的 知识点 总结 成了 思维 导 图 什么 是 redisredis 是 完全 开源 免费 的 遵守 bsd 协议 是 一个 高性能 的 keyvalue 数据库 redis 与其 他 keyvalue 缓存 产品 有 以下 三个 特点 redis 支持 数据 的 持久 化 可以 将 内存 中 的 数据 保 存在 磁盘 中 重启 的 时候 可以 再次 加载 进行 使用 redis 不仅仅 支持 简单 的 keyvalue 类型 的 数据 同时 还 提供 listsetzsethash 等 数据结构 的 存储 redis 支持 数据 的 备份 即 masterslave 模式 的 数据 备份 redis 优势 性能 极高 redis 能读 的 速度 是 次 s 写 的 速度 是 次 s 丰富 的 数据类型 redis 支持 二进制 案例 的 及 orderedsets 数据类型 操作 原子 redis 的 所有 操作 都是 原子 性 的 意思 就是 要么 成功 执行 要么 失败 完 全不 执行 单个 操作 是 原子 性 的 多个 操作 也 支持 事务 即 原子 性 通过 multi 和 exec 指令 包起来 丰富 的 特性 redis 还 支持 通知 key 过期 等等 特性 redis 与其 他 keyvalue 存储 有 什么 不同 redis 有着 更为 复杂 的 数据结构 并且 提供 对 他们 的 原子 性 操作 这是 一个 不同于 其他 数据库 的 进化 路径 redis 的 数据类型 都是 基于 基本 数据结构 的 同时 对 程序员 透明 无需 进行 额外 的 抽象 redis 运行 在 内存 中 但是 可以 持久 化 到 磁盘 所以 在对 不同 数据 集 进行 高速 读写 时 需要 权衡 内存 因为 数据量 不能 大于 硬件 内存 在 内存 数据库 方面 的 另一个 优点 是 相比 在 磁盘 上 相同 的 复杂 的 数据结构 在 内存 中 操作 起来 非常 简单 这样 redis 可以 做 很多 内部 复杂性 很强 的 事情 同时 在 磁盘格式 方面 他们 是 紧凑 的 以 追加 的 方式 产生 的 因为 他们 并不需要 进行 随机 访问 redis 的 数据类型 答 redis 支持 五种 数据类型 string 字符串 hash 哈希 list 列表 set 集合 及 zsetsortedset 有序 集合 我们 实际 项目 中 比较 常用 的 是 stringhash 如果 你 是 redis 中高级 用户 还需要 加上 下面 几种 数据结构 如果 你 说 还 玩过 redismodule 像 面试官 得 眼睛 就 开始 发 亮了 使用 redis 有 哪些 好处 速度快 因为 数据 存在 内存 中 类似于 hashmaphashmap 的 优势 就是 查找 和 操作 的 时间 复杂度 都是 o 支持 丰富 数据类型 支持 等 支持 事务 操作 都是 原子 性 所谓 的 原子 性 就是 对 数据 的 更改 要么 全部 执行 要么 全部 不 执行 丰富 的 特性 可 用于 缓存 消息 按 key 设置 过期 时间 过期 后 将会 自动 删除 redis 相比 memcached 有 哪些 优势 memcached 所有 的 值 均是 简单 的 字符串 redis 作为 其 替代者 支持 更为 丰富 的 数据 类 redis 的 速度 比 memcached 快 很 redis 可以 持久 化 其 数据 memcache 与 redis 的 区别 都有 哪些 存储 方式 memecache 把 数据 全部 存在 内存 之中 断电 后会 挂掉 数据 不能超过 内存大小 redis 有 部份 存在 硬 盘上 这样 能 保证 数据 的 持久性 数据 支持 类型 memcache 对 数据类型 支持 相对 简单 redis 有 复杂 的 数据类型 使用 底层 模型 不同 它们 之间 底层 实现 方式 以及 与 客户端 之间 通信 的 应用 协议 不一样 redis 直接 自己 构 建了 vm 机制 因为 一般 的 系统 调用 系统 函数 的话 会 浪费 一定 的 时间 去 移动 和 请求 redis 是 单 进程 单线程 的 答 redis 是 单 进程 单线程 的 redis 利用 队列 技术 将 并发 访问 变为 串行 访问 消 除了 传统 数据库 串行 控制 的 开销 一个 字符串 类型 的 值 能 存储 最大 容量 是多少 答 mredis 的 持久 化 机制 是什么 各自 的 优缺点 redis 提供 两种 持久 化 机制 rdb 和 aof 机制 持久 化 方式 是 指用 数据 集 快照 的 方式 半 持久 化 模式 记录 redis 数据库 的 所有 键值 对 在 某个 时间 点将 数据 写入 一个 临时文件 持久 化 结束 后用 这个 临时文件 替换 上次 持久 化 的 文件 达到 数据 恢复 优点 只有 一个 文件 dumprdb 方便 持久 化 容 灾 性 好一个 文件 可以 保 存到 安全 的 磁盘 性能 最大化 fork 子 进程 来 完成 写 操作 让 主 进程 继续 处理 命令 所以是 io 最大化 使用 单 独子 进程 来 进行 持久 化 主 进程 不会 进行 任何 io 操作 保证 了 redis 的 高性能 相对于 数据 集 大 时 比 aof 的 启动 效率 更高 缺点 数据 安全性 低 rdb 是 间隔 一段时间 进行 持久 化 如果 持久 化 之间 redis 发生 故障 会 发生 数据 丢失 所以 这种 方式 更适合 数据 要求 不 严谨 的 时候 持久 化 方式 是 指 所有 的 命令行 记录 以 redis 命令 请求 协议 的 格式 完全 持久 化 存储 保存为 aof 文件 优点 数据 安全 aof 持久 化 可以 配置 appendfsync 属性 有 always 每 进行 一次 命令 操作 就 记 录到 aof 文件 中一 次 通过 append 模式 写 文件 即使 中途 服务器 宕机 可以 通过 redischeckaof 工具 解决 数据一致性 问题 aof 机制 的 rewrite 模式 aof 文件 没被 rewrite 之前 文件 过大 时 会对 命令 进行 合并 重写 可以 删除 其中 的 某些 命令 比如 误操作 的 flushall 缺点 aof 文件 比 rdb 文件 大 且 恢复 速度慢 数据 集 大 的 时候 比 rdb 启动 效率 低 redis 常见 性能 问题 和 解决方案 master 最好 不 要写 内存 快照 如果 master 写 内存 快照 save 命令 调度 rdbsave 函数 会 阻塞 主 线程 的 工作 当 快照 比 较大 时 对 性能 影响 是 非常大 的 会 间断性 暂停 服务 如果 数据 比较 重要 某个 slave 开启 aof 备份 数据 策略 设置 为 每秒 同步 一 为了 主从复制 的 速度 和 连接 的 稳定性 master 和 slave 最 好在 同一个 局域网 尽量 避免 在 压力 很大 的 主库 上 增加 从 主从复制 不 要用 图 状 结构 用 单向 链表 结构 更为 稳定 即 这样 的 结构 方便 解决 单点故障 问题 实现 slave 对 master 的 替换 如果 master 挂了 可以 立刻 启用 slave 做 master 其他 不变 redis 过期 键 的 删除 策略 定时 删除 在 设置 键 的 过期 时间 的 同时 创建 一个 定时器 timer 让 定时器 在 键 的 过期 时间 来 临时 立即 执行 对 键 的 删除 操作 惰性 删除 放任 键 过期 不管 但是 每次 从 键 空 间中 获取 键 时 都 检查 取得 的 键 是否 过期 如果 过期 的话 就 删除 该 键 如果 没有 过期 就 返回 该 键 定期 删除 每隔 一段时间 程序 就 对 数据库 进行 一次 检查 删除 里面 的 过期 键 至于 要 删除 多少 过期 键 以及 要 检查 多少个 数据库 则由 算法 决定 redis 的 回收 策略 淘汰 策略 volatilelru 从 已设置 过期 时间 的 数据 集 中 挑选 最近 最少 使用 的 数据 淘汰 volatilettl 从 已设置 过期 时间 的 数据 集 中 挑选 将要 过期 的 数据 淘汰 volatilerandom 从 已设置 过期 时间 的 数据 集 中 任意 选择 数据 淘汰 allkeyslru 从 数据 集 serverdbidict 中 挑选 最近 最少 使用 的 数据 淘汰 allkeysrandom 从 数据 集 serverdbidict 中 任意 选择 数据 淘汰 noenviction 驱逐 禁止 驱逐 数据 注意 这里 的 种 机制 volatile 和 allkeys 规定 了 是 对 已设置 过期 时间 的 数据 集 淘汰 数据 还是 从 全部 数据 集 淘汰 数据 后面 的 lruttl 以及 random 是 三种 不同 的 淘汰 策略 再加上 一种 noenviction 永不 回收 的 策略 使用 策略 规则 如果 数据 呈现 幂 律 分布 也 就是 一部分 数据 访问 频率 高一 部分 数据 访问 频率 低 则 使用 allkeyslru 如果 数据 呈现 平等 分布 也 就是 所有 的 数据 访问 频率 都 相同 则 使用 allkeysrandom 为什么 edis 需 要把 所有 数据 放到 内存 中 答 redis 为了 达到 最快 的 读写 速度 将 数据 都 读到 内存 中 并 通过 异步 的 方式 将 数据 写入 磁盘 所以 redis 具有 快速 和 数据 持久 化 的 特征 如果 不将 数据 放在 内存 中 磁盘 io 速度 为 严重影响 redis 的 性能 在 内存 越来越 便宜 的 今天 redis 将会 越来越 受欢迎 如果 设置 了 最大 使用 的 内存 则 数据 已有 记录 数 达到 内存 限值 后 不能 继续 插入 新 值 redis 的 同步 机制 了解 么 答 redis 可以 使用 主从 同步 从 从 同步 第一次 同步 时 主 节点 做 一次 bgsave 并 同时 将 后续 修改 操作 记 录到 内存 buffer 待 完成后 将 rdb 文件 全 量 同步 到 复制 节点 复制 节点 接受 完成后 将 rdb 镜像 加 载到 内存 加载 完成后 再 通 通知 主 节 点将 期间 修改 的 操作 记录 同步 到 复制 节点 进行 重放 就 完 成了 同步 过程 pipeline 有 什么 好处 为什么 要用 pipeline 答 可以 将 多次 io 往返 的 时间 缩 减为 一次 前提 是 pipeline 执行 的 指令 之间 没有 因果 相关性 使用 redisbenchmark 进行 压 测 的 时候 可以 发现 影响 redis 的 qps 峰值 的 一个 重要因素 是 pipeline 批次 指令 的 数目 是否 使 用过 redis 集群 集群 的 原理 是什么 redissentinal 着眼于 高 可用在 master 宕机 时会 自动 将 slave 提 升为 master 继续 提供 服务 rediscluster 着眼于 扩展性 在 单个 redis 内存不足 时 使用 cluster 进行 分片 存储 redis 集群 方案 什么 情况下 会 导致 整个 集群 不可用 答 有 abc 三个 节点 的 集群 在 没有 复制 模型 的 情况下 如果 节点 b 失败 了 那么 整个 集群 就会 以为 缺少 这个 范围 的 槽 而 不可用 redis 支持 的 java 客户端 都有 哪些 官方 推荐 用 哪个 答 等等 官方 推荐 使用 redissonjedis 与 redisson 对比 有 什么 优缺点 答 jedis 是 redis 的 java 实现 的 客户端 其 api 提供 了 比较 全面 的 redis 命令 的 支持 redisson 实现 了 分布式 和 可 扩展 的 java 数据结构 和 jedis 相比 功能 较为 简单 不支持 字符串 操作 不支持 排序 事务 管道 分区 等 redis 特性 redisson 的 宗旨 是 促进 使用者 对 redis 的 关注 分离 从而 让 使用者 能够 将 精力 更 集中地 放在 处理 业务 逻辑 上 redis 如何 设置 密码 及 验证 密码 设置 密码 授权 密码 auth 说说 redis 哈希 槽 的 概念 答 redis 集群 没有 使用 一致性 hash 而是 引 入了 哈希 槽 的 概念 redis 集群 有 个 哈希 槽 每个 key 通过 crc 校验 后 对 取 模 来 决定 放置 哪个 槽 集群 的 每个 节点 负责 一部分 hash 槽 redis 集群 的 主从复制 模型 是 怎样 的 答 为了 使 在 部分 节点 失败 或者 大部分 节点 无法 通信 的 情况下 集群 仍然 可用 所以 集群 使 用了 主从复制 模型 每个 节点 都会 有 n 个 复制品 redis 集群 会有 写 操作 丢失 吗 为什么 答 redis 并不能 保证 数据 的 强 一致性 这 意味 这在 实际 中 集群 在 特定 的 条件下 可能会 丢 失写 操作 redis 集群 之间 是 如何 复制 的 答 异步 复制 redis 集群 最大 节点 个数 是多少 答 个 redis 集群 如何 选择 数据库 答 redis 集群 目前 无法 做 数据库 选择 默认 在 数据库 怎么 测试 redis 的 连通性 答 使用 ping 命令 怎么 理解 redis 事务 答 事务 是 一个 单独 的 隔离 操作 事务 中 的 所有 命令 都会 序列化 按 顺序 地 执行 事务 在 执行 的 过程中 不 会被 其他 客户端 发 送来 的 命令 请求 所 打断 事务 是 一个 原子 操作 事务 中 的 命令 要么 全部 被执行 要么 全部 都不 执行 redis 事务 相关 的 命令 有 哪几个 答 的 过期 时间 和 永久 有效 分别 怎么 设置 答 expire 和 persist 命令 redis 如何做 内存 优化 答 尽可能 使用 散 列表 hashes 散 列表 是 说 散 列表 里面 存储 的 数 少 使用 的 内存 非常 小 所以 你 应该 尽可能 的 将你 的 数据模型 抽象 到 一个 散 列表 里面 比如 你 的 web 系统 中有 一个 用户 对象 不 要为 这个 用户 的 名称 姓氏 邮箱 密码 设置 单独 的 key 而是 应该 把 这个 用户 的 所有 信息 存储 到 一张 散 列表 里面 redis 回收 进程 如何 工作 的 答 一个 客户端 运 行了 新 的 命令 添 加了 新 的 数据 redi 检查 内存 使用情况 如果 大于 maxmemory 的 限制 则 根据 设 定好 的 策略 进行 回收 一个 新 的 命令 被执行 等等 所以 我们 不断地 穿越 内存 限制 的 边界 通过 不断 达到 边界 然后 不断地 回收 回到 边界 以下 如果 一个 命令 的 结果 导致 大量 内存 被 使用 例如 很大 的 集合 的 交集 保 存到 一个 新 的 键 不用 多久 内存 限制 就会 被 这个 内存 使用量 超越 都有 哪些 办法 可以 降低 redis 的 内存 使用情况 呢 答 如果 你 使用 的 是 位 的 redis 实例 可以 好好 利用 等 集合 类型 数据 因为 通常情况下 很多 小 的 keyvalue 可以用 更 紧凑 的 方式 存 放到 一起 redis 的 内存 用 完了 会 发生 什么 答 如果 达到 设置 的 上限 redis 的 写 命令 会 返回 错误信息 但是 读 命令 还 可以 正常 返回 或者 你 可以 将 redis 当 缓存 来 使用 配置 淘汰 机制 当 redis 达到 内存 上限 时会 冲 刷掉 旧 的 内容 一个 redis 实例 最 多能 存放 多少 的 他们 最 多能 存放 多少 元素 答 理论上 redis 可以 处理 多达 的 keys 并且在 实际 中进 行了 测试 每个 实例 至少 存 放了 亿千万 的 keys 我们 正在 测试 一些 较大 的 值 任何 listset 和 sortedset 都可以 放个 元素 换句话说 redis 的 存储 极限 是 系统 中 的 可用内存 值 mysql 里 有 w 数据 redis 中 只 存 w 的 数据 如何 保证 redis 中 的 数据 都是 热点 数据 答 redis 内存 数据 集 大小 上 升到 一定 大小 的 时候 就会 施行 数据 淘汰 策略 相关 知识 redis 提供 种 数据 淘汰 策略 volatilelru 从 已设置 过期 时间 的 数据 集 中 挑选 最近 最少 使用 的 数据 淘汰 volatilettl 从 已设置 过期 时间 的 数据 集 中 挑选 将要 过期 的 数据 淘汰 volatilerandom 从 已设置 过期 时间 的 数据 集 中 任意 选择 数据 淘汰 allkeyslru 从 数据 集 serverdbidict 中 挑选 最近 最少 使用 的 数据 淘汰 allkeysrandom 从 数据 集 serverdbidict 中 任意 选择 数据 淘汰 noenviction 驱逐 禁止 驱逐 数据 redis 最适合 的 场景 会话 缓存 sessioncache 最 常用 的 一种 使用 redis 的 情景 是 会话 缓存 sessioncache 用 redis 缓存 会话 比 其他 存储 如 memcached 的 优势 在于 redis 提供 持久 化 当 维护 一个 不是 严格要求 一致性 的 缓存 时 如果 用户 的 购物车 信息 全部 丢失 大部分 人 都会 不高兴 的 现在 他们 还会 这样 吗 幸运 的 是 随着 redis 这些年 的 改进 很 容易 找到 怎么 恰当 的 使用 redis 来 缓存 会话 的 文档 甚至 广 为人 知 的 商业 平台 magento 也 提供 redis 的 插件 全 页 缓存 fpc 除 基本 的 会话 token 之外 redis 还 提供 很 简便 的 fpc 平台 回到 一致 性问题 即使 重启 了 redis 实例 因为 有 磁盘 的 持久 化 用户 也 不会 看到 页面 加载 速度 的 下降 这是 一个 极大 改进 类似 php 本地 fpc 再次 以 magento 为 例 magento 提供 一个 插件 来 使用 redis 作为 全 页 缓存 后端 此外 对 wordpress 的 用户 来说 pantheon 有 一个 非常好 的 插件 wpredis 这个 插件 能 帮助 你 以 最快 速度 加载 你 曾 浏览 过 的 页面 队列 reids 在 内存 存储 引擎 领域 的 一大 优点 是 提供 list 和 set 操作 这 使得 redis 能 作为 一个 很好 的 消息 队列 平台 来 使用 redis 作为 队列 使用 的 操作 就 类似于 本地 程序语言 如 python 对 list 的 pushpop 操作 如果 你 快速 的 在 google 中 搜索 redisqueues 你 马上 就能 找到 大量 的 开源 项目 这些 项目 的 目的 就是 利用 redis 创建 非常好 的 后端 工具 以 满足 各种 队列 需求 例如 celery 有 一个 后台 就是 使用 redis 作为 broker 你 可以 从 这里 去 查看 排行榜 计数器 redis 在 内存 中 对 数字 进行 递增 或 递减 的 操作 实现 的 非常好 集合 set 和 有序 集合 sortedset 也 使得 我们 在 执行 这些 操作 的 时候 变 的 非常 简单 redis 只是 正好 提供 了 这两种 数据结构 所以 我们 要从 排序 集合 中 获 取到 排名 最 靠前 的 个 用户 我们 称之为 userscores 我们 只需要 像 下面 一样 执行 即可 当然 这是 假定 你 是 根据 你 用户 的 分数 做 递增 的 排序 如果 你想 返回 用户 及 用户 的 分数 你 需要 这样 执行 就是 一个 很好 的 例子 用 ruby 实现 的 它 的 排行榜 就是 使用 redis 来 存储 数据 的 你 可以 在这里 看到 发布 订阅 最后 但 肯定 不是 最不 重要 的 是 redis 的 发布 订阅 功能 发布 订阅 的 使用 场景 确实 非常 多 我 已 看见 人们 在 社交 网络连接 中 使用 还可 作为 基于 发布 订阅 的 脚本 触发器 甚至 用 redis 的 发布 订阅 功 能来 建立 聊天 系统 假如 redis 里面 有 亿个 key 其中有 w 个 key 是以 某个 固定 的 已知 的 前缀 开头 的 如果 将 它们 全部 找出来 答 使用 keys 指令 可以 扫出 指定 模式 的 key 列表 对方 接着 追问 如果 这个 redis 正 在给 线上 的 业务 提供 服务 那 使用 keys 指令 会有 什么问题 这个 时候 你 要回答 redis 关键 的 一个 特性 redis 的 单线程 的 keys 指令 会 导致 线程 阻塞 一段时间 线上 服务 会 停顿 直到 指令 执行 完毕 服务 才能 恢复 这个 时候 可以 使用 scan 指令 scan 指令 可以 无 阻塞 的 提 取出 指定 模式 的 key 列表 但是 会有 一定 的 重复 概率 在 客户端 做 一次 去 重 就可以 了 但是 整体 所 花费 的 时间 会比 直接 用 keys 指令 长 如果有 大量 的 key 需要 设置 同一时间 过期 一般 需要 注意 什么 答 如果 大量 的 key 过期 时间 设置 的 过于 集中 到 过期 的 那个 时间 点 redis 可能会 出现 短暂 的卡 顿 现象 一般 需 要在 时间 上 加 一个 随机 值 使得 过期 时间 分散 一些 使 用过 redis 做 异步 队列 么 你 是 怎么 用 的 答 一般 使用 list 结构 作为 队列 rpush 生产 消息 lpop 消费 消息 当 lpop 没有 消息 的 时候 要 适当 sleep 一会 再 重试 如果 对方 追问 可不可以 不用 sleep 呢 list 还有 个 指令 叫 blpop 在 没有 消息 的 时候 它会 阻塞住 直到 消息 到来 如果 对方 追问 能不能 生产 一次 消费 多次 呢 使用 pubsub 主题 订阅 者 模式 可以 实现 n 的 消息 队列 如果 对方 追问 pubsub 有 什么 缺 点在 消费者 下线 的 情况下 生产 的 消息 会 丢失 得 使用 专业 的 消息 队列 如 rabbitmq 等 如果 对方 追问 redis 如何 实现 延时 队列 我 估计 现在 你 很 想把 面试官 一棒 打死 如果 你 手 上有 一根 棒 球棍 的话 怎么 问 的 这么 详细 但是 你 很 克制 然后 神态自若 的 回 答道 使用 sortedset 拿 时间 戳 作为 score 消息 内容 作为 key 调用 zadd 来 生产 消息 消费者 用 zrangebyscore 指令 获取 n 秒 之前 的 数据 轮询 进行 处 理到 这里 面试官 暗地里 已经 对 你 竖 起了 大拇指 但是 他 不知道 的 是 此刻 你 却 竖 起了 中 指在 椅子 背后 使 用过 redis 分布式 锁 么 它是 什么 回 事先 拿 setnx 来 争抢 锁 抢到 之后 再用 expire 给 锁 加 一个 过期 时间 防止 锁 忘 记了 释放 这时候 对方 会 告诉 你 说 你 回答 得 不错 然后 接着 问 如果在 setnx 之后 执行 expire 之前 进程 意外 cra ash 或者 要 重启 维护 了 那会 怎么样 这时候 你 要 给予 惊讶 的 反馈 唉 是 喔 这个 锁 就 永远 得不到 释 放了 紧接着 你 需要 抓 一抓 自己 得 脑袋 故作 思考 片刻 好像 接下来 的 结果是 你 主动 思考 出来 的 然后 回答 我 记得 set 指令 有 非常复杂 的 参数 这个 应该是 可以 同时 把 setnx 和 expire 合成 一条 指令 来用 的 对方 这 时会 显露 笑容 心里 开始 默念 摁 这小子 还 不错 整 理了 道 多家 公司 java 面试题 多 页 pdf 文档 关注 公 种 浩 程序员 追风 回复 获取 这些 整理 的 资料 针对于 上面 的 面试 问到 的 知识 点我 总结 出了 互联网 公司 java 程序员 面试 涉及到 的 绝大部分 面试题 及 答案 做 成了 文档 和 架构 资料 分享 给 大 家家 希望能 帮助 到 您 面试 前 的 复习 且 找到 一个 好 的 工作 也 节省 大家 在 网上 搜索 资料 的 时间 来 学习 最后 欢迎 大家 一起 交流 整理 资料 不易 喜欢 文章 记得 点个 赞 哟 感谢 支持 