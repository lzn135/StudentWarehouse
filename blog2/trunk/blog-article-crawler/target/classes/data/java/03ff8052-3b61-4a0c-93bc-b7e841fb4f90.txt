2 万字 java 并发 编程 面试题 合集 含答案 建议 收藏 java 并发 编程 在 java 中 守护 线程 和 本地 线程 区别 线程 与 进程 的 区别 什么 是 多线程 中 的 上下文切换 死锁 与 活 锁 的 区别 死锁 与 饥饿 的 区别 java 中 用到 的 线程 调度 算法 是什么 什么 是 线程 组 为什么 在 java 中 不 推荐 使用 为什么 使用 executor 框 架在 java 中 executor 和 executors 的 区别 如 何在 windows 和 linux 上 查找 哪个 线程 使用 的 cpu 时间 最长 什么 是 原子 操作 在 中有 哪些 原 子类 atomicclasses 中 的 lock 接口 lockinterface 是什么 对比 同步 它有 什么 优势 什么 是 executors 框架 什么 是 阻塞 队列 阻塞 队列 的 实现 原理 是什么 如何 使用 阻塞 队列 来 实现 生产者 消费者 模型 什么 是 callable 和 future 什么 是 futuretask 使用 executorservice 启动 任务 什么 是 并发 容器 的 实现 多线程 同步 和 互斥 有 几种 实现 方法 都是 什么 什么 是 竞争 条件 你 怎样 发现 和 解决 竞争 你 将 如何 使用 threaddump 你 将 如何 分析 threaddump 为什么 我们 调用 start 方法 时会 执行 run 方法 为什么 我们 不能 直接 调用 run 方法 java 中 你 怎样 唤醒 一个 阻塞 的 线程 在 java 中 cyclibarriar 和 countdownlatch 有 什么区别 什么 是 不 可变 对象 它对 写 并发 应用 有 什么 帮助 什么 是 多线程 中 的 上下文切换 java 中 用到 的 线程 调度 算法 是什么 什么 是 线程 组 为什么 在 java 中 不 推荐 使用 为什么 使用 executor 框架 比 使用 应用 创 建和 管理 线程 好 java 中有 几种 方法 可以 实现 一个 线程 如何 停止 一个 正在 运行 的 线程 notify 和 notifyall 有 什么区别 什么 是 daemon 线程 它有 什么 意义 java 如何 实现 多线程 之间 的 通讯 和 协作 什么 是 可 重入 锁 reentrantlock 当 一个 线程 进入 某个 对象 的 一个 synchronized 的 实例 方法 后 其它 线程 是否 可 进入 此 对象 的 其它 方法 乐观 锁 和 悲观 锁 的 理解 及 如何 实现 有 哪些 实现 方式 synchronizedmap 和 有 什么区别 可以 用于 什么 应用 场景 什么 叫 线程 安全 servlet 是 线程 安全 吗 volatile 有 什么用 能否 用 一句话 说明 下 volatile 的 应用 场景 为什么 代码 会 重 排序 在 java 中 wait 和 sleep 方法 的 不 同用 java 实现 阻塞 队列 一个 线程 运行时 发生 异 常会 怎样 如 何在 两个 线程 间 共享 数据 java 中 notify 和 notifyall 有 什么区别 为什么 waitnotify 和 notifyall 这些 方法 不在 thread 类 里面 什么 是 threadlocal 变量 java 中 interrupted 和 isinterrupted 方法 的 区别 为什么 wait 和 notify 方法 要在 同步 块 中 调用 为什么 你 应该在 循 环中 检查 等待 条件 java 中 的 同步 集合 与 并发 集合 有 什么区别 什么 是 线程 池 为什么 要使 用它 怎么 检测 一个 线程 是否 拥有 锁 你 如 何在 java 中 获取 线程 堆栈 thread 类 中 的 yield 方法 有 什么 作用 java 中 的 并发 度 是什么 java 中 semaphore 是什么 java 线程 池中 submit 和 execute 方法 有 什么区别 什么 是 阻塞 式 方法 java 中 的 readwritelock 是什么 volatile 变量 和 atomic 变量 有 什么 不同 可以 直接 调用 thread 类 的 run 方法 么 如何 让 正在 运行 的 线程 暂停 一段时间 你 对 线程 优先级 的 理解 是什么 什么 是 线程 调度 器 threadscheduler 和 时间 分片 timeslicing 你 如何 确保 main 方法 所在 的 线程 是 java 程序 最后 结束 的 线程 线程 之间 是 如何 通信 的 为什么 线程 通信 的 方法 wait notify 和 notifyall 被 定义 在 object 类 里 为什么 wait notify 和 notifyall 必 须在 同步 方法 或者 同步 块 中被 调用 为什么 thread 类 的 sleep 和 yield 方法 是 静态 的 如何 确保 线程 安全 同步 方法 和 同步 块 哪个 是 更好 的 选择 如何 创建 守护 线程 什么 是 javatimer 类 如何 创建 一个 有 特定 时间 间隔 的 任务 关于 java 并发 编程 的 只是 总 结了 一个 思维 导 图 分享 给 大家 在 java 中 守护 线程 和 本地 线程 区别 java 中 的 线程 分为 两种 守护 线程 daemon 和 用户 线程 user 任何 线程 都可以 设置 为 守护 线程 和 用户 线程 通过 方法 threadsetdaemon boolon true 则 把 该 线程 设置 为 守护 线程 反之 则为 用户 线程 threadsetdaemon 必 须在 threadstart 之前 调用 否则 运行 时会 抛出 异常 两者 的 区别 唯一 的 区 别是 判断 虚拟机 jvm 何时 离开 daemon 是 为 其他 线程 提供 服务 如果 全部 的 userthread 已经 撤离 daemon 没有 可 服务 的 线程 jvm 撤离 也 可以 理解为 守护 线程 是 jvm 自动 创建 的 线程 但不 一定 用户 线程 是 程序 创建 的 线程 比如 jvm 的 垃圾 回收 线程 是 一个 守护 线程 当 所有 线程 已经 撤离 不再 产生 垃圾 守护 线程 自然 就 没事 可 干 了当 垃圾 回收 线程 是 java 虚拟 机上 仅剩 的 线程 时 java 虚拟 机会 自动 离开 扩展 threaddump 打印 出来 的 线程 信息 含有 daemon 字样 的 线程 即为 守护 进程 可能 会有 服务 守护 进程 编译 守护 进程 windows 下 的 监听 ctrlbreak 的 守护 进程 finalizer 守护 进程 引用 处理 守护 进程 gc 守护 进程 线程 与 进程 的 区别 进程 是 操作系统 分配 资源 的 最小 单元 线程 是 操作系统 调度 的 最小 单元 一个 程序 至少有 一个 进程 一个 进程 至少有 一个 线程 什么 是 多线程 中 的 上下文切换 多线程 会 共同 使用 一组 计算 机上 的 cpu 而 线程 数 大于 给 程序 分配 的 cpu 数量 时 为了 让 各个 线程 都有 执行 的 机会 就需要 轮转 使用 cpu 不同 的 线程 切换 使用 cpu 发生 的 切换 数据 等 就是 上下文切换 死锁 与 活 锁 的 区别 死锁 与 饥饿 的 区别 死锁 是 指 两个 或 两个 以上 的 进程 或 线程 在 执行 过程中 因 争夺 资源 而 造成 的 一种 互相 等待 的 现象 若无 外力作用 它们 都将 无法 推进 下去 产生 死锁 的 必要条件 互斥 条件 所谓 互斥 就是 进程 在 某一 时间内 独占 资源 请求 与 保持 条件 一个 进程 因 请求 资源 而 阻塞 时 对 已 获得 的 资源 保持 不放 不 剥夺 条件 进程 已 获得 资源 在 末 使 用完 之前 不能 强行 剥夺 循环 等待 条件 若干 进程 之间 形成 一种 头尾 相接 的 循环 等待 资源 关系 活 锁 任务 或者 执行者 没有 被 阻塞 由于 某些 条件 没有 满足 导致 一直 重复 尝试 失败 尝试 失败 活 锁 和 死锁 的 区别 在于 处于 活 锁 的 实体 是 在 不断 的 改变 状态 所谓 的 活 而 处于 死锁 的 实体 表 现为 等待 活 锁 有 可能 自行 解开 死锁 则 不能 饥饿 一个 或者 多个 线程 因为 种种原因 无法 获得 所 需要 的 资源 导致 一直 无法 执行 的 状态 java 中 导致 饥饿 的 原因 高 优先级 线程 吞噬 所有 的 低 优先级 线程 的 cpu 时间 线程 被 永久 堵 塞在 一个 等待 进入 同步 块 的 状态 因为 其他 线程 总是 能在 它 之前 持续 地 对 该 同步 块 进行 访问 线程 在 等待 一个 本身 也 处于 永久 等待 完成 的 对象 比如 调用 这个 对象 的 wait 方法 因为 其他 线程 总是 被 持续 地 获得 唤醒 java 中 用到 的 线程 调度 算法 是什么 采用 时间 片 轮转 的 方式 可以 设置 线程 的 优先 级会 映 射到 下层 的 系统 上面 的 优先级 上 如 非 特别 需要 尽量 不 要用 防止 线程 饥饿 什么 是 线程 组 为什么 在 java 中 不 推荐 使用 threadgroup 类 可以 把 线程 归属 到 某一个 线程 组 中 线程 组 中 可以 有 线程 对象 也 可以 有 线程 组组 中 还 可以 有 线程 这样 的 组织 结构 有点 类似于 树 的 形式 为什么 不 推荐 使用 因为 使用 有 很多 的 安全隐患 吧 没有 具体 追究 如果 需要 使用 推荐 使用 线程 池 为什么 使用 executor 框架 每次 执行任务 创建 线程 newthread 比较 消耗 性能 创建 一个 线程 是 比较 耗时 耗 资源 的 调用 newthread 创建 的 线程 缺乏 管理 被称为 野 线程 而且 可以 无限制 的 创建 线程 之间 的 相互竞争 会 导致 过多 占用 系统资源 而 导致 系统 瘫痪 还有 线程 之间 的 频繁 交替 也 会 消耗 很多 系统资源 接 使用 newthread 启动 的 线程 不利于 扩展 比如 定时 执行 定期 执行 定时 定期 执行 线程 中断 等 都 不便 实 现在 java 中 executor 和 executors 的 区别 executors 工具 类 的 不同 方法 按照 我们 的 需求 创 建了 不同 的 线程 池 来 满足 业务 的 需求 executor 接口 对象 能 执行 我们 的 线程 任务 executorservice 接口 继承 了 executor 接口 并进 行了 扩展 提供 了 更多 的 方法 我们 能 获得 任务 执行 的 状态 并且 可以 获取 任务 的 返回值 使用 可以 创建 自定义 线程 池 future 表示 异步 计算 的 结果 他 提供 了 检查 计算 是否 完成 的 方法 以 等待 计算 的 完成 并可以 使用 get 方法 获取 计算 的 结果 如 何在 windows 和 linux 上 查找 哪个 线程 使用 的 cpu 时间 最长 什么 是 原子 操作 在 中有 哪些 原 子类 atomicclasses 原子 操作 atomicoperation 意为 不 可被 中断 的 一个 或 一系列 操作 处理器 使用 基于 对 缓存 加锁 或 总线 加锁 的 方式 来 实现 多处理器 之间 的 原子 操作 在 java 中 可以 通过 锁 和 循环 cas 的 方式 来 实现 原子 操作 cas 操作 compareampset 或是 compareampswap 现在 几乎 所有 的 cpu 指令 都 支持 cas 的 原子 操作 原子 操作 是 指 一个 不受 其他 操作 影响 的 操作 任务 单元 原子 操作 是 在 多线程 环境 下 避免 数据 不一致 必须 的 手段 int 并不是 一个 原子 操作 所以 当 一个 线程 读取 它 的 值 并 加 时 另外 一个 线程 有 可能会 读到 之前 的 值 这 就会 引发 错误 为了 解决 这个 问题 必须 保证 增加 操作 是 原子 的 在 jdk 之前 我们 可以 使用 同步 技术 来 做到 这一 点到 包 提供 了 int 和 long 类型 的 原子 包装 类 它们 可以 自动 的 保证 对于 他们 的 操作 是 原子 的 并且 不需要 使用 同步 这个 包 里面 提供 了 一组 原 子类 其 基本 的 特性 就是在 多线程 环境 下 当 有 多个 线程 同时 执行 这些 类 的 实例 包含 的 方法 时 具有 排他性 即 当 某个 线程 进入 方法 执行 其中 的 指令 时 不 会被 其他 线程 打断 而别 的 线程 就像 自旋 锁 一样 一直 等到 该 方法 执行 完 成才 由 jvm 从 等待 队列 中 选择 一个 另一个 线程 进入 这 只是 一种 逻 逻辑 上 的 理解 原 子类 原子 数组 原子 属性 更新 器 解决 aba 问题 的 原 子类 通过 引入 一个 boolean 来 反映 中间 有没有 变过 通过 引入 一个 int 来 累 加来 反映 中间 有没有 变过 中 的 lock 接口 lockinterface 是什么 对比 同步 它有 什么 优势 lock 接口 比 同步 方法 和 同步 块 提供 了 更具 扩展性 的 锁 操作 他们 允许 更 灵活 的 结构 可以 具有 完全 不同 的 性质 并且 可以 支持 多个 相关 类 的 条件 对象 它 的 优势 有 可 以使 锁 更 公平 可 以使 线程 在 等待 锁 的 时候 响应 中断 可以 让 线程 尝试 获取 锁 并在 无法 获取 锁 的 时候 立即 返回 或者 等待 一段时间 可以 在 不同 的 范围 以 不同 的 顺序 获取 和 释放 锁 整体 上 来说 lock 是 synchronized 的 扩展 版 lock 提供 了无 条件 的 可 轮询 的 trylock 方法 定时 的 trylock 带 参 方法 可 中断 的 可多 条件 队列 的 newcondition 方法 锁 操作 另外 lock 的 实现 类 基本 都 支持 非 公平 锁 默认 和 公平 锁 synchronized 只 支持 非 公平 锁 当然在 大部分 情况下 非 公平 锁 是 高效 的 选择 什么 是 executors 框架 executor 框架 是 一个 根据 一组 执行 策略 调用 调度 执行 和 控制 的 异步 任务 的 框架 无限制 的 创建 线程 会引起 应用程序 内存 溢出 所以 创建 一个 线程 池 是 个 更好 的 的 解决方案 因为 可以 限制 线程 的 数量 并且 可以 回收 再利用 这些 线程 利用 executors 框架 可以 非常 方便 的 创建 一个 线程 池 什么 是 阻塞 队列 阻塞 队列 的 实现 原理 是什么 如何 使用 阻塞 队列 来 实现 生产者 消费者 模型 阻塞 队列 blockingqueue 是 一个 支持 两个 附加 操作 的 队列 这两个 附加 的 操作 是 在 队 列为 空 时 获取 元素 的 线程 会 等待 队列 变为 非 空当 队列 满 时 存储 元素 的 线程 会 等待 队列 可用 阻塞 队列 常 用于 生产者 和 消费者 的 场景 生产者 是 往 队列 里 添加 元素 的 线程 消费者 是 从 队列 里 拿 元素 的 线程 阻塞 队列 就是 生产者 存放 元素 的 容器 而 消费者 也 只 从 容器 里 拿 元素 jdk 提供 了 个 阻塞 队列 分 别是 一个 由 数组 结构 组成 的 有界 阻塞 队列 一个 由 链表 结构 组成 的 有界 阻塞 队列 一个 支持 优先级 排序 的 无界 阻塞 队列 delayqueue 一个 使用 优先级 队列 实现 的 无界 阻塞 队列 一个 不 存储 元素 的 阻塞 队列 一个 由 链表 结构 组成 的 无界 阻塞 队列 一个 由 链表 结构 组成 的 双向 阻塞 队列 java 之前 实现 同步 存取 时 可以 使用 普通 的 一个 集合 然后 在 使用 线程 的 协 作和 线程 同步 可以 实现 生产者 消费者 模式 主要 的 技术 就是 用好 这些 关键字 而在 java 之后 可以 使用 阻塞 队列 来 实现 此 方式 大大 简 少了 代码 量 使得 多线程 编程 更加 容易 安全 方面 也有 保障 blockingqueue 接口 是 queue 的 子 接口 它 的 主要用途 并不是 作为 容器 而是 作为 线程 同步 的 的 工具 因此 他 具有 一个 很明显 的 特性 当 生产者 线程 试图 向 blockingqueue 放入 元素 时 如果 队列 已满 则 线程 被 阻塞 当 消费者 线程 试图 从中 取出 一个 元素 时 如果 队 列为 空 则 该 线程 会被 阻塞 正是 因为 它所 具有 这个 特性 所以在 程序 中 多个 线程 交替 向 blockingqueue 中 放入 元素 取出 元素 它 可以 很好 的 控制 线程 之间 的 通信 阻塞 队列 使用 最 经典 的 场景 就是 socket 客户端 数据 的 读取 和 解析 读取 数据 的 线程 不断 将 数据 放入 队列 然后 解析 线程 不断 从 队列 取 数据 解析 什么 是 callable 和 futurecallable 接口 类似于 runnable 从 名字 就可以看 出 来了 但是 runnable 不会 返回 结果 并且 无法 抛出 返回 结果 的 异常 而 callable 功能 更强 大 一些 被 线程 执行 后 可以 返回值 这个 返回值 可以 被 future 拿到 也就是说 future 可以 拿到 异步 执行任务 的 返回值 可以 认为是 带有 回 调 的 runnablefuture 接口 表示 异步 任务 是 还没有 完成 的 任务 给出 的 未来 结果 所以说 callable 用于 产生 结果 future 用于 获取 结果 什么 是 futuretask 使用 executorservice 启动 任务 在 java 并发 程序 中 futuretask 表示 一个 可以 取消 的 异步 运算 它有 启动 和 取消 运算 查询 运算 是否 完成 和 取回 运算 结果 等 方法 只 有当 运算 完成 的 时候 结果 才能 取回 如果 运算 尚未 完成 get 方法 将会 阻塞 一个 futuretask 对象 可以 对调 用了 callable 和 runnable 的 对象 进行 包装 由于 futuretask 也是 调 用了 runnable 接口 所以 它 可以 提 交给 executor 来 执行 什么 是 并发 容器 的 实现 何为 同步 容器 可以 简单 地 理解为 通过 synchronized 来 实现 同步 的 容器 如果有 多个 线程 调用 同步 容器 的 方法 它们 将会 串行 执行 比如 vectorhashtable 以及 等 方法 返回 的 容器 可以 通过 查看 vectorhashtable 等 这些 同步 容器 的 实现 代码 可以 看到 这些 容器 实现 线程 安全 的 方式 就是 将 它们 的 状态 封装 起来 并在 需要 同步 的 方法 上 加上 关键字 synchronized 并发 容器 使 用了 与 同步 容器 完全 不同 的 加锁 策略 来 提供 更高 的 并 发性 和 伸缩性 例 如在 中 采 用了 一种 粒度 更 细 的 加锁 机制 可以 称为 分段 锁在 这种 锁 机制 下 允许 任意 数量 的 读 线程 并发 地 访问 map 并且 执行 读 操作 的 线程 和 写 操作 的 线程 也 可以 并发 的 访问 map 同时 允许 一定 数量 的 写 操作 线程 并发 地 修改 map 所以 它 可以 在 并发 环境 下 实现 更高 的 吞吐量 多线程 同步 和 互斥 有 几种 实现 方法 都是 什么 线程 同步 是 指 线程 之间 所 具有 的 一种 制约 关系 一个 线程 的 执行 依赖 另一个 线程 的 消息 当 它 没有 得到 另一个 线程 的 消息 时 应 等待 直到 消息 到达 时 才 被 唤醒 线程 互斥 是 指 对于 共享 的 进程 系统资源 在 各 单个 线程 访问 时 的 排 它 性 当 有 若干个 线程 都要 使用 某一 共享资源 时 任何时刻 最多 只允许 一个 线程 去 使用 其它 要 使用 该 资源 的 线程 必须 等待 直到 占用 资源 者 释放 该 资源 线程 互斥 可以 看成是 一种 特殊 的 线程 同步 线程 间 的 同步 方法 大体 可分为 两类 用户 模式 和 内核 模式 顾名思义 内核 模式 就是指 利用 系统 内核 对象 的 单一性 来 进行 同步 使 用时 需要 切换 内核 态 与 用户 态 而 用户 模式 就是 不需要 切 换到 内核 态 只 在 用户 态 完成 操作 用户 模式 下 的 方法 有 原子 操作 例如 一个 单一 的 全局变量 临界 区 内核 模式 下 的 方法 有 事件 信号量 互斥 量 什么 是 竞争 条件 你 怎样 发现 和 解决 竞 争当 多个 进程 都 企图 对 共享 数据 进行 某种 处理 而 最后 的 结果 又 取决于 进程 运行 的 顺 序时 则 我们 认为 这 发 生了 竞争 条件 racecondition 你 将 如何 使用 threaddump 你 将 如何 分析 threaddump 新建 状态 new 用 new 语句 创建 的 线程 处于 新建 状态 此时 它 和 其他 java 对象 一样 仅 仅在 堆 区 中被 分 配了 内存 就绪 状态 runnable 当 一个 线程 对象 创建 后 其他 线程 调 用它 的 start 方法 该 线程 就 进入 就绪 状态 java 虚拟机 会为 它 创建 方法 调用 栈 和 程序 计数器 处于 这个 状态 的 线程 位于 可 运行 池中 等待 获得 cpu 的 使用权 运行 状态 running 处于 这个 状态 的 线程 占用 cpu 执行 程序代码 只有 处于 就绪 状态 的 线程 才有 机会 转到 运行 状态 阻塞状态 blocked 阻塞状态 是 指 线程 因为 某些 原因 放弃 cpu 暂时 停止 运 行当 线程 处于 阻塞状态 时 java 虚拟机 不 会给 线程 分配 cpu 直到 线程 重新 进入 就绪 状态 它 才有 机会 转到 运行 状态 阻塞状态 可分为 以 下种 位于 对象 等待 池中 的 阻塞状态 当 线程 处于 运行 状态 时 如果 执 行了 某个 对象 的 wait 方法 java 虚拟机 就 会把 线程 放到 这个 对象 的 等待 池中 这 涉及到 线程 通信 的 内容 位于 对象 锁 池中 的 阻塞状态 当 线程 处于 运行 状态 时 试图 获得 某个 对象 的 同步 锁 时 如果 该 对象 的 同步 锁 已经 被 其他 线程 占用 java 虚拟机 就 会把 这个 线程 放到 这个 对象 的 锁 池中 这 涉及到 线程 同步 的 内容 其他 阻塞状态 当前 线程 执 行了 sleep 方法 或者 调 用了 其他 线程 的 join 方法 或者 发 出了 io 请求 时 就会 进入 这个 状态 死亡 状态 dead 当 线程 退出 run 方法 时 就 进入 死亡 状态 该 线程 结束 生命周期 为什么 我们 调用 start 方法 时会 执行 run 方法 为什么 我们 不能 直接 调用 run 方法 当你 调用 start 方法 时 你 将 创建 新 的 线程 并且 执 行在 run 方法 里 的 代码 但是 如果 你 直接 调用 run 方法 它 不会 创建 新 的 线程 也 不会 执行 调用 线程 的 代码 只 会把 run 方法 当作 普通 方法 去 执行 java 中 你 怎样 唤醒 一个 阻塞 的 线程 在 java 发展 史上 曾经 使用 suspend resume 方法 对于 线程 进行 阻塞 唤醒 但 随之 出现 很多 问题 比较 典型 的 还是 死锁 问题 解决方案 可以 使用 以 对象 为 目标 的 阻塞 即 利用 object 类 的 wait 和 notify 方法 实现 线程 阻塞 首先 waitnotify 方法 是 针对 对象 的 调用 任意 对象 的 wait 方法 都将 导致 线程 阻塞 阻塞 的 同时 也 将 释放 该 对象 的 锁 相应 地 调用 任意 对象 的 notify 方法 则将 随机 解除 该 对象 阻塞 的 线程 但它 需要 重新 获取 改 对象 的 锁 直到 获取 成功 才能 往下 执行 其次 waitnotify 方法 必 须在 synchronized 块 或 方法 中被 调用 并且 要 保证 同步 块 或 方法 的 锁 对象 与 调用 waitnotify 方法 的 对 象是 同一个 如此一来 在 调用 wait 之前 当前 线程 就 已经 成功 获取 某 对象 的 锁 执行 wait 阻塞 后 当前 线程 就将 之前 获取 的 对象 锁 释 放在 java 中 cyclibarriar 和 countdo ownlatch 有 什么区别 cyclicbarrier 可以 重复使用 而 countdownlatch 不能 重复使用 java 的 concurrent 包 里面 的 countdownlatch 其实 可以 把 它 看作 一个 计数器 只不过 这个 计数器 的 操作 是 原子 操作 同时 只能 有 一个 线程 去 操作 这个 计数器 也 就是 同时 只能 有 一个 线程 去 减 这个 计数器 里面 的 值 你 可以 向 countdownlatch 对象 设置 一个 初始 的 数字 作为 计 数值 任何 调用 这个 对象 上 的 await 方法 都会 阻塞 直到 这个 计数器 的 计 数值 被 其他 的 线程 减为 为止 所以在 当前 计数 到达 零 之前 await 方 法会 一直 受 阻塞 之 后会 释放 所有 等待 的 线程 await 的 所有 后续 调用 都将 立即 返回 这种 现象 只 出现 一次 计数 无法 被 重置 如果 需要 重置 计数 请 考虑 使用 的 一个 非常 典型 的 应用 场景 是 有 一个 任务 想要 往下 执行 但 必须 要 等到 其他 的 任务 执行 完毕 后 才 可以 继续 往下 执行 假如 我们 这个 想要 继续 往下 执行 的 任务 调用 一个 countdownlatch 对象 的 await 方法 其他 的 任务 执行 完 自己 的 任务 后 调用 同一个 countdownlatch 对象 上 的 countdown 方法 这个 调用 await 方法 的 任务 将 一直 阻塞 等待 直到 这个 countdownlatch 对象 的 计 数值 减到 为止 cyclicbarrier 一个 同步 辅助 类 它 允许 一组 线程 互相 等待 直到 到达 某个 公共 屏障 点 在 涉及 一组 固定 大小 的 线程 的 程序 中 这些 线程 必须 不时 地 互相 等待 此时 cyclicbarrier 很 有用 因为 该 barrier 在 释放 等待 线程 后 可以 重用 所以 称 它为 循环 的 barrier 什么 是 不 可变 对象 它对 写 并发 应用 有 什么 帮助 不 可变 对象 即 对象 一旦 被 创建 它 的 状态 对象 的 数据 也 即 对象 属性 值 就不能 改变 反之 即为 可变 对象 mutableobjects 不 可变 对象 的 类 即为 不 可变 类 immutableclass java 平台 类 库 中 包含 许多 不 可变 类 如 string 基本 类型 的 包装 类 biginteger 和 bigdecimal 等 不 可变 对象 天生 是 线程 安全 的 它们 的 常量 域 是 在 构造 函数 中 创建 的 既然 它们 的 状态 无法 修改 这些 常量 永远 不会 变 不 可变 对象 永远是 线程 安全 的 只有 满足 如下 状态 一个 对象 才是 不 可变 的 它 的 状态 不 能在 创建 后 再被 修改 所有 域 都是 final 类型 并且 它被 正确 创建 创建 期间 没有发生 this 引用 的 逸 出 什么 是 多线程 中 的 上下文切换 在上 下文 切换 过程中 cpu 会 停止 处理 当前 运行 的 程序 并 保存 当前 程序 运行 的 具体位置 以便 之后 继续 运行 从 这个 角度 来看 上下文切换 有点像 我们 同时 阅读 几本书 在 来回 切换 书本 的 同时 我们 需要 记住 每 本书 当前 读到 的 页码 在 程序 中上 下文 切换 过程中 的 页码 信息 是 保 存在 进程 控制 块 pcb 中 的 pcb 还 经常 被称作 切换 桢 switchframe 页码 信息 会 一直 保 存到 cpu 的 内存 中直 到 他们 被 再次 使用 上下文切换 是 存储 和 恢复 cpu 状态 的 过程 它 使得 线程 执行 能够 从中 断点 恢复 执行 上下文切换 是 多任务 操作系统 和 多线程 环境 的 基本特征 java 中 用到 的 线程 调度 算法 是什么 计算机 通常 只有 一个 cpu 在 任意 时刻 只能 执行 一条 机器 指令 每个 线程 只有 获得 cpu 的 使用权 才能 执行 指令 所谓 多线程 的 并发 运行 其实是 指 从 宏观 上 看 各个 线程 轮流 获得 cpu 的 使用权 分别 执行 各自 的 任务 在 运行 池中 会有 多个 处于 就绪 状态 的 线程 在 等待 cpujava 虚拟机 的 一项 任务 就是 负责 线程 的 调度 线程 调度 是 指 按照 特定 机 制为 多个 线程 分配 cpu 的 使用权 有 两种 调度 模型 分时 调度 模型 和 抢占 式 调度 模型 分时 调度 模型 是 指 让 所有 的 线程 轮流 获得 cpu 的 使用权 并且 平均分配 每个 线程 占用 的 cpu 的 时间 片 这个 也 比较好 理解 java 虚拟机 采用 抢占 式 调度 模型 是 指 优 先让 可 运行 池中 优先级 高 的 线程 占用 cpu 如果 可 运行 池中 的 线程 优先级 相同 那么 就 随机 选择 一个 线程 使其 占用 cpu 处于 运行 状态 的 线程 会 一直 运行 直至 它不 得不 放弃 cpu 什么 是 线程 组 为什么 在 java 中 不 推荐 使用 线程 组 和 线程 池 是 两个 不同 的 概念 他们 的 作用 完全 不同 前者 是为了 方便 线程 的 管理 后者 是为了 管理 线程 的 生命周期 复用 线程 减少 创建 销毁 线程 的 开销 为什么 使用 executor 框架 比 使用 应用 创 建和 管理 线程 好 为什么 要 使用 executor 线程 池 框架 每次 执行任务 创建 线程 newthread 比较 消耗 性能 创建 一个 线程 是 比较 耗时 耗 资源 的 调用 newthread 创建 的 线程 缺乏 管理 被称为 野 线程 而且 可以 无限制 的 创建 线程 之间 的 相互竞争 会 导致 过多 占用 系统资源 而 导致 系统 瘫痪 还有 线程 之间 的 频繁 交替 也 会 消耗 很多 系统资源 直接 使用 newthread 启动 的 线程 不利于 扩展 比如 定时 执行 定期 执行 定时 定期 执行 线程 中断 等 都 不便 实现 使用 executor 线程 池 框架 的 优点 能 复用 已 存在 并 空闲 的 线程 从而 减少 线程 对象 的 创建 从而 减 少了 消亡 线程 的 开销 可 有效 控制 最大 并发 线程 数 提高 系统资源 使用率 同时 避免 过多 资源 竞争 框架 中 已经有 定时 定期 单线程 并发 数 控制 等功能 综上所述 使用 线程 池 框架 executor 能 更好 的 管理 线程 提供 系统资源 使用率 java 中有 几种 方法 可以 实现 一个 线程 继承 thread 类 实现 runnable 接口 实现 callable 接口 需要 实现 的 是 call 方法 如何 停止 一个 正在 运行 的 线程 使用 共享 变量 的 方式 在 这种 方式 中 之所以 引入 共享 变量 是因为 该 变量 可以 被 多个 执行 相同 任务 的 线程 用来 作为 是否 中断 的 信号 通知 中断 线程 的 执行 使用 interrupt 方法 终止 线程 如果 一个 线程 由于 等待 某些 事件 的 发生 而 被 阻塞 又该 怎样 停止 该 线程 呢 这种 情况 经常 会 发生 比如 当 一个 线程 由于 需要 等候 键盘输入 而 被 阻塞 或者 调用 threadjoin 方法 或者 threadsleep 方法 在 网络 中 调用 方法 或者 调 用了 方法 时 都有 可能 导致 线程 阻塞 使 线程 处于 处于 不可 运行 状态 时 即使 主程序 中将 该 线程 的 共享 变量 设置 为 true 但 该 线程 此时 根本 无法 检查 循环 标志 当然 也就 无法 立即 中断 这里 我们 给出 的 建议 是 不要 使用 stop 方法 而是 使用 thread 提供 的 interrupt 方法 因为 该 方法 虽然 不会 中断 一个 正在 运行 的 线程 但是 它可 以使 一个 被 阻塞 的 线程 抛出 一个 中断 异常 从 而使 线程 提前结束 阻塞状态 退出 堵塞 代码 notify 和 notifyall 有 什么区别 当 一个 线程 进入 wait 之后 就必须 等 其他 线程 notifynotifyall 使用 notifyall 可以 唤醒 所有 处于 wait 状态 的 线程 使其 重新 进入 锁 的 争夺 队列 中 而 notify 只能 唤醒 一个 如果 没把握 建议 notifyall 防止 notigy 因为 信号 丢失 而 造成 程序 异常 什么 是 daemon 线程 它有 什么 意义 所谓 后台 daemon 线程 是 指在 程序 运行 的 时候 在 后台 提供 一种 通用 服务 的 线程 并且 这个 线程 并不 属于 程序 中 不可或缺 的 部分 因此 当 所有 的 非 后台 线程 结束时 程序 也就 终止 了 同 时会 杀死 进程 中 的 所有 后台 线程 反过来说 只要 有 任何 非 后台 线程 还在 运行 程序 就不会 终止 必须 在 线程 启动 之前 调用 setdaemon 方法 才 能把 它 设置 为 后台 线程 注意 后台 进程 在 不 执行 finally 子句 的 情况下 就会 终止 其 run 方法 比如 jvm 的 垃圾 回收 线程 就是 daemon 线程 finalizer 也是 守护 线程 java 如何 实现 多线程 之间 的 通讯 和 协作 中断 和 共享 变量 什么 是 可 重入 锁 reentrantlock 举例来说 明 锁 的 可 重入 性 publicvoidouter locklock inner lockunlock publicvoidinner locklock outer 中 调 用了 innerouter 先 锁 住了 lock 这样 inner 就不能 再 获取 lock 其实 调用 outer 的 线程 已经 获 取了 lock 锁 但是 不 能在 inner 中 重复 利用 已经 获取 的 锁 资源 这种 锁 即 称之为 不可 重入 可 重入 就 意味着 线程 可以 进入 任何 一个 它 已经 拥有 的 锁 所 同步 着 的 代码 块 都是 可 重入 的 锁 可 重入 锁 相对来说 简 化了 并发 编程 的 开发 当 一个 线程 进入 某个 对象 的 一个 synchronized 的 实例 方法 后 其它 线程 是否 可 进入 此 对象 的 其它 方法 如果 其他 方法 没有 synchronized 的话 其他 线程 是 可以 进入 的 所以 要 开放 一个 线程 安全 的 对象 时 得 保证 每个 方法 都是 线程 安全 的 乐观 锁 和 悲观 锁 的 理解 及 如何 实现 有 哪些 实现 方式 悲观 锁 总是 假设 最坏 的 情况 每次 去拿 数据 的 时候 都 认为 别人 会 修改 所以 每次 在 拿 数据 的 时候 都会 上锁 这样 别人 想 拿 这个 数据 就会 阻塞 直到 它 拿到 锁 传统 的 关系 型 数据库 里边 就用 到了 很多 这种 锁 机制 比如 行 锁 表 锁 等 读 锁 写 锁 等 都是 在做 操作 之前 先 上锁 再 比如 java 里面 的 同步 原语 synchronized 关键字 的 实现 也是 悲观 锁 乐观 锁 顾名思义 就是 很 乐观 每次 去拿 数据 的 时候 都 认为 别人 不会 修改 所以 不会 上锁 但是在 更新 的 时候 会 判断 一下 在此期间 别人 有没有 去 更新 这个 数据 可以 使用 版本号 等 机制 乐观 锁 适用于 多 读 的 应用 类型 这样 可以 提高 吞吐量 像 数据库 提供 的 类似于 writecondition 机制 其实 都是 提供 的 乐观 锁在 java 中 包下 面的 原子 变量 类 就是 使 用了 乐观 锁 的 一种 实现 方式 cas 实现 的 乐观 锁 的 实现 方式 使用 版本 标识 来 确定 读到 的 数据 与 提交 时 的 数据 是否 一致 提交 后 修改 版本 标识 不一致 时 可以 采取 丢弃 和 再次 尝试 的 策略 java 中 的 compareandswap 即 cas 当 多个 线程 尝试 使用 cas 同时 更新 同一个 变量 时 只有 其中 一个 线程 能 更新 变量 的 值 而 其它 线程 都 失败 失败 的 线程 并不 会被 挂起 而是 被 告知 这次 竞争 中 失败 并可以 再次 尝试 cas 操作 中 包含 三个 操作数 需要 读写 的 内存 位置 v 进行 比较 的 预期 原值 a 和 拟 写入 的 新 值 b 如果 内存 位置 v 的 值 与 预期 原值 a 相匹配 那么 处理器 会 自动 将该 位置 值 更新 为 新 值 b 否则 处理器 不做 任何 操作 cas 缺点 aba 问题 比如说 一个 线程 one 从 内存 位置 v 中 取出 a 这时候 另一个 线程 two 也 从 内存 中 取出 a 并且 two 进行了 一些 操作 变 成了 了 b 然后 two 又将 v 位置 的 数据 变成 a 这时候 线程 one 进行 cas 操作 发现 内存 中 仍然是 a 然后 one 操作 成功 尽管 线程 one 的 cas 操作 成功 但 可能 存在 潜藏 的 问题 从 java 开始 jdk 的 atomic 包 里 提供 了 一个 类 来 解决 aba 问题 循环 时间长 开销 大 对于 资源 竞争 严重 线程 冲突 严重 的 情况 cas 自旋 的 概率 会比 较大 从而 浪费 更多 的 cpu 资源 效率 低于 synchronized 只能 保证 一个 共享 变量 的 原子 操作 当 对 一个 共享 变量 执行 操作 时 我们 可以 使用 循环 cas 的 方式 来 保证 原子 操作 但是 对 多个 共享 变量 操作 时 循环 cas 就 无法 保证 操作 的 原子 性 这个 时候 就 可以用 锁 synchronizedmap 和 有 什么区别 synchronizedmap 一次 锁住 整 张 表 来 保证 线程 安全 所以 每次 只能 有 一个 线程 来访 为 使用 分段 锁 来 保证 在 多线程 下 的 性能 中 则是 一次 锁住 一个 桶 默认 将 hash 表 分为 个 桶 诸如 getputremove 等 常用 操作 只 锁 当前 需要 用到 的 桶 这样 原来 只能 一个 线程 进入 现在 却能 同时 有 个 写 线程 执行 并发 性能 的 提升 是 显而易见 的 另外 使 用了 一种 不同 的 迭代 方式 在 这种 迭代 方式 中 当 iterator 被 创建 后 集合 再 发生 改变 就 不再是 抛出 取而代之 的 是 在 改变 时 new 新 的 数据 从而 不影响 原有 的 数据 iterator 完成后 再将 头 指针 替 换为 新 的 数据 这样 iterator 线程 可以 使用 原来 老 的 数据 而 写 线程 也 可以 并发 的 完成 改变 可以 用于 什么 应用 场景 免 锁 容器 的 好处 之 一是 当 多个 迭代 器 同时 遍历 和 修改 这个 列表 时 不会 抛出 在 中 写入 将 导致 创建 整个 底层 数组 的 副本 而 源 数组 将 保留在 原地 使得 复制 的 数组 在被 修 改时 读取 操作 可以 安全地 执行 由于 写 操作 的 时候 需要 拷贝 数组 会 消耗 内存 如果 原 数组 的 内容 比 较多 的 情况下 可能 导致 younggc 或者 fullgc 不能 用于 实时 读 的 场 景像 拷贝 数组 新增 元素 都 需要 时间 所以 调用 一个 set 操作 后读 取到 数据 可能 还是 旧 的 虽然 能 做到 最终 一致性 但是 还是 没法 满足 实时 性要求 透露 的 思想 读写 分离 读 和 写 分开 最终 一致性 使用 另外 开辟 空间 的 思路 来 解决 并发 冲突 什么 叫 线程 安全 servlet 是 线程 安全 吗 线程 安 全是 编程 中 的 术语 指 某个 函数 函数库 在 多线程 环境 中被 调 用时 能够 正确地 处理 多个 线程 之间 的 共享 变量 使 程序 功能 正确 完成 servlet 不是 线程 安全 的 servlet 是 单 实例 多线程 的当 多个 线程 同时 访问 同一个 方法 是 不能 保证 共享 变量 的 线程 安全性 的 struts 的 action 是 多 实例 多线程 的 是 线程 安全 的 每个 请求 过来 都会 new 一个 新 的 action 分配给 这个 请求 请求 完成后 销毁 springmvc 的 controller 是 线程 安全 的 吗 不是 的 和 servlet 类似 的 处理 流程 struts 好处 是 不用 考虑 线程 安全问题 servlet 和 springmvc 需要 考虑 线程 安全问题 但是 性能 可以 提升 不用 处理 太多 的 gc 可以 使用 threadlocal 来 处理 多线程 的 问题 volatile 有 什么用 能否 用 一句话 说明 下 volatile 的 应用 场景 volatile 保证 内存 可 见性 和 禁止 指令 重排 volatile 用于 多线程 环境 下 的 单 次 操作 单 次 读 或者 单 次 写 为什么 代码 会 重 排序 在 执行 程 序时 为了 提供 性能 处理器 和 编译器 常常 会对 指令 进行 重 排序 但是 不能 随意 重 排序 不是 你想 怎么 排序 就 怎么 排序 它 需要 满足 以下 两个 条件 在 单线程 环境 下 不能 改变 程序 运行 的 结果 存在 数据 依赖 关系 的 不允许 重 排序 需要 注意 的 是 重 排序 不会 影响 单线程 环境 的 执行 结果 但是 会 破坏 多线程 的 执行 语义 在 java 中 wait 和 sleep 方法 的 不同 最大 的 不 同是 在 等待 时 wait 会 释放 锁 而 sleep 一直 持有 锁 wait 通 常被 用于 线程 间 交互 sleep 通 常被 用于 暂停 执行 用 java 实现 阻塞 队列 一个 线程 运行时 发生 异 常会 怎样 如果 异常 没有 被 捕获 该 线程 将会 停止 执行 是 用于 处理 未 捕获 异常 造成 线程 突然 中断 情况 的 一个 内嵌 接口 当 一个 未 捕获 异 常将 造成 线程 中断 的 时候 jvm 会 使用 来 查询 线程 的 并将 线程 和 异常 作为 参数 传 递给 handler 的 方法 进行 处理 如 何在 两个 线程 间 共享 数据 在 两个 线程 间 共享 变量 即可 实现 共享 一般来说 共享 变量 要求 变量 本身 是 线程 安全 的 然后 在 线程 内 使用 的 时候 如果有 对 共享 变量 的 复合 操作 那么 也 得 保证 复合 操作 的 线程 安全性 java 中 notify 和 notifyall 有 什么区别 notify 方法 不能 唤醒 某个 具体 的 线程 所以 只有 一个 线程 在 等待 的 时候 它 才有 用武之地 而 notifyall 唤醒 所有 线程 并 允许 他们 争夺 锁 确保 了 至少有 一个 线程 能 继续 运行 为什么 waitnotify 和 notifyall 这些 方法 不在 thread 类 里面 一个 很明显 的 原因是 java 提供 的 锁 是 对象 级 的 而 不是 线程 级 的 每个 对象 都有 锁 通过 线程 获得 由于 waitnotify 和 notifyall 都是 锁 级别 的 操作 所以 把 他们 定义 在 object 类 中 因为 锁 属于 对象 什么 是 threadlocal 变量 threadlocal 是 java 里 一种 特殊 的 变量 每个 线程 都有 一个 threadlocal 就是 每个 线程 都 拥有 了 自己 独立 的 一个 变量 竞争 条件 被 彻底消除 了 它是 为 创建 代价 高昂 的 对象 获取 线程 安全 的 好 方法 比如 你 可以用 threadlocal 让 变成 线程 安全 的 因为 那个 类 创建 代价 高昂 且 每次 调用 都 需要 创建 不同 的 实例 所以 不值得 在 局部 范围 使 用它 如果 为 每个 线程 提供 一个 自己 独有 的 变量 拷贝 将 大大提高 效率 首先 通过 复用 减 少了 代价 高昂 的 对象 的 创建 个数 其次 你 在 没有 使用 高 代价 的 同步 或者 不变性 的 情况下 获得了 线程 安全 java 中 interrupted 和 isinterrupted 方法 的 区别 方法 用于 中断 线程 调用 该 方法 的 线程 的 状态 为 将被 置 为 中断 状态 注意 线程 中断 仅仅是 置 线程 的 中断 状态 位 不会 停止 线程 需要 用户 自己 去 监视 线程 的 状态 为 并 做 处理 支持 线程 中断 的 方法 也 就是 线程 中断 后会 抛出 的 方法 就是在 监视 线程 的 中断 状态 一旦 线程 的 中断 状态 被 置 为 中断 状态 就会 抛出 中断 异常 interrupted 查询 当前 线程 的 中断 状态 并且 清除 原 状态 如果 一个 线程 被 中 断了 第一次 调用 interrupted 则 返回 true 第二次 和 后面 的 就 返回 false 了 isinterrupted 仅仅是 查询 当前 线程 的 中断 状态 为什么 wait 和 notify 方法 要在 同步 块 中 调用 javaapi 强制 要求 这样 做 如果 你 不 这么 做你 的 代码 会 抛出 异常 还有 一个 原因 是为了 避免 wait 和 notify 之间 产生 竞 态 条件 为什么 你 应该在 循 环中 检查 等待 条件 处于 等待 状态 的 线程 可能会 收到 错误 警报 和 伪 唤醒 如果 不在 循 环中 检查 等待 条件 程序 就 会在 没有 满足 结束 条件 的 情况下 退出 java 中 的 同步 集合 与 并发 集合 有 什么区别 同步 集合 与 并发 集合 都为 多线程 和 并发 提供 了 合适 的 线程 安全 的 集合 不过 并发 集合 的 可 扩展性 更高 在 java 之前 程序员 们 只有 同步 集合 来用 且 在 多线程 并发 的 时候 会 导致 争 用 阻碍 了 系统 的 扩展性 java 介绍 了 并发 集合 像 不仅 提供 线程 安全 还用 锁 分离 和 内部 分区 等 现代 技术 提高了 可 扩展性 什么 是 线程 池 为什么 要使 用它 创建 线程 要花费 昂贵 的 资源 和 时间 如果 任务 来了 才 创建 线程 那么 响应 时间 会 变长 而且 一个 进程 能 创建 的 线程 数 有限 为了 避免 这些 问 题在 程序 启动 的 时候 就 创建 若干 线程 来 响应 处理 它们 被称为 线程 池里 面的 线程 叫 工作 线程 从 jdk 开始 javaapi 提供 了 executor 框架 让 你 可以 创建 不同 的 线程 池 怎么 检测 一个 线程 是否 拥有 锁在 javalangthread 中有 一个 方法 叫 holdslock 它 返回 true 如果 当 且 仅 当当 前 线程 拥有 某个 具体 对象 的 锁 你 如 何在 java 中 获取 线程 堆栈 killjavapid 不会在 当前 终端 输出 它会 输 出到 代码 执行 的 或 指定 的 地方 去 比如 killtomcatpid 输出 堆栈 到 log 目 录下 jstackjavapid 这个 比较简单 在 当前 终端 显示 也 可以 重定向 到 指定 文件 中 不做 说明 打开 jvisualvm 后 都是 界面 操作过程 还是 很简单 的 jvm 中 哪个 参数 是 用来 控制 线程 的 栈 堆栈 小 的 xss 每个 线程 的 栈 大小 thread 类 中 的 yield 方法 有 什么 作用 使 当前 线程 从 执行 状态 运行 状态 变为 可执行 态 就绪 状态 当前 线程 到了 就绪 状态 那么 接下来 哪个 线程 会 从 就绪 状态 变成 执行 状态 呢 可能是 当前 线程 也 可能是 其他 线程 看 系统 的 分 配了 java 中 的 并发 度 是什么 把 实际 map 划 分成 若干 部 分来 实现 它 的 可 扩展性 和 线程 安全 这种 划分 是 使用 并发 度 获得 的 它是 类 构造 函数 的 一个 可选 参数 默认值 为 这样 在 多线程 情况下 就能 避免 争 用在 jdk 后 它 摒弃 了 segment 锁 段 的 概念 而是 启 用了 一种 全新 的 方式 实现 利用 cas 算法 同时 加 入了 更多 的 辅助 变量 来 提高 并发 度 具体内容 还是 查看 源码 吧 java 中 semaphore 是什么 java 中 的 semaphore 是 一种 新 的 同步 类 它是 一个 计数 信号 从 概念上 讲 从 概念上 讲 信号量 维护 了 一个 许可 集合 如有 必 要在 许可 可用 前 会 阻塞 每一个 acquire 然后再 获取 该 许可 每个 release 添加 一个 许可 从而 可能 释放 一个 正在 阻塞 的 获取 者 但是 不 使用 实际 的 许可 对象 semaphore 只对 可用 许可 的 号码 进行 计数 并 采取 相应 的 行动 信号量 常常 用于 多线程 的 代码 中比 如 数据库 连接池 java 线程 池中 submit 和 execute 方法 有 什么区别 两个 方法 都可以 向 线程 池 提交 任务 execute 方法 的 返回 类型 是 void 它 定义 在 executor 接 口中 而 submit 方法 可以 返回 持有 计算结果 的 future 对象 它 定义 在 executorservice 接 口中 它 扩展 了 executor 接口 其它 线程 池 类像 和 都有 这些 方法 什么 是 阻塞 式 方法 阻塞 式 方法 是 指 程序 会 一直 等待 该 方法 完成 期间 不做 其他 事情 serversocket 的 accept 方法 就是 一直 等待 客户端 连接 这里 的 阻塞 是 指 调用 结果 返回 之前 当前 线程 会被 挂起 直到 得到 结果 之后 才会 返回 此外 还有 异步 和 非 阻塞 式 方法 在 任务 完成 前 就 返回 java 中 的 readwritelock 是什么 读写 锁 是 用来 提升 并发 程序 性能 的 锁 分离 技术 的 成果 volatile 变量 和 atomic 变量 有 什么 不同 volatile 变量 可以 确保 先行 关系 即 写 操作 会发 生在 后续 的 读 操作 之前 但它 并不能 保证 原子 性 例 如用 volatile 修饰 count 变量 那么 count 操作 就不是 原子 性 的 而 atomicinteger 类 提供 的 atomic 方法 可以 让 这种 操作 具有 原子 性 如 getandincrement 方 法会 原子 性 的 进行 增量 操作 把 当前 值 加 一 其它 数据类型 和 引用 变量 也 可以 进行 相似 操作 可以 直接 调用 thread 类 的 run 方法 么 当然 可以 但是 如果 我们 调 用了 thread 的 run 方法 它 的 行为 就会 和 普通 的 方法 一样 会在 当前 线程 中 执行 为了 在 新 的 线程 中 执行 我们 的 代码 必须 使用 threadstart 方法 如何 让 正在 运行 的 线程 暂停 一段时间 我们 可以 使用 thread 类 的 sleep 方法 让 线程 暂停 一段时间 需要 注意 的 是 这 并不会 让 线程 终止 一旦 从 休眠 中 唤醒 线程 线程 的 状态 将 会被 改 变为 runnable 并且 根据 线程 调度 它将 得到 执行 你 对 线程 优先级 的 理解 是什么 每一个 线程 都是 有 优先级 的 一般来说 高 优先级 的 线程 在运 行 时会 具有 优先权 但 这 依赖于 线程 调度 的 实现 这个 实 现是 和 操作系统 相关 的 osdependent 我们 可以 定义 线程 的 优先级 但是 这 并不能 保证 高 优先级 的 线程 会在 低 优先级 的 线 程前 执行 线程 优先级 是 一个 int 变量 从 代表 最低 优先级 代表 最高 优先级 java 的 线程 优先级 调度会 委托 给 操作系统 去 处理 所以 与 具体 的 操作系统 优先级 有关 如 非 特别 需要 一般 无需 设置 线程 优先级 什么 是 线程 调度 器 threadscheduler 和 时间 分片 timeslicing 线程 调度 器 是 一个 操作系统 服务 它 负责 为 runnable 状态 的 线程 分配 cpu 时间 一旦 我们 创建 一个 线程 并 启动 它 它 的 执行 便 依赖于 线程 调度 器 的 实现 同上 一个 问题 线程 调度 并不 受到 java 虚拟机 控制 所以 由 应用程序 来 控制 它是 更好 的 选择 也就是说 不 要让 你 的 程序 依赖于 线程 的 优先级 时间 分片 是 指 将 可用 的 cpu 时间 分配给 可用 的 runnable 线程 的 过程 分配 cpu 时间 可以 基于 线程 优先级 或者 线程 等待 的 时间 你 如何 确保 main 方法 所在 的 线程 是 java 程序 最后 结束 的 线程 我们 可以 使用 thread 类 的 join 方法来 确保 所有 程序 创建 的 线程 在 main 方法 退出 前 结束 线程 之间 是 如何 通信 的当 线程 间 是 可以 共享资源 时 线程 间 通信 是 协调 它们 的 重要 的 手段 object 类 中 wait notify notifyall 方法 可以 用于 线程 间 通信 关于 资源 的 锁 的 状态 为什么 线程 通信 的 方法 wait notify 和 notifyall 被 定义 在 object 类 里 java 的 每个 对象 中都 有 一个 锁 monitor 也 可以 成为 监视器 并且 wait notify 等 方法 用于 等待 对象 的 锁 或者 通知 其他 线程 对象 的 监视器 可用在 java 的 线程 中 并没有 可供 任何 对象 使用 的 锁 和 同步器 这 就是 为什么 这些 方法 是 object 类 的 一部分 这样 java 的 每一个 类 都有 用于 线程 间 通信 的 基本 方法 为什么 wait notify 和 notifyall 必 须在 同步 方法 或者 同步 块 中被 调用 当 一个 线程 需要 调用 对象 的 wait 方法 的 时候 这个 线程 必须 拥有 该 对象 的 锁 接着 它 就会 释放 这个 对象 锁 并 进入 等待 状态 直到 其他 线程 调用 这个 对象 上 的 notify 方法 同样 的当 一个 线程 需要 调用 对象 的 notify 方法 时 它会 释放 这个 对象 的 锁 以便 其他 在 等待 的 线程 就可以 得到 这个 对象 锁 由于 所有 的 这些 方法 都 需要 线程 持有 对象 的 锁 这样 就 只能 通过 同步 来 实现 所以 他们 只 能在 同步 方法 或者 同步 块 中被 调用 为什么 thread 类 的 sleep 和 yield 方法 是 静态 的 thread 类 的 sleep 和 yield 方法 将在 当前 正在 执行 的 线程 上 运行 所以在 其他 处于 等待 状态 的 线程 上 调用 这些 方法 是 没有意义 的 这 就是 为什么 这些 方法 是 静态 的 它们 可以 在 当前 正在 执行 的 线程 中 工作 并 避免 程序员 错误 的 认为 可以 在其 他 非 运行 线程 调用 这些 方法 如何 确保 线程 安全 在 java 中 可以 有 很多 方法来 保证 线程 安全 同步 使用 原 子类 实现 并发 锁 使用 volatile 关键字 使用 不变 类 和 线程 安全类 同步 方法 和 同步 块 哪个 是 更好 的 选择 同步 块 是 更好 的 选择 因为 它 不会 锁住 整个 对象 当然 你 也 可以 让 它 锁住 整个 对象 同步 方 法会 锁住 整个 对象 哪怕 这个 类 中有 多个 不相 关联 的 同步 块 这 通常会 导致 他们 停止 执行 并需 要 等待 获得 这个 对象 上 的 锁 同步 块 更要 符合 开放 调用 的 原则 只 在 需要 锁住 的 代码 块 锁住 相应 的 对象 这样 从 侧面 来说 也 可以 避免 死锁 如何 创建 守护 线程 使用 thread 类 的 setdaemon true 方法 可以 将 线程 设置 为 守护 线程 需要 注意 的 是 需 要在 调用 start 方法 前 调用 这个 方法 否 则会 抛出 异常 什么 是 javatimer 类 如何 创建 一个 有 特定 时间 间隔 的 任务 javautiltimer 是 一个 工具 类 可以 用于 安排 一个 线程 在 未来 的 某个 特定 时间 执行 timer 类 可以用 安排 一次性 任务 或者 周期 任务 是 一个 实现 了 runnable 接口 的 抽象类 我们 需 要去 继承 这个 类 来 创建 我们 自己 的 定时 任务 并 使用 timer 去 安排 它 的 执行 最 后年 常见 的 java 面试题 总 结了 一份 将近 页 的 pdf 文档 欢迎 关注 我 的 公众 号 程序员 追风 领取 这些 整理 的 资料 喜欢 文章 记得 关注 我 点个 赞 哟 感谢 支持 