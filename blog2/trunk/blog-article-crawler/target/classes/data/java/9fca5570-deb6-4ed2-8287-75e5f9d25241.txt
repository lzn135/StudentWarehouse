面试 必 问 的 spring 你 懂 了吗 微 信 搜索 程序员 囧 辉 关注 这个 坚持 分享 技术 干货 的 程序员 我 的 最新 文章 全网 最 硬核 redis 大厂 面试题 解析 年 最新版 前言 之前 在年 java 经验 阿里 网易 拼 多多 面试 总结 心得体会 中 列 出了 一些 高频 面试题 这些 题目 大部分 是 我 自己 在 面试 中 碰 到过 的 小部分 是 我 觉得 比较 重要 的 但是 当时 并没有 给出 答案 后面 收到 有 不少 同学 留 言说 希望 给出 答案 之前 一直 比较忙 所以 没时间 出 最近 换了 工作 后 没 之前 压力 那么大 了 所以 想把 这个 之前 留下 的 坑 给 填上 之 后会 针对 这些 题目 按 专题 来 给出 对应 的 解析 同时 结合 当前 的 面试 环境 适当 补充 点 当前 热门 题目 另外 针对 这些 面试题 的 重要 程度 出现 频率 我会 给出 一个 评分 分值 越高 代表 出现 的 概率 越大 其 中分 及 以上 的 可以 认为是 高频 面试题 评分 仅供参考 针对 spring 这个 知识点 面试 中 的 重要 程度 综合 评 分为 分 正文 springioc 的 容器 构建 流程 分 核心 的 构建 流程 如下 也 就是 refresh 方法 的 核心内容 springbean 的 生命周期 分 bean 的 生命周期 主要有 以下 几个 阶段 深色 底 的 个 是 比较 重要 的 阶段 beanfactory 和 factorybean 的 区别 分 容器 最 核心 也是 最 基础 的 接口 本质 是 个 工厂 类 用于 管理 bean 的 工厂 最 核心 的 功能 是 加载 bean 也 就是 getbean 方法 通常 我们 不会 直接 使用 该 接口 而是 使用 其 子 接口 factorybean 该 接口 以 bean 样式 定义 但是 它 不是 一种 普通 的 bean 它是 个 工厂 bean 实现 该 接口 的 类 可以 自己 定义 要 创建 的 bean 实例 只需要 实现 它 的 getobject 方法 即可 factorybean 被 广泛 应用于 java 相关 的 中间件 中 如果 你 看过 一些 中间件 的 源码 一 定会 看到 factorybean 的 身影 一般来说 都是 通过 来 返回 一个 代理 类 当 我们 触发 调用 时会 走到 代理 类 中 从而 可以 在 代理 类 中 实现 中间件 的 自定义 逻辑 比如 rpc 最 核心 的 几个 功能 选址 建立 连接 远程 调用 还有 一些 自定义 的 监控 限流 等等 beanfactory 和 的 区别 分 beanfactory 基础 ioc 容器 提供 完整 的 ioc 服务 支持 高级 ioc 容器 beanfactory 的 子 接口 在 beanfactory 的 基础上 进行 扩展 包含 beanfactory 的 所有 功能 还 提供 了 其他 高级 的 特性 比如 事件 发布 国际化 信息 支持 统一 资源 加载 策略 等 正常 情况下 我们 都是 使用 的 这边 以 电话 来 举个 简单 的 例子 我们 家里 使用 的 座机 就 类似于 beanfactory 可以 进行 电话 通讯 满足 了 最基本 的 需求 而 现在 非常 普及 的 智能手机 iphone 小米 等 就 类似于 除了 能 进行 电话 通讯 还有 其他 很多 功能 拍照 地图 导航 听歌 等 spring 的 aop 是 怎么 实现 的 分 本质 是 通过 动态 代理 来 实现 的 主要有 以下 几个 步骤 获取 增强 器 例 如被 aspect 注解 修饰 的 类 在 创建 每一个 bean 时会 检查 是否 有 增强 器 能 应用于 这个 bean 简单 理解 就是 该 bean 是否 在 该 增强 器 指定 的 execution 表达式 中 如果是 则将 增强 器 作为 拦截器 参数 使用 动态 代理 创建 bean 的 代理 对象 实例 当 我们 调用 被 增 强过 的 bean 时 就会 走到 代理 类 中 从而 可以 触发 增强 器 本质 跟 拦截器 类似 多个 aop 的 顺序 怎么 定 分 通过 ordered 和 priorityordered 接口 进行 排序 priorityordered 接口 的 优先级 比 ordered 更高 如果 同时 实现 priorityordered 或 ordered 接口 则 再按 order 值 排序 值 越小 的 优先级 越高 spring 的 aop 有 哪几种 创建 代理 的 方式 分 spring 中 的 aop 目前 支持 jdk 动态 代理 和 cglib 代理 通常 来说 如果 被 代理 对象 实现 了 接口 则 使用 jdk 动态 代理 否则 使用 cglib 代理 另外 也 可以 通过 指定 来 实现 强制 走 cglib 代理 jdk 动态 代理 和 cglib 代理 的 区别 分 jdk 动态 代理 本质上 是 实现 了 被 代理 对象 的 接口 而 cglib 本质上 是 继承 了 被 代理 对象 覆盖 其中 的 方法 jdk 动态 代理 只 能对 实现 了 接口 的 类 生成 代理 cglib 则没 有 这个 限制 但是 cglib 因为 使用 继承 实现 所以 cglib 无法 代理 被 final 修饰 的 方法 或 类 在 调用 代理 方法 上 jdk 是 通过 反射 机制 调用 cglib 是 通过 fastclass 机制 直接 调用 fastclass 简单 的 理解 就是 使用 index 作为 入 参 可以 直接 定位 到 要 调用 的 方法 直接进行 调 用在 性 能上 jdk 之前 由于 使 用了 fastclass 机制 cglib 在 执行 效率 上 比 jdk 快 但是 随着 jdk 动态 代理 的 不断 优化 从 jdk 开始 jdk 动态 代理 已经 明显 比 cglib 更 快了 jdk 动态 代理 为什么 只 能对 实现 了 接口 的 类 生成 代理 分 根本 原因是 通过 jdk 动态 代理 生成 的 类 已经 继承 了 proxy 类 所以 无法 再 使用 继承 的 方式 去 对 类 实现 代理 spring 的 事务 传播 行为 有 哪些 分 requiredspring 默认 的 事务 传播 级别 如果 上下 文中 已经 存在 事务 那么 就 加入到 事务 中 执行 如果 当前 上下 文中 不存在 事务 则 新建 事务 执行 requiresnew 每次 都会 新建 一个 事务 如果 上下文 中有 事务 则将 上下文 的 事务 挂起 当 新建 事务 执行 完成 以后 上下文 事务 再 恢复 执行 supports 如果 上下文 存在 事务 则 加入到 事务 执行 如果 没有 事务 则 使用 非 事务 的 方式 执行 mandatory 上下 文中 必 须要 存在 事务 否则 就会 抛出 异常 notsupported 如果 上下 文中 存在 事务 则 挂起 事务 执行 当前 逻辑 结束 后 恢复 上下文 的 事务 never 上下 文中 不能 存在 事务 否则 就会 抛出 异常 nested 嵌套 事务 如果 上下 文中 存在 事务 则 嵌套 事务 执行 如果 不存在 事务 则 新建 事务 spring 的 事务 隔离 级别 分 spring 的 事务 隔离 级别 底层 其实是 基于 数据库 的 spring 并没有 自己 的 一套 隔离 级别 default 使用 数据库 的 默认 隔离 级别 readuncommitted 读 未 提交 最低 的 隔离 级别 会 读 取到 其他 事务 还未 提交 的 内容 存在 脏 读 readcommitted 读 已 提交 读 取到 的 内容 都是 已经 提交 的 可以 解决 脏 读 但是 存在 不可重复读 repeatableread 可 重复 读在 一个 事务 中 多次 读取 时 看到 相同 的 内容 可以 解决 不可重复读 但是 存在 幻 读 serializable 串行化 最高 的 隔离 级别 对于 同一 行 记录 写 会 加写 锁 读 会加 读 锁在 这种 情况下 只有 读读 能 并发 执行 其他 并行 的 读 写写 读 写写 操作 都是 冲突 的 需要 串行 执行 可以 防止 脏 读 不可 重复 度 幻 读 没有 并发 事务 问题 spring 的 事务 隔离 级 别是 如何 做到 和 数据库 不一致 的 分 比如 数据库 是 可 重 复读 spring 是 读 已 提交 这是 怎么 实现 的 spring 的 事务 隔离 级别 本质上 还是 通过 数据库 来 控制 的 具体 是 在 执行 事务 前先 执行命令 修改 数据库 隔离 级别 命令 格式 如下 事务 的 实现 原理 分 spring 事务 的 底层 实现 主要 使用 的 技术 aop 动态 代理 动态 代理 基本 所有 要 进行 逻辑 增强 的 地方 都会 用到 动态 代理 aop 底层 也是 通过 动态 代理 实现 threadlocal 主要 用于 线程 间 的 资源 隔离 以此 实现 不同 线程 可以 使用 不同 的 数据源 隔离 级别 等等 trycatch 最 终是 执行 commit 还是 rollback 是 根据 业务 逻辑 处理 是否 抛出 异 常来 决定 spring 事务 的 核心 逻辑 伪 代码 如下 事务 资源 准备 try 业务 逻辑 处理 也 就是 调用 被 代理 的 方法 catch exceptione 出现异常 进行 回 滚 并将 异常 抛出 finally 现场 还原 还 原旧 的 事务 信息 正常 执行 进行 事务 的 提交 返回 业务 逻辑 处理结果 详细 流程 如 下图 所示 spring 怎么 解决 循环 依赖 的 问题 分 spring 是 通过 提前 暴露 bean 的 引 用来 解决 的 具体 如下 spring 首先 使用 构造 函数 创建 一个 不完整 的 bean 实例 之所以 说 不完整 是因为 此时 该 bean 实例 还未 初始化 并且 提前 曝光 该 bean 实例 的 objectfactory 提前 曝光 就是 将 objectfactory 放到 缓存 通过 objectfactory 我们 可以 拿到 该 bean 实例 的 引用 如果 出现 循环 引用 我们 可以 通过 缓存 中 的 objectfactory 来 拿到 bean 实例 从而 避免 出现 循环 引用 导致 的 死循环 举个 例子 a 依赖 了 bb 也 依赖 了 a 那么 依赖 注入 过程 如下 检查 a 是否 在 缓存 中 发现 不存在 进行 实例 化 通过 构造 函数 创建 beana 并 通过 objectfactory 提前 曝光 beanaa 走到 属性 填充 阶段 发现 依赖 了 b 所以 开始 实例 化 b 首先 检查 b 是否 在 缓存 中 发现 不存在 进行 实例 化 通过 构造 函数 创建 beanb 并 通过 objectfactory 曝光 创建 的 beanbb 走到 属性 填充 阶段 发现 依赖 了 a 所以 开始 实例 化 a 检查 a 是否 在 缓存 中发 现 存在 拿到 a 对应 的 objectfactory 来 获得 beana 并 返回 b 继续 接下来 的 流程 直至 创建 完毕 然后 返回 a 的 创建 流程 a 同样 继续 接下来 的 流程 直至 创建 完毕 这边 通过 缓存 中 的 objectfactory 拿到 的 bean 实例 虽然 拿到 的 是 不完整 的 bean 实例 但是 由 于是 单 例 所以 后续 初始化 完成后 该 bean 实例 的 引用 地址 并不会 变 所以 最终 我们 看到 的 还是 完整 bean 实例 spring 能 解决 构造 函数 循环 依赖 吗 分 答案 是 不行 的 对于 使用 构造 函数 注入 产生 的 循环 依赖 spring 会 直接 抛 异常 为什么 无法 解决 构造 函数 循环 依赖 上面 解决 逻辑 的 第一 句话 首先 使用 构造 函数 创建 一个 不完整 的 bean 实例 从这 句话 可以 看出 构造 函数 循环 依赖 是 无法 解决 的 因为 当 构造 函数 出现 循环 依赖 我们 连 不完整 的 bean 实例 都 构建 不出来 spring 三级 缓存 分 spring 的 三级 缓存 其实 就是 解决 循环 依赖 时 所 用到 的 三个 缓存 正常 情况下 的 bean 被 创建 完毕 后 会被 放到 该 缓存 实例 上面 说的 提前 曝光 的 objectfactory 就 会被 放到 该 缓存 中 gletonobjects 该 缓存 用于 存放 objectfactory 返回 的 bean 也就是说 对于 一个 只 会被 用 一次 之后 就 通过 来 获取 keybeanname 早期 bean 实例 resource 和 autowire 的 区别 分 resource 和 autowired 都可以 用来 装配 beanautowired 默认 按 类型 装配 默认 情况下 必须 要求 依赖 对象 必须 存在 如果 要 允许 null 值 可以 设置 它 的 required 属性 为 falseresource 如果 指定 了 name 或 type 则按 指定 的 进行 装配 如果 都不 指 定则 优 先按 名称 装配 当 找不到 与 名称 匹配 的 bean 时 才 按照 类型 进行 装配 autowire 怎么 使用 名称 来 注入 分 配合 qualifier 使用 如下 所示 userservice 修饰 的 方法 里 用 到了 其他 bean 实例 会有 问题 吗 分 该 题 可以 拆解 成 下面 个 问题 postconstruct 修饰 的 方法 被 调用 的 时间 bean 实例 依赖 的 其他 bean 被 注入 的 时间 也 可 理解为 属性 的 依赖 注入 时间 步骤 的 时间 是否 早于 步骤 如果是 则没 有 问题 如果 不是 则有 问题 解析 postconstruct 注解 被封 装在 中 具体 触发 时间 是 在 方法 从 docreatebean 维度 看 则是 在 initializebean 方法 里 属于 初始化 bean 阶段 属性 的 依赖 注入 是 在 populatebean 方法 里 属于 属性 填充 阶段 属性 填充 阶段 位于 初始化 之前 所以 本题 答案 为 没有问题 bean 的 initmethod 属性 指定 的 方法 里 用 到了 其他 bean 实例 会有 问题 吗 分 该 题 同 上面 这 题 类似 只是 将 postconstruct 换 成了 initmethod 属性 答案 是 不会有 问题 同 上面 一样 initmethod 属性 指定 的 方法 也是 在 initializebean 方法 里 被 触发 属于 初始化 bean 阶段 要在 springioc 容器 构建 完毕 之后 执行 一些 逻辑 怎么 实现 分 比较 常见 的 方法 是 使用 事件 监听器 实现 接口 监听 事件 还有 一种 比较 少见 的 方法 是 实现 smartlifecycle 接口 并且 isautostartup 方法 返回 true 则 会在 finishrefresh 方法 中被 触发 两种 方式 都是 在 finishrefresh 中被 触发 smartlifecycle 在 之前 spring 中 的 常见 扩展 点 有 哪些 分 方法 在 spring 容器 刷新 前 触发 也 就是 refresh 方法 前 被 触发 方法 在 加载 完 bean 定义 之后 创建 bean 实例 之前 被 触发 通常 使用 该 扩展 点来 加载 一些 自己 的 bean 定义 方法 执行 bean 的 初始化 方法 前 被 触发 方法 执行 bean 的 初始化 方法 后 被 触发 postconstruct 该 注解 被封 装在 中 具体 触发 时间 是 在 方法 方法 在 bean 的 属性 填充 之后 初始化 方法 initmethod 之前 被 触发 该 方法 的 作用 基本 等同于 initmethod 主要 用于 执行 初始化 相关 操作 事件 监听器 方法 根据 事件 类型 触发 时间 不同 通常 使用 的 触发 时间 为 上下文 刷新 完毕 通常 用于 ioc 容器 构建 结束 后处理 一些 自定义 逻辑 predestroy 该 注解 被封 装在 中 具体 触发 时间 是 在 方法 也 就是在 销毁 对象 之前 触发 方法 在 bean 的 销毁 阶段 被 触发 该 方法 的 作用 基本 等同于 destroymethod 主 用 用于 执行 销毁 相关 操作 spring 中 如何 让 两个 bean 按 顺序 加载 分 使用 让 后 加载 的 类 依赖 先 加载 的 类 使用 扩展 点 提前 加载 例如 加载 a 使用 mybatis 时 调用 dao 接口 时 是 怎么 调 用到 sql 的 分 详细 的 解析 见面 试题 mybatis 中 的 dao 接口 和 xml 文件 里 的 sql 是 如何 建立 关系 的 简 单点 说 当 我们 使用 springmybatis 时 dao 接口 会被 加 载到 spring 容器 中 通过 动态 代理 来 创建 xml 中 的 sql 会被 解析 并 保 存到 本地 缓存 中 key 是 sql 的 是 sql 的 封装 当 我们 调用 dao 接口 时会 走到 代理 类 中 通过 接口 的 全 路径名 从 步骤 的 缓存 中找到 对应 的 sql 然后 执行 并 返回 结果 最 后金 三 银 四 的 季节 相信 有 不少 同学 正准备 跳槽 我 将我 最近 的 原创 的 文章 进行了 汇总 原创 汇总 其中有 不少 面试 高频 题目 解析 很多 都是 我 自己 在 面试 大厂 时 遇到 的 我 在对 每个 题目 解析 时 都会 按 较高 的 标准 进行 深入探讨 可能 只 看一遍 并不能 完全 明白 但是 相信 反复 阅读 定能 有所 收获 原创 不易 如果 你 觉得 本文 写 的 还 不错 对 你 有 帮助 请 通过 点 赞 让 我 知道 支持 我 写出 更好 的 文章 推荐 阅读 java 基础 高频 面试题 年 最新版 天 咸鱼 到 阿里 的 修仙 之路 两年 java 开发 工作经验 面试 总结 年 java 经验 阿里 网易 拼 多多 面试 总结 心得体会 年 java 经验 字节 美 团 快手 核心 部门 面试 总结 真 题 解析 面试 阿里 hashmap 这一 篇 就 够了 面试 必 问 的 mysql 你 懂 了吗 面试 必 问 的 线程 池 你 懂 了吗 跳槽 如何 选择 一家 公司 如何 准备好 一场 大厂 面试 mysqlmvcc 核心 原理 解析 核心 源码 如何写 一份 让 hr 眼前一亮 的 简历 附 模板 复习 个月 拿下 美 团 offer 我 都 做了 些 啥 