javascript 实现 拖动 滑块 拼图 验证 html5 canvas 引言 滑块 拖动 验证 现在 很多 地方 都 用到 周末 就 琢磨 着 写了 一个 放上 来看 看有 没有人 用得 上 效果 实现 思路 用 一张 画布 绘制 源 图 再 绘制 一个 填充 的 方形 这样 就可以 达到 缺失 的 效果 方形 的 坐标 是 随机 的 再用 一个 画布 绘制 拖动 块 同时 用 drawimage 截取 和 上 一步 中 方形 区域 一样 坐标 大小 的 原图 就 作为 验证 图 了 把 验证 图 放在 最左 边在 拖动 块 处 按 下 鼠标 然后 拖动 拖动 块 和 验证 图 会 跟随 鼠标 移动 达到 一定 范围 后 放开 鼠 标会 进行 验证 验证 通过 则 提示 验证 成功 验证 不通过 则 拖动 块 和 验证 图 会 返 回到 最左 边个 构造 函数 图片 构造 函数 图片 对象 imagedraw 构造 函数 oobj thisidthisimage 图片 对象 必填 thissx 图片 切片 开始 x 位置 显示 整个 图片 的 时候 不需要 填 thissy 图片 切片 开始 y 位置 显示 整个 图片 的 时候 不需要 填 thisswidth 图片 切片 开始 宽度 显示 整个 图片 的 时候 不需要 填 thissheight 图片 切片 开始 高度 显示 整个 图片 的 时候 不需要 填 thisdx 图片 目标 x 位置 必填 thisdy 图片 目标 y 位置 必填 thisdwidth 图片 目标 显示 宽度 宽度 不 缩放 时 不 必填 thisdheight 图片 目标 高度 高度 高度 不 缩放 时 不 必填 thisinit oobj oobj for varkeyino context draw contextthis functiondraw contextobj if objimagegettype objdx objdy undefined thrownewerror 绘制 图片 缺失 参数 objdxobjdy if gettype objsx objsy 裁剪 图片 显示 时候 有 缩放 ctxdrawimage elseif ctxdrawimage 原始 图片 显示 时候 有 缩放 objimage 原始 图片 显示 时候 无 缩放 ctxrestore pos 鼠标 位置 的 xy 要 分别 大于 dxdy 且 xy 要 分别 小于 表示 处于 当前 图片 对象 范围内 方形 构造 函数 functionrect o thisxx 坐标 thisyy 坐标 thiswidth 宽 thisheight 高 thisthintrue 线段 薄 一点 thisinit o o for varkeyino context this obj ctxbeginpath ctxtranslate objxobjy if objlinewidth objthin ctxtranslate ctxrect if objfill 是否 填充 objfillstyle nullctxfill if objstroke 是否 描 边 objstrokestyle nullctxstroke ctxrestore returnthis 文本 构造 函数 functiontext o thisxx 坐标 thisyy 坐标 thistext 内容 thisfontnull 字体 对齐 方式 thisinit o o for varkeyino context this obj ctxbeginpath ctxtranslate objxobjy if objfont objtextalign objfill 是否 填充 objfillstyle nullctxfilltext objtext ctxrestore returnthis 绘制 源 图 和 缺失 块 img varxgetrandom x 从 之间 取 varygetrandom y 从 之间 取 缺失 块 绘制 varrectnewrect rect 绘制 验证 块 长条 varrectnewrect rect 绘制 文字 vartextnewtext xytext 拖动 滑块 验证 text 此时 页面 效果 如下 绘制 验证 图 和 拖动 块 注意 验证 图 的 绘制 坐标 与 上 一步 绘制 缺失 块 的 坐标 是 一样 的 上 一步 绘制 缺失 块 的 坐标 验证 图 需 根据 这个 坐标 来 截取 img img 效果图 画布 添加 事件 给 canvas 画布 添加 点击 事件 this this this 鼠标 按 下 事件 记录 鼠标 按 下 时 的 x 坐标 保持 鼠标 移动 不 飘 改变 移动 标 记为 true 防止 没有 拖动 滑块 而 产生 移动 的 效果 e varposgetoffset e 获取 鼠标 位置 if thisblock returnif pos 按 下 的 位置 是 滑块 的 位置 thismovetrue 表示 可以 移动 thisdownxposx 记录 鼠标 按 下 的 位置 保持 移动 鼠标 移动 事件 验证 图 和 滑块 移动 时 需 减去 鼠标 点击 的 初始 x 坐标 当 超过 一定 范围 则 不能 再 移动 防止 移出 画布 范围 e if thismove return 移动 标 记为 false 则 直接 返回 varposgetoffset e posxthisdownx 要 减去 鼠标 初始 点击 的 位置 if posxgt pos 移动 更新 pos 更改 滑块 和 验证 图 的 坐标 each item if item itemdxposx 绘制 thisrender 鼠标 放开 事件 鼠标 移动 move 标 记为 false 未 达到 验证 范围 而 放开 鼠标 滑块 和 验证 图 会 回到 最 左边 当 验证 图 的 移动 达到 一定 范围 则 表示 验证 通过 验证 通 过后 提示 验证 通过 相关内容 要 做出 改变 比如 缺失 块 的 清除 提示 文字 内容 的 改变 等 e e 验证 快 的 坐标 if mathabs posxvalidposx lt 验证 通过 x 位置 的 差值 多少 范围内 即可 consolelog 通过 thissuc else 验证 不通过 thisupdate x thisrender 清楚 缺失 块 thisblocknull 滑块 和 验证 图 的 清除 长条 颜色 的 改变 提示 内容 的 改变 验证 成功 成功 后 如下 给 个 三连 兄弟们 源码 下载方式 完整 代码 下载方式 关注 下方 公众 号 回复 下载 代码 更多 源码 基于 canvas 的 手风琴 特效 附 源码 抖 音 很 火 的 华为 太空人 表盘 附 源码 基于 javascript 页面 动态 验证码 附 源码 基于 javascript 的 拖动 滑块 拼图 验证 附 源码 基于 javascript 的 幸运 大转盘 附 源码 抖 音 很 火 的 罗盘 时钟 附 源码 基于 javascript 的 俄罗斯方块 小游戏 附 源码 基于 javascript 的 贪吃蛇 游戏 附 源码 基于 javascript 的 拼图游戏 附 源码 用 javascript 给 女儿 做的 烟花 特效 附 源码 老父亲 给 女儿 做的 下雪 特效 满足 女儿 看 雪 的 愿望 附 源码 雷达 扫描 特效 附 源码 香港黄金 配角 吴孟达 去世 后 程序员 以 轮播 图 来 悼念 达 叔 达 叔 一路 走好 附 源码 仿 抖 音 刷新 进度条 附 源码 仿 头条 方形 刷新 进度条 附 源码 仿 加速 球 水波 评分 特效 附 源码 基于 canvas 的 刮刮卡 附 源码 原生 js 写 的 左侧 飞入 拼图 特效 你 是 喜欢 美女 单飞 还是 双飞 附 源码 用 js 写 的 旋转 木马 在 新年 献给 各位 刚 登基 的 皇帝 让 你 的 后宫 转起来 程序员 就是 可以 为所欲为 附 源码 用 js 写 的 轮播 图 八位 女明星 你 翻 谁 的 牌 程序员 就是 可以 为所欲为 附 源码 原生 js 实现 美女 拼图 把 美女 老婆 抱 回家 个 美女 够不够 程序员 就是 可以 为所欲为 附 源码 用 js 仿 探探 拖拽 卡片 的 效果 飞 卡片 的 效果 感觉 挺 酷 最后 有 美女 看 哦 附 源码 老婆 说 程序员 不懂 浪漫 程序员 默默 拿 起了 键盘 这就 亲手 带你 去看 流星雨 女人 真会 影响 拔刀 的 速度 附 源码 学生 成绩 管理 系统 有 源码 你 的 毕 设 我 的 心 附 源码 