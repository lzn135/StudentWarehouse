基于 canvas 的 手风琴 特效 引言 手风琴 特效 是 比较 常见 的 我 之前 没有 见过 用 canvas 写 的 就 自己 上手 写了 一个 拿出来 分享 一下 这 其中 处理 图片 的 切换 花了 我 不少 时间 效果 如下 实现 思路 排放 好 图片 最前 面的 那张 图片 显示 全部 其他 图片 放到 两侧 只显示 像素 的 边 剩余 部分 依次 摆放 放到 画布 外 绘制 几个 相 对应 的 方形 每个 方形 大小 跟 对应 的 图片 显示 在 画布 中 的 大小 一样 这些 方形 用来 控制 鼠标 的 移入 事件 鼠标 移入 以后 切换 图片 执行 手风琴 特效 绘制 图片 分 二次 处理 是为了 让 展示 的 图片 处于 数组 的 后面 不 会被 遮盖 绘制 选项 图片 分 二次 处理 是为了 让 展示 的 图片 处于 数组 的 后面 不 会被 遮盖 for varicurrigti if icurr dxnwelsedx i img img 这里 用 unshift 保证 顺序 for dx i img thisimgarrpush img 此时 效果 加入 方形 依次 摆 放好 就行 显示 的 那张 图片 宽度 取到 图片 的 宽度 一样 为 创建 几个 方形 和 图片 一一对应 用来 处理 鼠标 移入 的 动作 for x i wif igtcurr xswidthwif icurr rectnewrect if icurr rectcurrtrue 当前 展示 图片 rectindexi 方形 索引 对应 图片 下标 rect thisrectarrpush rect 效果 如下 此时 绘制 的 几个 方形 显示 在 图片 上面 了 需要 修改 绘制 顺序 让 方形 先 生成 即可 绘制 选项 图片 创建 几个 方形 和 图片 一一对应 用来 处理 鼠标 移入 的 动作 for x i wif igtcurr xswidthwif icurr rectnewrect if icurr rectcurrtrue 当前 展示 图片 rectindexi 方形 索引 对应 图片 下标 rect thisrectarrpush rect 分 二次 处理 是为了 让 展示 的 图片 处于 数组 的 后面 不 会被 遮盖 for varicurrigti if icurr dxnwelsedx i img img 这里 用 unshift 保证 顺序 for dx i img thisimgarrpush img 加入 鼠标 移入 事件 鼠标 移入 后 鼠标 的 坐标 处于 哪个 方形 范围内 那 对应 的 图片 就要 显示出来 根据 当前 选择 的 方形 与 之前 显示 的 图片 位置 比较 可以 确定 图片 的 运动 方形 向 左边 or 向右 以及 需要 运动 图片 对象 开启 定时 任务 来 执行 这些 图片 的 运动 运动 的 时候 要 重新 排序 处理 好 图片 与 图片 的 遮蔽 关系 不然 会出 现被 其他 图片 遮罩 的 效果 我 在这里 也 费了 不少 时间 去 处理 在 已经 显示 的 图片 上 移动 鼠标 和 图片 正 在做 运动 的 时候 是 不会 再次 触发 定时 任务 的 运动 完成后 清除 定时 任务 重新 设定 相关 参数 即可 鼠标 移入 事件 鼠标 移动 事件 e thatcatchflag return 如果 处理 捕获 状态 直接 返回 varposgetoffset e 获取 鼠标 位置 for itemispoint pos if 当前 显示 的 图片 上 移动 无效 处理 需要 执行 图片 手风琴 效果 returnthatmove catchindex 图片 移动 的 逻辑 处理 函数 图片 移动 的 逻辑 处理 函数 index item if indexltcurr 判断 好 往左 还是 往右 设定 dirif 往右 移动 movearrpush item elseif 往左 移动 movearrpush item dir 执行 排序 thissort indexdir 开启 定时 任务 domovebind this 执行 移动 的 函数 functiondomove totalgt 移动 到位 后 clearinterval timmer 清除 定时器 更改 捕获 状态 设定 当前 显示 图 的 下标 each movearrfunction item 设置 flag 为 returneach movearrfunction item if dirgt 对 方形 控制 的 处理 if itemindexindex itemindexcurr if itemflag 表示 图 要 先向 右移 动 因为 处于 最 左边 对 图片 移动 处理 对 方形 控制 的 处理 if itemindexcurr itemindexindex if itemflag 表示 图 要 先向 做 移动 因为 处于 最 右边 超 过了 画布 的 范围 对 图片 移动 处理 total 不管 往左 往右 total 都是 递增 thatrender 排序 函数 排好 序 否则 图片 会 相互 遮盖 indexdir dirlt 向左 移动 左边 的 图 放到 数组 前面 for variindexigti arrnthisimgarri 当前 显示 的 图片 放在 中间 右边 的 图 放到 数组 后面 for 向右 移动 右边 的 图 放到 数组 前面 for arrnthisimgarri 当前 显示 的 图片 放在 中间 左边 的 图 放到 数组 后面 for variindexigti arrnthisimgarri 最终 效果 就 跟 文章 开头 的 一样 源码 下载方式 少量 积分 下载 代码 方式 关注 下方 公众 号 回复 下载 代码 更多 源码 抖 音 很 火 的 华为 太空人 表盘 附 源码 基于 javascript 页面 动态 验证码 附 源码 基于 javascript 的 拖动 滑块 拼图 验证 附 源码 基于 javascript 的 幸运 大转盘 附 源码 抖 音 很 火 的 罗盘 时钟 附 源码 基于 javascript 的 俄罗斯方块 小游戏 附 源码 基于 javascript 的 贪吃蛇 游戏 附 源码 基于 javascript 的 拼图游戏 附 源码 用 javascript 给 女儿 做的 烟花 特效 附 源码 老父亲 给 女儿 做的 下雪 特效 满足 女儿 看 雪 的 愿望 附 源码 雷达 扫描 特效 附 源码 香港黄金 配角 吴孟达 去世 后 程序员 以 轮播 图 来 悼念 达 叔 达 叔 一路 走好 附 源码 仿 抖 音 刷新 进度条 附 源码 仿 头条 方形 刷新 进度条 附 源码 仿 加速 球 水波 评分 特效 附 源码 基于 canvas 的 刮刮卡 附 源码 原生 js 写 的 左侧 飞入 拼图 特效 你 是 喜欢 美女 单飞 还是 双飞 附 源码 用 js 写 的 旋转 木马 在 新年 献给 各位 刚 登基 的 皇帝 让 你 的 后宫 转起来 程序员 就是 可以 为所欲为 附 源码 用 js 写 的 轮播 图 八位 女明星 你 翻 谁 的 牌 程序员 就是 可以 为所欲为 附 源码 原生 js 实现 美女 拼图 把 美女 老婆 抱 回家 个 美女 够不够 程序员 就是 可以 为所欲为 附 源码 用 js 仿 探探 拖拽 卡片 的 效果 飞 卡片 的 效果 感觉 挺 酷 最后 有 美女 看 哦 附 源码 老婆 说 程序员 不懂 浪漫 程序员 默默 拿 起了 键盘 这就 亲手 带你 去看 流星雨 女人 真的 会 影响 男人 拔刀 的 速度 附 源码 学生 成绩 管理 系统 有 源码 你 的 毕 设 我 的 心 附 源码 