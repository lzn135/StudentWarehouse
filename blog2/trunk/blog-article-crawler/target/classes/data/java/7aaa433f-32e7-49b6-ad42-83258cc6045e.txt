java 日常 开发 中 常用 的 日志 记录 方式 攒 个 赞 好不好 引言 日志 大家 都再 熟悉 不 过了 日常 开发 中 经常 要 用到 甲方 接口 人 最喜欢 对我说 的话 就是 赶紧 去 查 一下 日志 快点 说话 的 同时 瞪着 个 铜铃 大 的 眼睛 就 你 接口 人 知道 日志 吗 还要 你 指挥 啊 我 心里 可 真 来劲 但是 没办法 谁叫 我 是 乙方 的 我 想 大口 喘气 也 得 拿手 捂着 兄弟们 都 指着 我 好好 说话 呢 我 这话 一 出口 我 这一 众 兄弟 这 个月 的 绩效 恐怕 就打 水 漂了 就在 我 进行 心里 斗争 的 时候 接口 人 又 说了 什么时候 能 定位 到 问题 啥时候 能 解决 甲方 规定 超 小时 通报 超过 小时 扣分 超 小时 约谈 领导 小时 没 搞定 打包 回家 下面 恭迎 今天 的 主角 日志 大神 出场 什么 是 日志 日志 记录 程序 的 运行 轨迹 打印 一下 设定 的 信息 比如 错误 很 方便 查找 关键 信息 快速 定位 解决问题 java 程序员 在 开发 项目 时 都是 依赖 debug 来 调试 错误 跟踪 代码 来 解决 bug 比如 我们 开发工具 就有 很强 大 错误 调试 功能 比如 我 自己 就有 个 版本 的 我 怀疑 你 在做 广告 当然在 开发 环境 下 要 调试 这些 错误 很 容易 打好 断点 跟踪 代码 就行了 但 项目 发布 到了 测试 生产 环境 怎么办 不好意思 你 调试 不 了 甲方 会 断了 一切 你 可以 这么 做的 念 想 所以 日志 就 派上用场 了 日志 打印 的 好 就能 根据 日志 的 轨迹 快速 定位 并 解决 线上 问题 反之 你 光 凭 分析 代码 分析 数据 脑细胞 胡乱 打架 是 没法 快速 解决问题 的 日志 记录 的 信息 能够 很好 的 帮助 开发 人家 快速 定位 到 问题 并且 解决 记录 日志 的 方式 有 很多 记录 日志 的 方式 比如 等等 这里 呢 我 就 说说 我们 做 项目 经常 用到 的 几种 logj 配置 文章 可以 看我 的 文章 logj 配置 详解 我 用 的 是 logjjar 这个 包 将其 放在 lib 下 输 出到 控制台 logjproperties 配置 debug 日志 优先级 stdout 自定义 名字 代表 日志 输 出到 那个地方 设置 日志 输出 类型 appender 负责 控制 日志 记录 操作 的 输出 consoleappender 日志 信息 输 出到 控制台 日志 自定义 格式 日志 输出 格式 为 优先级 产生 日志 事件 的 线程 名 日志 信息 换行 测试 代码 thisgetclass publicvoidtest loggerdebug debugprint loggerinfo infoprint loggerwarn warnprint loggererror errorprint stringargs newlogjtest test 因 配置 的 是 error 所以 只 输出 error 的 信息 输 出到 日志 文件 logjproperties 配置 debug 日志 优先级 stdout 自定义 名字 代表 日志 输 出到 那个地方 设置 日志 输出 类型 appender 负责 控制 日志 记录 操作 的 输出 consoleappender 日志 信息 输 出到 控制台 日志 自定义 格式 日志 输出 格式 为 优先级 产生 日志 事件 的 线程 名 日志 信息 换行 输 出到 日志 文件 只 输出 debug 级别 以上 的 日志 每天 产生 一个 新 的 文件 测试 代码 还是 之前 的 运行 结果 如下 自定义 文本 方式 每天 记录 一个 日志 文件 这个 日志 文件 把 今天 比较 重要 的 日志 记录下来 每个 日志 文件 记录 的 形式 时间 组 装好 的 内容 如下 是不是 有 个 疑问 如果有 多个 服务器 日志 是 记 录到 代码 执行 的 这个 服务器 上了 外面 访问 进来 肯定会 访 问到 不同 的 服务器 上了 日志 文件 也 肯定 存在 多个 咯 查 问题 的 时候 不 就得 一个个 服务器 的 日志 都 翻 一遍 烦 人吗 不是 这个 时候 你 请 搞 工程 的 兄弟 吃个 夜宵 他 就会 告诉 你 其实 服务器 是 可以 搞成 共享 一个 目录 的 多个 服务器 访问 同一个 日志 文件 也是 可以 的 具体 我 就不 讲了 但 说实话 这种 方式 我们 现在 也 只是 偶尔 用一下 示意 代码 filetrue outwrite conent outnewline 换行 catch exceptione catch ioexceptione stringargs yyyymmdd yyyymmddhhmmss datedatenewdate 当前 时间 方便 日志 查看 date yyyymmdd 格式 的 为了 每日 更换 日志 文件 date 组装 日志 内容 stringtext 日志 内容 指定 日志 文件 路径 start 打印 日志 writelog filenamelogstr end 记 录到 数据库 我们 用 的 最多 的 场景 是 接口 把 收发 报文 记录下来 如果 接口 发生 错误 的话 将 错误 的 信息 记 录成 一条 数据 一旦 发生 接口 调用 争议 的 实话 这个 就 派上用场 了 场景 对 端 是 个 大厂 很大 的 那种 甲方 都 不吊 的 那种 你 送了 数据 过去 然后 对 端 说 没 收到 或者说 收到 的 有 问题 但 人家 又 不说 具体 什么问题 也 不给 报文 就做 甩手掌柜 接口 人 只好 找你 了 你 懂 的 柿子 都 找 软 的 捏 你 如果 没有 调用 报文 和 返回 报文 的 记录 的话 你 就 等着 哭吧 挨骂 你 只能 忍着 就算 你 确定 你 的 程序 没问题 也没有 用你 得有 证据 你 就得 想方设法 的 找 报文 但 如果 要从 日志 找 的话 不是 那么 好找 甚至 有时候 找不到 记 录到 库 就很 好找 根据 工 单号 主键 或者 发生时间 等等 可以 很 容易 发现问题 定位 问题 然后 迅速 把 发送 的 报文 返回 的 报文 发给 接口 人手 一甩 就 剩下 你 心情 愉悦 的 摸鱼 了 我 一般 会 记录 这些 信息 来源 系统 对 端 系统 自己 的 系统 代号 业务 不同 的 模块 写 不同 的 编码 方便 区 分工 单号 唯一 标示 即 可看 自己 系统 的 需求方 法名 调用 的 方法 类型 接收 或者 发送 状态 成功 或者 失败 报文 具体 的 报文 信息 操作 时间 创建 时间 当然有 可能会 涉及到 比 较长 的 报文 所以 我们 设计 的 是 有 好几个 字段 来 存 不够 的 就 往后 一个 字段 放 比如 intiiltcounti intendlength i if iendlength if i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri elseif i vosetxmlinfo xmlarri 最后 通常情况下 在 程序 日志 里 记录 一些 比较 有意义 的 数据 程序 启动 登录 退出 重要 变量 的 状态 变化 重要 数据 的 执行 记录 接口 调用 报文 的 记录 定时 执行 相关 任务 的 状况 等等 关注 下方 公众 号 有 更多 资料 实例 代码 面试 技巧 奉上 