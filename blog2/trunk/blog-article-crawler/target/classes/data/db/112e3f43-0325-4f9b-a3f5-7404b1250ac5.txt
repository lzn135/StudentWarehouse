在 目标 检测 中 如何 解决 小 目标 的 问题 作者 nabilmadali 来源 ai 公园 编译 ronghuaiyang 在 深度 学习 目标 检测 中 特别是 人脸 检测 中 由于 分辨率 低 图像 模糊 信息 少 噪声 多 小 目标 和 小 人脸 的 检测 一直是 一个 实用 和 常见 的 难点 问题 然而 在 过去 几年 的 发展中 也 出现 了 一些 提 高小 目标 检测 性能 的 解决方案 本文 将对 这些 方法 进行 分析 整理 和 总结 图像 金字塔 和 多 尺度 滑动 窗口 检测 一开始 在 深 学习方法 成为 流行 之前 对于 不同 尺度 的 目标 通常是 从 原始 图像 开始使用 不同 的 分辨率 构建 图像 金字塔 然后 使用 分类 器 对 金字塔 的 每 一层 进行 滑动 窗口 的 目标 检测 在 著名 的 人脸 检测器 mtcnn 中 使用 图像 金字塔 法 检测 不同 分辨率 的 人脸 目标 然而 这种 方法 通常是 缓慢 的 虽然 构建 图像 金字塔 可以 使用 卷积 核 分离 加速 或 简单 粗暴 地 缩放 但 仍需 要做 多个 特征提取 后来 有人 借 其 想法 想出 一个 特征 金字塔 网络 fpn 在 不同 层 融合 特征 只需要 一次 正向 计算 不需要 缩放 图片 它也 被 应用于 小 目标 检测 这将 在后 面的 文章 中 讨论 简单 粗暴 和 可靠 的 数据 增强 通过 增加 训练 集 中小 目标 样本 的 种类 和 数量 也 可以 提 高小 目标 检测 的 性能 有 两种 简单 而 粗糙 的 方法 针对 coco 数据 集中 含有 小 目标 的 图片 数量 较少 的 问题 使 用过 采样 策略 不同 采样 比 的 实验 我们 观察到 不管 检测 小 目标 的 比率 是多少 过 采样 都有 帮助 这个 比例 使 我们 能够 在 大小 物体 之间 做出 权衡 针对 同一 张 图片 中小 目标 数量 少 的 问题 使用 分割 mask 切出 小 目标 图像 然后 使用 复制 和 粘贴 方法 当然 再加 一些 旋转 和 缩放 通过 复制粘贴 小 目标 来 实现 人工 增强 的 例子 正如 我们 在 这些 例子 中所 观察到 的 粘 贴在 同一 幅 图像 上 可以获得 正确 的 小 目标 的 周围环境 在 anchor 策略 方法 中 如果 同一 幅 图中 有 更多 的 小 目标 则会 匹配 更多 的 正 样本 与 groundtruth 物体 相匹配 的 不同 尺度 anchor 示意图 小 的 目标 匹 配到 更少 的 anchor 为了 克服 这一 问题 我们 提出 通过 复制粘贴 小 目标 来 人工 增强 图像 使 训练 过程 中有 更多 的 anchor 与 小 目标 匹配 特征 融合 fpn 不同 阶段 的 特征 图 对应 不同 的 感受 野 其所 表达 的 信息 抽象 程度 也 不同 浅层 特征 图 感受 野 小 更适合 检测 小 目标 深层 特征 图 较大 更适合 检测 大 目标 因此 有人 提出 将 不同 阶段 的 特征 映射 整合 在一起 来 提高 目标 检测 性能 称之为 特征 金字塔 网络 fpn a 利用 图像 金字塔 建立 特征 金字塔 特征 的 计 算是 在 每个 图像 的 尺 度上 独立 进行 的 这是 很 缓慢 的 b 最近 的 检测 系统 选择 只 使用 单一 尺度 的 特征 以 更 快地 检测 另一种 选择 是 重用 由 convnet 计算出 的 金字塔 特征 层次 结构 就好像 它是 一个 特征 图 金字塔 d 我们 提出 的 特征 金字塔 网络 fpn 与 b 和 一样 快 但 更 准确 在 这个 图中 特征 图 用 蓝色 轮廓线 表示 较 粗 的 轮廓线 表示 语义上 较强 的 特征 由于 可以 通过 融合 不同 分辨率 的 特征 图 来 提高 特征 的 丰富 度 和 信息 含量 来 检测 不同 大小 的 目标 自然会 有人 进一步 猜测 如果 只 检测 高分辨率 的 特征 图 浅层 特征 来 检测 小 人脸 使用 中 分辨率 特征 图 中间 特征 来 检测 大 的 脸 ssh 的 网络结构 合适 的 训练方法 snipsnipersan 在 机器 学习 中有 一点 很 重要 模型 预 训练 的 分布 应该 尽可能 接近 测试 输入 的 分布 因此在 大 分辨率 如常 见 的 x 下 训练 的 模型 不适合 检测 小 分辨率 的 图像 然后 放大 并 输入 到 模型 中 如果 输入 的 是 小 分辨率 的 图像 则在 小 分辨率 的 图像 上 训练 模型 如果 没有 则 应该 先用 大 分辨率 的 图片 训练 模型 然后 再用 小 分辨率 的 图片 进行 微调 最坏 的 情况 是 直接 使用 大 分辨率 的 图像 来 预测 小 分辨率 的 图像 通 过上 采样 放大 因此在 实际 应用 中 对 输入 图像 进行 放大 并 进行 高 速率 的 图像 预 训练 然后 对 小 图像 进行 微调 比 针对 小 目标 训练 分类 器 效果 更好 所有 的 图 都 报 告了 imagenet 分类 数据 集 验证 集 的 准确性 我们 对等 分辨率 的 图像 进行 上 采样 在 图 a 中 绘制 出 预 训练 的 resnet 分类 器 的 top 精度 图 bc 分别为 原始 图像 分辨率 为 像素 时 不同 cnn 的 结果 更 密集 的 anchor 采样 和 匹配 策略 sfdfaceboxes 如前 面的 数据 增强 部分 所述 将 一个 小 目标 复制到 图 片中 的 多个 位置 可以 增加 小 目标 匹配 的 anchor 数量 增加 小 目标 的 训练 权重 减少 网络 对 大 目标 的 偏置 同样在 逆向 思维 中 如果 数据 集 已经 确定 我们 也 可以 增加 负责 小 目标 的 anchor 的 设置 策略 使 训练 过程中 对 小 目标 的 学习 更加 充分 例 如在 faceboxes 中 其中 一个 贡献 是 anchor 策略 anchor 变 的 密集 例子 为了 清晰 起见 我们 只对 一个 感受 野 中心 即 中央 黑色 网格 密集 化 锚 点 并 只 给 对角 锚 点 上色 anchor 密集 化 策略 使 不同 类型 的 anchor 在 图像 上 具有 相同 的 密度 显著 提高 小 人脸 的 召回 率 总结 本文 较 详细 地 总 结了 一般 目标 检测 和 特殊 人脸 检测 中常 见 的 小 目标 检测 解决方案 英文 原文 未来 智能 实验室 的 主要 工作 包括 建立 ai 智能 系统 智商 评测 体系 开展 世界 人工智能 智商 评测 开展 互联网 城市 云 脑 研究 计划 构建 互联网 城市 云 脑 技术 和 企业 图谱 为 提升 企业 行业 与 城市 的 智能 水平 服务 如果 您对 实验室 的 研究 感兴趣 欢迎 加入 未来 智能 实验室 线上 平台 扫描 以下 二维码 或 点击 本文 左下角 阅读 原文 