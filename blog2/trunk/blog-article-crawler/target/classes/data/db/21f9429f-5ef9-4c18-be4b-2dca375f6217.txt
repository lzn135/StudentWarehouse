计算机网络 文章 目录 七层 网络 结构图 七层 与 五层 协议 对比 四层 协议 对应 位置 tcp 三次 握手 tcp 三次 握手 漫画 图解 为什么 要 三次 握手 为什么 不 能用 两次 握手 进行 连接 为什么 要 传回 syn 传 了 syn 为啥 还要 传 acktcp 第三次 握手 失败 怎么办 三次 握手 有 哪些 缺陷 tcp 四次 挥手 为什么 要 四次 挥手 tcp 与 udp 协议 的 区别 常 问 tcp 协议 如何 保证 可靠 传输 如何 实现 udp 的 可靠 传输 tcp 协议 存在 那些 缺 陷在 浏览器 中 输入 url 地址 发 生了 什么 太 常 问了 列举 常见 的 http 请求 头 和 响应 头 及其 作用 状态 码 各种 协议 与 http 协议 之间 的 关系 http 与 https 的 区别 什么 是 httphttp 报文 http 与 http 什么 是 httpshttps 流程 http 与 https 的 区别 https 是 如何 使用 tls 加密 的 对称 加密 非对称 加密 rsa https 是 如何 加密 的 证书 体系 ssl 协议 通信 过程 tlstls 工作 流程 多 进程 多线程 浏览器 post 与 get 的 区别 参考 文章 博 主 刚 考 完 计算机网络 基础知识 就不 废话 了 来 一个 七层 体系 结构图 学习 中 大家 一般 用 的 都是 五层 体系 七层 网络 结构图 图片 来源 七层 与 五层 协议 对比 四层 协议 对应 位置 tcp 三次 握手 tcp 三次 握手 漫画 图解 如 下图 所示 下面 的 两个 机器人 通过 次 握手 确定 了 对 方能 正确 接收 和 发送 消息 图片 来源 图解 http seq 序号 占个 字节 范围 由于 tcp 是 面向 字 节流 的 在 一个个 tcp 连接 中 传送 字 节流 中国 的 每一个 字节 都 按照 顺序 编号 此外 序号 是 循环 使用 的 ack 仅 当 ack 时 确认 字段 才 有效 当 ack 时 确认 字段 无效 并且 tcp 规 定在 连接 建立 后 所有 的 传送 报 文段 都必须 要把 ack 置 为 syn 同步 序列号 用来 发起 一个 连接 当 syn 而 ack 时 表明 这是 一个 请求 报 文段 若 对方 同意 连接 则 响应 报 文中 synackfin 用来 释放 一个 连接 当 fin 表示 此 报 文段 的 发送 方 已经 发送 完毕 并 要求 释放 链接 为什么 要 三次 握手 三次 握手 的 目的 是 建立 可靠 的 通信 信道 说到 通讯 简单 来说 就是 数据 的 发 送与 接收 而 三次 握手 最主要 的 目的 就是 双方 确认 自己 与 对方 的 发 送与 接收 是 正常 的 第一次 握手 client 什么 都不能 确认 server 确 认了 对方 发送 正常 自己 接收 正常 第二次 握手 client 确 认了 自己 发送 接收 正常 对方 发送 接收 正常 server 确 认了 对方 发送 正常 自己 接收 正常 第三次 握手 client 确 认了 自己 发送 接收 正常 对方 发送 接收 正常 server 确 认了 自己 发送 接收 正常 对方 发送 接收 正常 如果 你 听说过 红军 蓝军 通信 的 故事 你 就会 知道 并没有 办法 保证 百分百 正确 连接 所以 三次 握手 就能 确认 双 发 收发 功能 都 正常 如果 改为 四次 握手 万次 握手 也 就是 把 变成 意义 不大 以下内容 摘自 将 握手 分解为 实际操作 在 tcp 中 双方 通过 使用 序列号 来 跟踪 发送 的 内容 实际上 它最 终是 发送 的 所有 内容 的 运行 字节数 接收 方可 以 使用 对方 讲话 者 的 序列号 来 确认 接 收到 的 内容 但是 序列号 不是 从 开始 它从 isn 初始 序列号 开始 它是 一个 随机 选择 的 值 由于 tcp 是 双向通信 因此 双方 都可以 讲话 因此 双方 都必须 随机 生成 一个 isn 作为 其 起始 序列号 反过来 这 意味着 双方 都 需要 将其 开始 的 isn 通知 另一方 因此 您 以 以下 事件 序列 结束 开始 了 alice 和 bob 之间 的 tcp 对话 注意 正在 发生 四个 事件 实际上 中间 的 两个 事件 和 发 生在 同一 数据包 中使 数据包 成为 一个 syn 或 ack 仅仅是 使 每个 tcp 报 头中 的 二进制 标志 处于 打开 或 关闭 状态 的 原因 是什么 所以 没有什么 可以 阻止 在 同一 数据 包上 同时 启用 这两个 标志 因此 三向 握手 最终 为 因此 回到 您 的 问 题上 为什么 不只是 使用 双向 握手 简短 的 答案 是因为 双向 握手 只会 允许 一方 建立 isn 而 另一方 承认 它 这 意味着 只有 一方 可以 发送 数据 但是 tcp 是 双向 通信协议 这 意味着 任何 一端 都应该 能够 可靠地 发送 数据 双方 都 需要 建立 一个 isn 并且 双方 都 需要 确认 对方 的 isn 因此 实际上 您 所 拥有 的 只是 双向 握手 的 描述 但是在 每个 方 向上 因此 发 生了 四个 事件 同样 中间 两个 标志 出现在 同一 数据包 中 这样 三个 数据包 将 包 含在 完整 的 tcp 连接 启动 过程中 为什么 不 能用 两次 握手 进行 连接 我们 知道 次 握手 完成 两个 重要 的 功能 既要 双方 做好 发送 数据 的 准备工作 双方 都 知道 彼此 已 准备好 也要 允许 双方 就 初始 序列号 isn 进行 协商 这个 序列号 在握 手 过程 中被 发送 和 确认 如果 只是 两次 握手 至多 只有 连接 发起 方 的 起始 序列号 能 被 确认 另一方 选择 的 序列号 则 得不到 确认 三次 握手 a 发送 同步 信号 synasisnb 确认 收到 a 的 同步 信号 并 记录 asisn 到 本地 命名 发送 同步 信号 确认 收到 b 的 同步 信号 并 记录 bsisn 到 本地 命名 二次 握手 a 发送 同步 信号 synasisnb 确认 收到 a 的 同步 信号 并 记录 asisn 到 本地 命名 发送 同步 信号 这里有 一个 问题 a 与 b 就 a 的 初始 序列号 达 成了 一致 但是 b 无法 知道 a 是否 已经 接 收到 自己 的 同步 信号 如果 这个 同步 信号 丢失 了 a 和 b 就 b 的 初始 序列号 将 无法 达成 一 致谢 希 仁 版 计算机网络 中 的 例子 是 这样 的 已 失效 的 连接 请求 报 文段 的 产生 在 这样 一种 情况下 client 发出 的 第一个 连接 请求 报 文段 并没有 丢失 而是 在 某个 网络 结点 长时间 的 滞 留了 以致 延误 到 连接 释放 以后 的 某个 时间 才 到达 server 本来 这是 一个 早已 失效 的 报 文段 但 server 收 到此 失效 的 连接 请求 报 文段 后 就 误 认为是 client 再次 发出 的 一个 新 的 连接 请求 于是 就向 client 发出 确认 报 文段 同意 建立 连接 假设 不 采用 三次 握手 那么 只要 server 发出 确认 新 的 连接 就 建 立了 由于 现在 client 并没有 发出 建立 连接 的 请求 因此 不会 理睬 server 的 确认 也 不会 向 server 发送 数据 但 server 却 以为 新 的 运输 连接 已经 建立 并 一直 等待 client 发来 数据 这样 server 的 很多 资源 就 白白浪费 掉了 采用 三次 握手 的 办法 可以 防止 上述 现象 发生 例如 刚才 那种 情况 client 不会 向 server 的 确认 发出 确认 server 由于 收不到 确认 就 知道 client 并没有 要求 建立 连接 为什么 要 传回 syn 接收 端 传回 发送 端 所 发送 的 syn 是为了 告诉 发送 端 我 接 收到 的 信息 确实 就是 你 所 发送 的 信号 了 syn 是 tcpip 建立 连接 时 使用 的 握手 信号 在 客户机 和 服务器 之间 建立 正常 的 tcp 网络连接 时 客户机 首先 发出 一个 syn 消息 服务器 使用 synack 应答 表示 接收 到了 这个 消息 最后 客户机 再以 ack acknowledgement 汉译 确认 字符 在 数据通信 传输 中 接收站 发给 发送站 的 一种 传输 控制字符 它 表示 确认 发来 的 数据 已经 接受 无误 消息 响应 这样 在 客户机 和 服务器 之间 才能 建立起 可靠 的 tcp 连接 数据 才 可以 在 客户机 和 服务器 之间 传 递传 了 syn 为啥 还要 传 ack 双方 通信 无误 必须 是 两者 互相 发送 信息 都 无 误传 了 syn 证明 发送 方 到 接 收方 的 通道 没有问题 但是 接 收方 到 发送 方 的 通道 还需要 ack 信号 来 进行 验证 tcp 第三次 握手 失败 怎么办 server 端 如果 此时 ack 在 网络 中 丢失 那么 server 端 该 tcp 连接 的 状态 为 synrecv 并且 依次 等待 秒 秒 秒 后 重新 发送 synack 包 以便 client 重新 发送 ack 包 如果 重发 指定 次数 后 仍然 未 收到 ack 应答 那么 一段时间 后 server 自动 关闭 这个 连接 client 端 但是 client 认为 这个 连接 已经 建立 如果 client 端 向 server 写 数据 server 端 将以 rst 包 用于 强制 关闭 tcp 连接 响应 方能 感知 到 server 的 错误 三次 握手 有 哪些 缺陷 synflood 攻击 synflood 攻击 是 当前 网络 上 最为 常见 的 ddos 攻击 也是 最为 经典 的 拒绝服务 攻击 它 就是 利 用了 tcp 协议 实现 上 的 一个 缺陷 通过 向 网络服务 所在 端口 发送 大量 的 伪造 源地址 的 攻击 报文 就可能 造成 目标 服务器 中 的 半开 连接 队列 被 占满 从而 阻止 其他 合法 用户 进行 访问 这种 攻击 早 在年 就被 发现 但 至今 仍然 显示出 强大 的 生命力 很多 操作系统 甚至 防火墙 路由器 都 无法 有效地 防御 这种 攻击 而且 由于 它可 以 方便地 伪造 源地址 追查 起来 非常 困难 它 的 数据包 特征 通常是 源 发 送了 大量 的 syn 包 并且 缺少 三次 握手 的 最后 一步 握手 ack 回复 原理 攻击者 首先 伪造 地址 对 服务器 发起 syn 请求 服务器 回应 synack 包 而 真实 的 ip 会 认为 我 没有 发送 请求 不作 回应 服务器 没有 收到 回应 这样 的话 服务器 不知道 synack 是否 发送 成功 默认 情况下 会 重试 次 tcpsynretries 这样 的话 对于 服务器 的 内存 带宽 都有 很大 的 消耗 攻击者 如果 处于 公网 可以 伪造 ip 的话 对于 服务器 就 很难 根据 ip 来 判断 攻击者 给 防护 带来 很大 的 困难 版权 声明 本文 为 csdn 博 主 silentsharer 的 原创 文章 遵循 ccbysa 版权 协议 转载 请 附上 原文 出处 链接 及 本 声明 原文 链接 四次 挥手 第一次 挥手 client 不再 说话 了 挥手 fin 第二次 挥手 server 伤感 地 微笑 ack 如果 有话要说 继续 说话 第三次 挥手 server 不再 说话 了 挥手 fin 第四次 挥手 client 伤感 地 微笑 ack 第一次 挥手 之后 server 进入 关闭 等待 状态 也 就是 单向 关闭 client 已经 挥了 手 可是 人 还没有 走 只是 不再 说话 但是 耳朵 还是 可以 继续 听 server 呢 继续 喊话 等待 server 累了 也 不再 说话 了 超 client 挥了 挥手 client 伤感 地 微 笑了 一下 才 彻底 结束 了 客户端 发送 一个 fin 用来 关闭 客户端 到 服务器 的 数据 传送 服务器 收到 这个 fin 它 发回 一个 ack 确认 序 号为 收到 的 序号 加 和 syn 一样 一个 fin 将 占用 一个 序号 服务器 关闭 与 客户端 的 连接 发送 一个 fin 给 客户端 客户端 发回 ack 报文 确认 并将 确认 序号 设置 为 收到 序号 加为 什么 要 四次 挥手 任何一方 都可以 在数 据 传送 结束 后 发出 连接 释放 的 通知 待 对方 确认 后 进入 半 关闭 状态 当 另一方 也没有 数据 再 发送 的 时候 则 发出 连接 释放 通知 对方 确认 后 就 完全 关闭 了 tcp 连接 举个 例子 a 和 b 打电话 通话 即将 结束 后 a 说 我 没啥 要说 的 了 b 回答 我 知道了 但是 b 可能 还会 有 要说 的话 a 不能 要求 b 跟着 自己 的 节奏 结束 通话 于是 b 可能 又 巴 拉巴 拉 说了 一通 最后 b 说 我 说 完了 a 回答 知道了 这样 通话 才 算 结束 tcp 与 udp 协议 的 区别 常 问 udp 在 传送 数据 之前 不需要 先 建立 连接 远地 主机 在 收到 udp 报文 后 不需要 给出 任何 确认 虽然 udp 不 提供 可靠 交付 但在 某些 情况下 udp 确是 一种 最 有效 的 工作方式 一般 用于 即时 通信 比如 qq 语音 qq 视频 直播 等等 tcp 提供 面向 连接 的 服务 在 传送 数据 之前 必须先 建立 连接 数据 传送 结束 后 要 释放 连接 tcp 不 提供 广播 或 多 播 服务 由于 tcp 要 提供 可靠 的 面向 连接 的 传输 服务 tcp 的 可靠 体现在 tcp 在 传递 数据 之前 会有 三次 握手 来 建立 连接 而且 在数 据 传递 时有 确认 窗口 重传 拥塞 控制 机制 在数 据传 完 后 还会 断开 连接 用来 节约 系统资源 这一 难以避免 增加了 许多 开销 如 确认 流量 控制 计时器 以及 连接 管理 等 这 不仅 使 协议 数据 单元 的 首部 增大 很多 还要 占用 许多 处理机 资源 tcp 一般 用于 文件 传输 发送 和 接收 邮件 远程 登录 等 场景 tcp 协议 如何 保证 可靠 传输 应用 数据 被 分 割成 tcp 认为 最适合 发送 的 数据 块 tcp 给 发送 的 每一个 包 进行 编号 接 收方 对 数据包 进行 排序 把 有 序数 据传 送给 应用层 校验 和 tcp 将 保持 它 首部 和 数据 的 检验 和 这是 一个 端 到 端 的 检验 和 目的 是 检测 数据 在 传输 过程中 的 任何 变化 如果 收到 段 的 检验 和 有 差错 tcp 将 丢弃 这个 报 文段 和 不 确认 收 到此 报 文段 tcp 的 接收 端 会 丢弃 重复 的 数据 流量 控制 tcp 连接 的 每 一方 都有 固定 大小 的 缓冲 空间 tcp 的 接收 端 只允许 发送 端 发送 接收 端 缓冲区 能 接纳 的 数据 当 接 收方 来不及 处理 发送 方 的 数据 能 提示 发送 方 降低 发送 的 速率 防止 包 丢失 tcp 使用 的 流量 控制 协议 是 可变 大小 的 滑动 窗口 协议 tcp 利用 滑动 窗口 实现 流量 控制 拥塞 控制 当 网络 拥塞 时 减少 数据 的 发送 慢 开始 拥塞 避免 快 重传 快 恢复 arq 协议 自动 重传 请求 也是 为了 实现 可靠 传输 的 它 的 基本原理 就是 每 发完 一个 分组 就 停止 发送 等待 对方 确认 在 收到 确认 后 再发 下一个 分组 超时 重传 当 tcp 发出 一个 段 后 它 启动 一个 定时器 等待 目的 端 确认 收到 这个 报 文段 如果 不能 及时 收到 一个 确认 将 重发 这个 报 文段 这一 块 知识点 很多 但我 不想 写 如何 实现 udp 的 可靠 传输 运输 层 无法 保证 数据 的 可靠 传输 只能 通过 应用层 来 实现 了 实现 的 方式 可以 参照 tcp 可靠性 传输 的 方式 只是 实现 不在 传输 层 实现 转移 到了 应用层 最 简单 的 方式 是 在 应用层 模仿 传输 层 tcp 的 可靠性 传输 下面 不 考虑 拥塞 处理 可靠 udp 的 简单 设计 应答 确认 添加 seqack 机制 确保 数据 发送到 对 端 有序 接受 添加 包 序号 添加 超时 重传 机制 详细 说明 送 端 发送 数据 时 生成 一个 随机 seqx 然后 每 一片 按照 数据 大小 分配 seq 数据 到达 接收 端 后 接收 端 放入 缓存 并 发送 一个 ackx 的 包 表示 对方 已经 收 到了 数据 发送 端 收 到了 ack 包 后 删除 缓冲区 对应 的 数据 时间 到 后 定时 任务 检查 是否 需要 重传 数据 目前 有 如下 开源 程序 利用 udp 实现 了 可靠 的 数据传输 分别为 rudprtpudt 参考 文章 udp 如何 实现 可靠 传输 tcp 协议 存在 那些 缺陷 tcp 不知道 为什么 会 丢 包 tcp 流 控 算法 的 关键是 基于 丢 包 有否 丢 包 是 唯一 的 判断 依据 是 加 油门 还是 踩 刹车 但 tcp 由于 对 网络 了解 的 很 片面 无法 分辨 丢 包 是什么 原因 造成 的 网络 真的 拥堵 而 丢 包 线路 质 量差 crc 校验 失败 丢 或 信号 干扰 丢 ip 包 乱序 而 引起 的 误判 只有 情况 是 需要 踩 刹车 的 而 情况 并不需要 关于 这个 已经有 很多 改进 的 算法 了 比如 bbr 在 浏览器 中 输入 url 地址 发 生了 什么 太 常 问了 总体 来说 分为 以下 几个 过程 dns 解析 tcp 连接 发送 http 请求 服务器 处理 请求 并 返回 http 报文 浏览器 解析 渲染 页面 连接 结束 具体 看 这个 详细 的 浏览器 输入 url 后 发 生了 什么 知 乎 列举 常见 的 http 请求 头 和 响应 头 及其 作用 请求 头 accept 用于 高速 服务器 客户机 支持 的 数据类型 acceptcharset 用于 告诉 服务器 客户机 采用 的 编码 格式 acceptencoding 用于 告诉 服务器 客户机 支持 的 数据压缩 格式 acceptlanguage 客户机 的 语言 环境 host 客户机 通过 这 个头 高速 服务器 想 访问 的 主机名 ifmodifiedsince 客户机 通过 这 个头 告诉 服务器 资源 的 缓存 时间 referer 客户机 通过 这 个头 告诉 服务器 它是 从 哪个 资源 来访问 服务器 的 防盗链 useragent 客户机 通过 这 个头 告诉 服务器 客户机 的 软件 环境 cookie 客户机 通过 这 个头 可以 向 服务器 带 数据 connection 处 理完 这次 请求 后 是否 断开 连接 还是 继续 保持 连接 date 当前 时间 值 响应 头 location 这 个头 配合 状态 码 使用 用于 告诉 客户 找谁 server 服务器 通过 这 个头 告诉 浏览器 服务器 的 类型 contentencoding 服务器 通过 这 个头 告诉 浏览器 数据 的 压缩 格式 contentlength 服务器 通过 这 个头 告诉 浏览器 回送 数据 的 长度 contenttype 服务器 通过 这 个头 告诉 浏览器 回送 数据 的 类型 lastmodified 告诉 浏览器 当前 资源 的 最后 缓存 时间 refresh 告诉 浏览器 隔 多久 刷新 一次 告诉 浏览器 以 下载方式 打开 数据 告诉 浏览器 数据 的 传送 格式 etag 缓存 相关 的 头 expires 告诉 浏览器 把 回送 的 资源 缓存 多长时间 或 则是 不 缓存 状态 码 各种 协议 与 http 协议 之间 的 关系 一般 面试官 会 通过 这样 的 问题 来 考察 你 对 计算机网络 知识 体系 的 理解 图片 来源 图解 httphttp 与 https 的 区别 什么 是 httphttp 代表 超文本 传输 协议 当 您在 http 后 的 地址栏 中 输入 内容 时 它会 告诉 浏览器 通过 http 连接 http 通常 通过 端口 使用 tcp 传输 控制 协议 在 web 上 发送 和 接收 数据包 简而言之 它是 客户端 和 服务器 使用 的 协议 允许 您 与其 他 网站 进行 通信 客户端 向 托管 网站 的 http 服务器 在 tcp 握手 之后 发送 请求 消息 然后 该服 务 器用 响应 消息 进行 回复 响应 消息 包含 完成 状态 信息 例如 httpokhttp 报文 http 有 两种 报文 请求 报文 和 响应 报文 具体 介绍 如下 请求 报文 响应 报文 详细 可见 http 报文 详解 http 与 http 在 http 中 默认 使用 短 连接 也就是说 客户端 和 服务器 每 进行 一次 http 操作 就 建立 一次 连接 任务 结束 就 中断 连接 当 客户端 浏览器 访问 的 某个 html 或 其他 类型 的 web 页 中 包含 有 其他 的 web 资源 如 javascript 文件 图像文件 css 文件 等 每 遇到 这样 一个 web 资源 浏览器 就会 重新 建立 一个 http 会话 而 从 http 起 默认 使用 长 连接 用以 保持 连接 特性 在 使用 长 连接 的 情况下 当 一个 网页 打开 完成后 客户端 和 服务器 之间 用于 传输 http 数据 的 tcp 连接 不会 关闭 客户端 再次 访问 这个 服务器 时会 继续 使用 这一 条 已经 建立 的 连接 keepalive 不会 永久 保持 连接 它有 一个 保持 时间 可以 在 不同 的 服务器 软件 如 apache 中 设定 这个 时间 实现 长 连接 需要 客户端 和 服务端 都 支持 长 连接 http 协议 的 长 连接 和 短 连接 实质上 是 tcp 协议 的 长 连接 和 短 连接 关于 长 连接 与 短 连接 的 详细 部分 可以 看 什么 是 httpshttps 代表 安全 的 超文本 传输 协议 也 称为 tls 上 的 http 或 ssl 上 的 http 当 您 https 在 域 前面 的 地址栏 中 输入 内容 时 它会 告诉 浏览器 通过 https 连接 通常 运 行在 https 上 的 站 点将 具有 适当 的 重定向 因此 即使 您 键入 http 它也 将 重定向 以 通过 安全 连接 进行 传递 https 还 使用 tcp 传输 控制 协议 来 发送 和 接收 数据包 但是 它是 通过 端口 在 由 传输 层 安全性 tls 加密 的 连接 中 进行 的 https 流程 https 比 http 多了 一道 ssltsl 连接 保证 安全性 在 建立 tcp 连接 后 如果 客户端 此前 未 与 服务器 建立 会话 那么 双方 需要 进行 一次 完整 的 tls 四次 握手 之后 才能 发送 http 请求 http 与 https 的 区别 http 和 https 之间 的 主要 区别 在于 ssl 证书 在 https 上 加载 的 站点 使用 ssl 证书 以 加密 状态 发送 和 接收 信息 在 http 上 数 据以 文本格式 发送 任何人 都可以 轻松 读取 https 还 可以 改善 站点 的 seo 虽然 ssl 安全 套接 字 层 已 更新 为 tls 传输 层 安全性 但 web 社区 可 互换 使用 tls 和 ssl 以至于 它们 已成为 同义词 http 是 不安全 的 而 https 是 安全 的 http 通过 端口 发送 数据 而 https 使用 端口 http 运 行在 tcp 之上 而 https 运 行在 ssltls 之上 http 不需要 ssl 证书 对于 https 要求 您 具有 ssl 证书 并且 由 ca 签名 http 不需要 域 验证 而 https 至少 需要 域 验证 而 某些 证书 甚至 需要 法律 文档 验证 http 中 未加 密 使用 https 之前 数据 已 加密 https 是 如何 使用 tls 加密 的 对称 加密 所谓 对称 加密 就是 它们 在 编码 时 使用 的 密钥 e 和 解码 时 一样 对称 加解密 的 过程 如下 发送 端 和 接收 端 首先要 共享 相同 的 密钥 k 即 通信 前 双方 都 需要 知道 对应 的 密钥 才能 进行 通信 发送 端 用 共享 密钥 k 对 明文 p 进行 加密 得到 密 文 c 并将 得到 的 密 文 发送给 接收 端 接收 端 收到 密 文 后 并用 其 相同 的 共享 密钥 k 对 密 文 进行 解密 得出 明文 p 一般 加密 和 解密 的 算法 是 公开 的 需要 保持 隐秘 的 是 密钥 k 流行 的 对称 加密算法 有 destripledesrc 和 rc 对称 加密 的 不足 发送 方 和 接 接 收方 首先 需要 共享 相同 的 密钥 即 存在 密钥 k 的 分发 问题 如何 安全 的 把 共享 密钥 在 双方 进行 分享 这 本身 也是 一个 如何 安全 通信 的 问题 一种 方法 是 提前 双方 约定 好不 通过 具体 的 通信 进行 协商 避免 被 监听 和 截获 另外 一种 方式 将是 下面 我们 介绍 的 通过 非对称 加密 信道 进行 对称 密码 的 分发 和 共享 即 混合 加密 系统 密钥 管理 的 复杂度 问题 由于 对称 加密 的 密钥 是 一对一 的 使用 方式 若 一方 要 跟 n 方 通信 则 需要 维护 n 对 密钥 对称 加密 的 好处 加密 和 解密 的 速度 要比 非对称 加密 快 很多 因此 常用 非对称 加密 建立 的 安全 信道 进行 共享 密钥 的 分享 完成后 具体 的 加解密 则 使用 对称 加密 即 混合 加密 系统 另外 一个 点 需要 重点 说明 的 是 密钥 k 的 长度 对 解密 破解 的 难度 有 很 重大 的 影响 k 的 长度 越长 对应 的 密码 空间 就 越大 遭到 暴力破解 或者 词典 破解 的 难度 就 更大 就 更加 安全 非对称 加密 rsa 所谓 非对称 加密 技术 是 指 加密 的 密钥 e 和 解密 的 密钥 d 是 不同 的 ed 并且 加密 的 密钥 e 是 公开 的 叫做 公 钥 而 解密 的 密钥 d 是 保密 的 叫 私钥 非对称 加解密 的 过程 如下 甲方 生成 一对 密钥 并将 公 钥 公开 需 要向 甲方 发送 信息 的 其他 角色 乙方 使用 该 密钥 甲方 的 公 钥 对 机密 信息 进行 加密 后 再发 送给 甲方 甲方 再用 自己 私钥 对 加密 后 的 信息 进行 解密 甲方 想要 回复 乙方 时 正好 相反 使用 乙方 的 公 钥 对 数据 进行 加密 同理 乙方 使用 自己 的 私钥 来 进行 解密 常用 的 非对称 加密算法 有 rsa 非对称 加密 的 优点 是 不存在 密钥 分发 的 问题 解码 方 可以 自己 生成 密钥 对 一个 做 私钥 存 起来 另外 一个 作为 公 钥 进行 发布 解决 了 密钥 管理 的 复杂度 问题 多个 加密 方 都可以 使用 一个 已知 的 公 钥 进行 加密 但 只有 拥有 私钥 的 一方 才能 解密 非对称 加密 不足 加解密 的 速度 没有 对称 加密 快 综上 分析 了 对称 加密 和 非对称 加密 各自 的 优缺点 后有 没有 一种 办法 是 可以 利用 两者 的 优点 但 避开 对应 的 缺点 呢 答 应是 有的 实际上 用得 最多 的 是 混合 加密 系统 比 如在 两个 节点 间 通过 便捷 的 公开 密码 加密 技术 建立起 安全 通信 然后 再用 安全 的 通信 产生 并 发送 临时 的 随机 对称 密钥 通过 更快 的 对称 加密 技术 对 剩余 的 数据 进行 加密 https 是 如何 加密 的 客户端 生成 一个 对称 加密算法 的 密钥 用 非对称 加密 的 方式 安全 发给 服务端 随后 就 不用 非对称 加密 了 只用 这个 密钥 利用 对称 加密算法 来 通信 这样 即可以 保证 安全 又 可以 加快速度 也 就是 只 利用 rsa 传输 密钥 保证 密钥 的 安全 然后 利用 对称 加密 进行 信息 传输 https 相比 http 在 请求 前 多了 一个 握手 的 环节 在握 手 时 你 和 你想 访问 的 网站 会 交换 一个 密钥 就是 非对称 加密 的 密钥 握手 完成后 你 的 请求 先用 密钥 加密 才会 发出去 网站 服务器 的 响 应会 先用 密钥 加密 再传 给你 由于 整条 链 路上 的 节点 拿到 的 数据 都是 加密 过 的 所以 他们 即 无法 分 析出 源 数据 的 内容 也 无法 篡改 这个 加密 过 的 数据 如果 一个 节点 篡 改了 加密 后 的 数据 你 和 服务器 都没 办法 用 密钥 解密 出来 会 认为 数据 是 无效 的 总的来说 握手 过程中 服务器 会 发出 一张 证书 带着 公 钥 客户端 用 公 钥 加密 了 一段 较短 的 数据 s 并 返回 给 服务器 服务 器用 私钥 解开 拿到 s 此时 握手 步骤 完成 s 成 为了 一个 被 安全 传 输到 对方 手中 的 对称 加密 密钥 此后 服务器 与我 的 请求 响应 只需 要用 s 作为 密钥 进行 一次 对称 的 加密 就好 证书 体系 使用 对称 加密 和 非对称 加密 我们 的 https 协议 就 一定 安全 了吗 考虑 下 这种 情况 你 和 服务器 之间 有 一台 邪恶 的 路由器 m 当你 给 https 网站 的 服务器 发 请求 后 网站 带着 公 钥 p 响应 你 响应 到达 路由器 mm 拿 到了 公 钥 p 但是 并 不把 它 交给 你 而是 自己 伪造 了 一 对公 私钥 mp 和 ms 并把 mp 给你 你 拿到 mp 以为是 网站 的 公 钥 p 用它 加密 了 s 再 请求 网站 请求 到达 mm 使用 ms 解开 s 再用 p 加密 s 交给 网站 没错 就这样 邪恶 路由器 得 到了 s 至此 你 和 网站 的 通信 不再 安全 中间人 能 劫持 成功 的 本质 还是 因为 链 路 是 不安全 的 所以 没有 被 加密 的 握手 过程 一定 会有 这个 问题 而 目前 我们 解决问题 的 思路 却是 放在 了 公 钥 发 放上 暂时 绕 开了 这个 问题 这 就是 证书 体系 也是 为什么 你 要 去找 证书 签发 机构 花钱 购买 证书 的 原因 简单 来说 一个 https 网站 响应 给 我们 的 并不是 一个 公 钥 而是 证书 证 书上 包 含了 公 钥 还 包 含了 域名 签发 机构 有效期 签名 等等 那 证书 的 安全性 怎么 保证 为什么 中间人 不能 做一个 假 证书 因为 这套 证书 体系 已经 根植 于 每一个 操作系统 里 了 每一个 操作系统 里 都 内置 了 数十 张 根 证书 每个 根 证书 都 对应 一个 非常 权威 的 证书 签发 机构 这些 根 证 书上 记 录了 各个 机构 的 公 钥 当 网站 找 证书 机构 购 买了 一份 合法 的 证书 时 网站 申请 的 证 书上 的 公 钥 域名 有效期 等 信息 会被 计算 一次 hash 然后 证书 机构 用它 的 私钥 给 这个 hash 加密 一次 这个 加密 结果 就是 证书 的 签名 当 网站 的 合法 https 证书 到达 你 的 电脑 上 这个 证 书上 带有 签发 机构 的 信息 具体来说 应该是 一条 证书 链 你 的 浏览器 会用 这个 签发 机构 对应 的 操作系统 内置 根 证 书上 的 公 钥 去 解开 网站 https 证书 的 签名 还记得 吗 由于 运算 结果 有 周期性 所以 用 私钥 加密 的 信息 可以用 公 钥 解开 发现 签名 解开 的 hash 与 证书 信息内容 的 hash 一致 就可以 证明 证书 是 合法 的 了 那 中间人 能不能 申请 一个 真的 证书 然后 去做 劫持 呢 通常 来说 证书 签发 机构 的 审核 非常 严格 如果 无法 证明 wwwzhihucom 这个 域名 属于 他 签发 机构 是 不会 给他 签发 一个 知 乎 域名 的 证书 的 而 如果 中间人 用了 其他 域名 的 证书 浏览器 会 发现 你 请求 的 域名 和 返回 的 证书 不一致 从而 拒绝 继续 请求 除非 你 一定 要点 下面 的 仍然 继续 最后 无奈 地 说 在破 解了 这么 多数 学上 的 难题 后 https 的 安全性 仍然 保证 在 证书 签发 机构 一定 都是 很有 良心 的 这种 脆弱 的 基础上 ssl 协议 通信 过程 浏览器 发送 一个 连接 请求 给 服务器 服务器 将 自己 的 证书 包含 服务器 公 钥 spukey 对称 加密算法 种类 及其 他 相关 信息 返回 客户端 客户端 浏览器 检查 服务器 传 送到 ca 证书 是否 由 自己 信赖 的 ca 中心 签发 若是 执行 步 否则 给 客户 一个 警告 信息 询问 是否 继续 访问 客户端 浏览器 比较 证 书里 的 信息 如 证书 有效期 服务器 域名 和 公 钥 spk 与 服务器 传回 的 信息 是否 一致 如果 一致 则 浏览器 完 成对 服务器 的 身份 认证 服务器 要求 客户端 发送 客户端 证书 包含 客户端 公 钥 cpukey 支持 的 对称 加密 方案 及其 他 相关 信息 收到 后 服务器 进行 相同 的 身份 认证 若 没有 通过 验证 则 拒绝 连接 服务器 根据 客户端 浏览器 发送到 密码 种类 选择 一种 加密 程度 最高 的 方案 用 客户端 公 钥 cpukey 加密 后 通知 到 浏览器 客户端 通过 私钥 cprkey 解密 后 得知 服务器 选择 的 加密 方案 并 选择 一个 通话 密钥 key 接着 用 服务器 公 钥 spukey 加密 后 发送给 服务器 服务器 接 收到 的 浏览器 传 送到 消息 用 私钥 sprkey 解密 获得 通话 密钥 key 接下来 的 数据传输 都 使用 该 对称 密钥 key 进行 加密 上面 所述 的 是 双向 认证 ssl 协议 的 具体 通讯 过程 服务器 和 用户 双方 必须 都有 证书 由此可见 ssl 协议 是 通过 非对称 密钥 机制 保证 双方 身份 认证 并 完成 建立 连 接在 实际 数据通信 时 通过 对称 密钥 机制 保障 数据 安全性 tlsssl 大都 不再 使用 现在 主 要用 tls 但是 一般 情况下 将 二者 写在 一起 tlsssl 我们 可以 将 二者 看做 同一 类 协议 只不过 tls 是 ssl 的 升级版 tls 位于 http 和 tcp 之间 的 协议 其 内部 有 tls 握手 协议 tls 记录 协议 https 经由 http 进行 通信 但 利用 tls 来 保证 安全 即 httpshttptlstls 工作 流程 此为 服务端 单向 认证 还有 客户端 服务端 双向 认证 流程 类似 只不过 客户端 也有 自己 的 证书 并发 送给 服务器 进行 验证 多 进程 多线程 浏览器 浏览器 的 进程 大概 分为 以下 这 几种 浏览器 主 进程 browser 进程 控制 chrome 的 地址栏 书签 栏 返回 和 前进 按钮 同时 还有 浏览器 的 不可 见 部分 例如 网络 请求 和 文件 访问 第三方 插件 进程 每种 插件 一个 进程 插件 运行时 才会 创建 浏览器 渲染 进程 浏览器 内核 内部 是 多线程 的 负责 界面 渲染 脚本 执行 事件 处理 等 gpu 进程 最多 一个 用于 d 绘制 同时 浏览器 中 的 每一个 frame 框 也 都是 一个 独立 的 进程 因为 浏览器 的 安全策略 中 来自 不 同源 的 界面 在 没有 授权 前 不可以 访问 另一个 界面 的 数据 同时 给 不 同源 的 界面 分配 不同 的 进程 可以 有效 的 实现 这一 效果 详细 看 重学 浏览器 多 进程 多线程 的 浏览器 post 与 get 的 区别 简单 一点 讲 get 从 服务器 获取 数据 post 用 来向 服务器 提交 数据 get 请求 在 url 中 传送 的 参数 是 有 长度 限制 的 而 post 没有 get 比 post 更不 安全 因为 参数 直接 暴露在 url 上 所以 不能 用来 传递 敏感 信息 get 参数 通过 url 传递 post 放在 requestbody 中 get 请求 参数 会被 完整 保留在 浏览器 历史记录 里 而 post 中 的 参数 不 会被 保留 get 请求 只能 进行 url 编码 而 post 支持 多种 编码 方式 get 请求 会被 浏览器 主动 cache 而 post 不会 除非 手动 设置 get 产生 的 url 地址 可以 被 bookmark 而 post 不可以 get 在 浏览器 回退 时 是 无害 的 而 post 会 再次 提交 请求 但是 get 和 post 是什么 http 协议 中 的 两种 发送 请求 的 方法 http 是什么 http 是 基于 tcpip 的 关于 数据 如 何在 万维网 中 如何 通信 的 协议 http 的 底层 是 tcpip 所以 get 和 post 的 底层 也是 tcpip 也就是说 getpost 都是 tcp 链接 get 和 post 能做 的 事情 是 一样 一样 的 你 要给 get 加上 requestbody 给 post 带上 url 参数 技术上 是 完 全行 的 通 的 详细 可见 get 与 post 的 区别 面试官 最想 听到 的 答案 参考 文章 漫画 一招 学会 tcp 的 三次 握手 和 四次 挥手 tcp 的 三次 握手 与 四次 挥手 详解 动 图 非对称 加密 与 httpshttps 演化过程 对称 加密 非对称 加密 公 钥 私钥 数字签名 数字证书 https 处理 的 一个 过程 对称 加密 和 非对称 加密 