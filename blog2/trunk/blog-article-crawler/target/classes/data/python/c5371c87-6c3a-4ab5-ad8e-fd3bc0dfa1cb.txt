系统安全 五 ollydbg 和 cheat engine 工具 逆向 分析 植物 大战 僵尸 游戏 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 系统安全 系列 作者 将 深入研究 恶意 样本 分析 逆向 分析 攻防 实 战和 windows 漏洞 利用 等 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 前文 普及 了 ollydbg 的 基础 用法 和 crakeme 案例 这篇 文章 将 详细 讲解 ollydbg 和 cheatengine 工具 逆向 分析 用法 完成 植物 大战 僵尸 的 游戏 辅助 器 包括 修改 阳光 值 和 自动 拾取 阳光 两个 功能 希望 对 入门 的 同学 有 帮助 话 不 多说 让我们 开始 新 的 征程 吧 您 的 点 赞 评论 收藏 将是 对 我 最大 的 支持 感恩 安全 路上 一路 前行 如果有 写得 不好 的 地方 可以 联系 我 修改 基础性 文章 希望 对 您 有所 帮助 作者 的 目的 是 与 安 全人 共同进步 加油 文章 目录 一 vs 内存地址 查看 二 cheatengine 逆向 修改 阳光 值 三 ollydbg 逆向 自动 拾取 阳光 四 总结 及 学习 推荐 作者 的 github 资源 系统安全 网络安全 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 系统安全 四 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 破解 系统安全 五 ollydbg 和 cheatengine 工具 逆向 分析 植物 大战 僵尸 游戏 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 一 vs 内存地址 查 看在 讲解 ollydbg 和 cheatengine 工具 逆向 分析 游戏 之前 我 想 先给 大家 普及 下 内存地址 的 基础 概念 以及 通过 创建 项目 来讲 解下 内存地址 值 它们 的 关系 第一步 打开 vs 创建 空 项目 rezwdzjs 然后 添加 maincpp 源文件 如 下图 所示 选中 项目 右键 添加 gt 新建 项 然后 创建 maincpp 文件 第二步 添加 代码 如下 所示 我们 尝试 在 内存 中 查看 变量 的 位置 其中 表示 输出 提示 方式 如果是 进制 在前面 加 如果是 十进制 不加 任何 字符 如果是 十六进制 会 加上 intx 内存 中 查看 值得 位置 printf xnampx 暂停 getchar return 我们 尝试 添 加个 断点 然后 运行 程序 第三步 按 下 f 调试 输出 结果 为 xffcdcxffcdc 第四步 接着 我们 需要 在 内存 中 查看 这个 值 选择 调试 gt 窗口 gt 内存 然后 随便 选择 一个 内存 输入 地址 xffcdc 即可 接着 我们 打开 程序员 型 计算机 可以 看到 对应 的 十六进制 就是 e 刚好 和 上面 的 e 一致 e 注意 这里 仅 显示 了 一个 字节 我们 如果 右键 选中 转 换为 字节 则 可以 显示 完整 的 数值 如 下图 所示 xe 写到 这里 vs 简单 查看 内存 的 方法 就 介绍 完毕 了 其 原理 类 比为 内存 gt 旅馆 地址 gt 门牌号 值 gt 旅客 a 那么 我们 怎么 将 旅客 a 换成 旅客 b 呢 这就 需要 通过 门牌号 在 旅馆 中找到 旅客 a 再 替换 但 之前 需要 进行 权限 提升 才能 进行 后续 的 操作 同样在 游 戏中 如果 我们 想在 内存 中 修改 值 也是 通过 地址 访问 这个 值 再 进行 修改 修改 前 也 需要 提升 权限 具体操作 主要 包括 四个 步骤 第一步 找到 游戏 窗口 第二步 通过 窗口 找到 进程 id 第三步 通过 进程 id 打开 进程 第四步 通过 打开 的 进程 完成 内容 修改 讲解 完 这个 基础知识 接着 我们 开始 植物 大战 僵尸 的 逆向 吧 二 cheatengine 逆向 修改 阳光 值 修改 阳光 值 其实 就是 修改 游戏 的 分数 能量 血量 攻击力 之类 的 其 原理 是 通过 地址 修改 内存 中 的 值 这里 主要 使用 的 是 cheatengine 工具 第一步 通过 cheatengine 工具 打开 运行 着 的 植物 大战 僵尸 游戏 第二步 输入 数字 点击 首次 扫描 返回 结果 为 个 第三步 接着 反复 玩游戏 并 输入 对应 的 数字 进行 再次 扫描 比如 输入 数字 点击 再次 扫描 最终 我们 得 到了 一个 结果 其 地址 为 xfba 第四步 打开 任务 管理器 然后 选中 植物 大战 僵尸 游戏 右键 选择 转到 详细信息 按钮 显示 结果 如 下图 所示 这里 获 取了 植物 大战 僵尸 的 进程 idpid 原理 搞懂 之后 接下来 就需要 编写 代码 完成 阳光 值 的 修改 第五步 在 编写 c 语言 代码 修改 阳关 的 参数 前先 讲解 spy 的 查找 窗口 功能 和 findwindow 函数 我们 在 vs 中 可以 看到 查找 窗口 函数 findwindow 包括 两个 参数 即 窗口 的 类型 和 窗口 的 标题 findwindow lpclassname 窗口 的 类 名 窗口 的 标题 这里 我们 可以 通过 spy 来 进行 辅助 讲解 在 弹出 的 界面 中 选择 这个 查找 窗口 从 左 数 第五个 按钮 然后 移动 选择 游戏 窗口 查看 对应 的 信息 它 包括 窗口 句柄 如 下图 所示 所以 接下来 我们 可以 通过 标题 和 类 进行 查找 标题 植物 大战 僵尸 中文版 类 mainwindow 第六步 编写 核心 c 语言 代码 实现 相关 游戏 修改 功能 通过 函数 找到 进程 hwndhwnd 窗口 句柄 接收 进程 标识 的 位 值 的 地址 通过 openprocess 函数 打开 一个 已 存在 的 进程 对象 并 返回 进程 的 句柄 渴望 得到 的 访问 权限 标志 是否 继承 句柄 进程 标示 符 通过 函数 写入 某一 进程 的 内存 区域 注意 直接 写入 会出 accessviolation 错误 故 需 此 函数 入口 区 必须 可以 访问 否则 操作 将 失败 handlehprocess 由 openprocess 返回 的 进程 句柄 要写 的 内存 首 地址 lpvoidlpbuffer 指向 要写 的 数据 的 指针 dwordnsize 要 写入 的 字节数 完整 代码 如下 输入 值 作为 修改 阳光 参数 intxscanf dampx 进程 iddwordpid 找到 游戏 窗口 窗口 类型 窗口 标题 nulll 植物 大战 僵尸 中文版 通过 窗口 找到 进程 hwndamppid 通过 进程 ip 打开 进程 通过 打开 进程 修改 游戏 内容 hprocess lpvoid xfba lpvoid ampxsizeof x amppid return 第七步 当 我们 进行 数值 修 改时 我们 的 植物 大战 僵尸 阳光 也 就行 对应 的 修改 先 设置 为 如 下图 所示 修改 成功 哈哈 是不是 完 成了 一个 简单 的 游戏 辅助 器 呢 接着 我们 修 改成 如果 提示 警告 识别 远程 线程 注入 我们 点击 允许 本次 修改 即可 最终 成功 将 阳光 值 修 改为 我们 终于 可以 愉快 的 玩耍 了 妈妈 再也 不用 担心 我 的 阳光 同样 第二 关 我们 也 可以 进行 修改 但 此时 的 窗口 地址 会有 变化 它 变 为了 xae 修改 核心 函数 hprocess lpvoid xae lpvoid ampxsizeof x amppid 注意 如果 游戏 存在 地址 保护 的 情况 我们 可以 尝试 注入 进行 修改 本 系列 文章 仅 分析 经典 的 本地 游戏 至于 网络游戏 一律 禁止 大家 去 修改 或 破坏 原理 普及 安全 防护 为主 第八 步 编程 中 遇到 的 错误 一 定要 学会 独立 百度 谷歌 解决 这是 至关重要 的 一种 能力 提升 注意 如果 提示 错误 则 因为 vs 认为 scanf 函数 是 不安全 的 进行 安全 开发 生命周期 sdl 检查 设置 即可 三 ollydbg 逆向 自动 拾取 阳光 自动 捡取 的 关键是 点击 鼠标 如果 你 点击 到了 阳 光上 它 才会 增加 所以 我们 希望 在 阳光 下落 的 时候 触发 点击 阳光 事件 然后 阳光 地址 会 增加 初步 预测 涉及 两个 call 函数 阳光 出现 call 判断 是否 点击 到 阳光 然后 增加 阳光 的 call 第一步 当 我们 使用 cheatengine 定位 到 阳光 的 地址 后 可以 选中 该 地址 右键 设置 找出 是什么 修 改了 这个 地址 首先 植物 大战 僵尸 此时 定位 的 地址 为 xae 然后 选中 改 地址 右键 设置 找出 是什么 修 改了 这个 地址 xae 第二步 等待 下一个 阳光 捡起 后 可以 在 下图 所示 窗 口中 获取 新 产生 的 值 即 xa 接着 点击 xa 地址 将 扩展 信息 记录下来 方便 接下来 的 自动 拾取 功能 xa 同时 点击 显示 反汇编 程序 会 形成 下图 所示 的 效果图 第三步 利用 ollydbg 软件 打开 游戏 第四步 前面 我们 已经 定位 到了 阳光 的 窗口 地址 xa 接着 按 下 ctrlg 或者 右键 转到 gt 表达式 然后 跳 转到 指定 位置 跳转 xa 如 下图 所示 第五步 按 下 f 给它 增 加个 断点 以及 注释 游戏 运行 到 点击 阳光 增加 数值 时 就会 断 到 这里 我们 可以 查看 ecx 数值 它 应该是 对应 十进制 的 所以 猜测 这里是 增加 阳关 值 运行 程序 直到 捡起 阳光 它会 自动 停到 断点 位置 并且 ecx 修 改为 x 对应 的 阳光 值 增 加分 观察 汇编 代码 发现 它是 一个 增加 语句 即 验证 了 它是 阳光 的 增加 语句 第六步 点击 调试 gt 执行 到 返回 按钮 快捷键 ctrlf 接着 跳 转到 xab 位置 如 下图 所示 注意 返 回到 xfd 位置 返回 地址 xfd 第七步 在 retn 返回 处 按 下 f 执行 单步 步入 会 看到 call 函数 执行 完毕 我们 不难 推测 这个 函数 就是 增加 阳光 的 函数 xfcallplantsvsd 接着 我们 给它 增加 一个 断点 然后 再次 运行 程序 点击 拾取 阳光 后会 自动 定位 到 该 位置 第八 步 选中 该条 语句 进行 nop 操作 nop 指令 相当于 空 指令 令 不 执行 任何 动作 对应 进制 字节 码 为 当 我们 的 软件 有 广告 弹窗 时 我们 可以 通过 nop 设置 过滤掉 弹窗 接着 选中 xf 该行 右键 汇编 然后 在 弹出 的 窗 口中 设置 为 nop 即可 如 下图 所示 设置 之后 xf 位置 变 成了 nop 空 指令 我们 可以 把 这个 语句 nop 设置 后 发现 点击 阳光 数值 是 不 增加 的 从而 确定 了 增加 函数 第九步 然后 右键 撤销 修改 接着 分析 汇编 代码 jnz 操作 这时 可以 看到 在 call 函数 之前 有 一个 jnz 操作 也就是说 它 可能 需要 判断 值 才会 进入 增加 阳光 的 函数 我们 在 这个 jnz 下 断点 再 进入 游戏 点击 阳光 结果 不为 零 或 不相等 则 转移 多次 运行 程序 放行 之后 会 发现 当 我们 点击 阳光 之后 阳 光会 往上走 只有 当 阳光 完全 到达 指定 位置 左上角 之后 才会 执行 call 增加 阳光 值 由此 得知 这个 jnz 主 要是 判断 阳关 是否 到位 注意 这里 需要 多次 在 xf 处 下 断点 再 取消 运行 游戏 反复 操作 之后 会发 现 实现 jnz 操作 后 阳 光会 向左 上角 移动 否则 会 停止 状态 作者 也是 一点点 摸着 过河 加油 第 十步 继续 执行 程序 定位 点击 函数 在 增加 阳光 的 call 函数 xb 前有 个 跳转 当 jnz 执行 成功 之后 才会 增加 这个 call 我们 在 jnz 处 下 断点 调试 它 的 执行 流程 当 我们 在 jnz 处 下 断点 后 运行 游戏 会 突然 跳 转到 断点 处 停止 如 下图 所示 并且 游戏 屏幕 没有 任何 操作 接着 按 下 f 运行 发现 阳光 即将 出现 阳光 出现 如 下图 所示 由于 jnz 断点 会 让 游戏 很卡 接着 我们 将该 处 断点 取消 而在 xb 位置 call 增加 断点 执行 程序 后会 发现 当 我们 点击 阳光 的 时候 会被 断 下 所以 判断 它是 阳光 采集 函数 这是 个 很 典型 的 ifelse 语句 如果 没有 被 点击 就会 一直 执行 动画 call 如果 被 点击 那么 就会 执行 增加 阳光 的 call 第 十 一步 最 重要 的 步骤 出现 我们 将 jnz 修 改为 jmp 从而 实现 自动 捡取 阳光 当 我们 修改 完成 之后 会 发现 阳光 一出 现就 自动 增加 根本 不需要 手动 去 点击 最终 完 成了 该 辅助 功能 同样 我们 可以 尝试 编写 c 语言 实现 相关 自动化 修改 这里 不再 进行 讲解 结果 不为 零 或 不相等 则 转移 jmp 汇编 无条件 跳转 指令 注意 cmpbyteptrdsebx 是 判断 是否 收集 阳光 的 标志 然后 才 执行 jnz 或 jmp 操作 当 我们 点击 一个 植物 时 程序 断了 下来 可以 看到 赋值 jnz 是 不会 跳转 的当 我们 点击 阳光 的 时候 才会 赋值 调用 函数 采集 阳光 四 总结 及 学习 推荐 写到 这里 这篇 文章 就 介绍 完毕 希望 对 您 有所 帮助 最后 进行 简单 的 总 结下 vs 内存地址 查看 cheatengine 逆向 修改 阳光 值 ollydbg 逆向 自动 拾取 阳 光学 安全 一年 认识了 很多 安全 大佬 和 朋友 希望 大家 一起 进步 这篇 文章 中 如果 存在 一些 不足 还请 海涵 作者 作为 网络安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 深知 自己 很菜 得 努力 前行 很多 朋友 问我 如何 学 逆向 分析 下面 给出 推荐 的 学习 路线 和 安全 书籍 软件 逆行 其实 就是 搬 砖 活 你 需要 的 是 任性 和 基本功 可能 大佬 们 会有 很多 技巧 但我 希望 你 能 扎扎实实 去 躺过 那些 坑 会 看懂 代码 会写 代码 然后 ida 和 od 工具 倚天 屠龙 用好 每天 泡在 代码 中肯 定 能行 的 你 应该 这样 学习 多 敲 代码 重视 实战 程序 不是 写出来 的 是 调出来 的 根据 自己 兴趣 和 市场需求 做 一定 规模 的 项目 下图 开发 和 逆向 项目 非常 推荐 你 去 完成 开发 远 控 软件 有助于 你 分析 木马 cad 软件能 提升 你 c 分析 能力 做一个 调制器 或许 反 调试 就 不再 那么 难 自制 一个 小 操作系统 小 编译器 任务 管理器 或许 逆向 原理 就 懂了 编程 没有 捷径 逆向 也没有 捷径 它们 都是 搬 砖 活 少 琢磨 技 巧干 就 对了 什么时候 你 把 攻击 对手 按在 地上 摩擦 你 就 赢了 也 会 慢慢 形 成了 自己 的 安全 经验 和 技巧 加油 吧 少年 希望 这个 路线 对 你 有所 帮助 共勉 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 周三 夜 于 武汉 参考资料 c 语言 逆向 工 程之 游戏 辅助 开发 c 语言 plus 游戏 辅助 制作 核心 植物 大战 僵尸 逆向 之 召唤 僵尸 call 九 游戏 辅助 制作 核心 植物 大战 僵尸 逆向 之 植物 攻击 加速 六 植物 大战 僵尸 自动 拾取 阳光 tdjia 游戏 逆向 篇 星星 向 蓉 ce 游戏 逆向 若 离 