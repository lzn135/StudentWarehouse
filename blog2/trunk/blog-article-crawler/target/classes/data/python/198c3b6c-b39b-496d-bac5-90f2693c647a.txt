译 apt 分析 报告 06. 猖獗 的 小猫 针对 伊朗 的 apt 攻击 活动 详解 这是 作者 新开 的 一个 专栏 主要 翻译 国外 知名 的 安全 厂商 apt 报告 文章 了解 它们 的 安全 技术 学习 它们 溯源 apt 组织 的 方法 希望 对 您 有所 帮助 前文 分享 了 turla 新型 水坑 攻击 后门 netflash 和 pyflash 通过 伪造 adobeflash 更新 欺骗 受害者 下载 两个 新型 恶意 软件 netflash 和 pyflash 从而 实现 恶意 攻击 这篇 文章 将 详细 介绍 rampantkitten 攻击 活动 包括 windows 信息 窃取 程序 android 后门 和 电报 网络 钓鱼 页面 这是 机构 的 分析 报告 非常 值得 大家 学习 原文 标题 原文 链接 文章 作者 checkpoint 发布 时间 年月日 文章 来源 相关 文章 文章 目录 一 初次 感染 二 感染 链 三 有效载荷 分析 电报 结构 基础 配置 cc 沟通 持久性 四 基础设施 和 连接 五 android 后门 六 电报 网络 钓鱼 七 有效载荷 传递 八 溯源 攻击 起源 目标 九 结论 十 技术 附录 pc 后门 变异 分析 telb 变体 telandext 变体 python 信息 窃取 变体 分析 hookinjex 变体 十一 技术 附录 android 后门 分析 数据 采集 google 凭据 盗窃 已 启用 google 保护 cc 短信 渗透 十二 相关 指标 及 总结 揭 露了 伊朗 实体 多年来 一直 针对 伊朗 侨 民和 持不同政见者 多年 进行 监视 行动 尽管 其他 研究人员 和 记者 先前 曾 报道 过 一些 针对 个人 的 攻击 事件 但 我们 的 调查 能够 将 不同 的 攻击 行动 联系起来 并将 它们 归因于 同一 攻击者 我们 发现了 不同 的 攻击 载体 包括 四种 不同 版本 的 windows 信息 窃取 程序 旨在 窃取 受害者 的 个人 文件 以及 访问 其 电报 telegram 桌面 和 keepass 帐户 信息 android 后门 从 短信 smsmessages 中 提取 双 因素 验证 代码 记录 手机 的 语音 环境 等 电报 钓鱼 网页 利用 伪造 的 电报 服务 帐户 分发 上述 工具 和 方法 似乎 主要 用于 对付 伊朗 少数 mzfzq 组织 和 抵抗 yd 例如 阿 什 拉夫 营 和 自由 营 居民家庭 协会 afalr 阿塞拜疆 mz 抵抗 组织 俾路支 人 一 初次 感染 我们 首先 遇到 的 文档 名 称为 docx 大致 翻 译为 当局 担心 gmdp 的 扩散 docx 该 文件 的 标题 实际上 指的是 伊朗 zq 与 gmdp 运动 之间 的 持续 斗争 mujahedinekhalq 是 一个 fzf 组织 其 目标 是 使 伊朗 摆脱 目前 的 地位 年 mek 开始 建立 他们 的 新 总部 后来 在 iraqi 小镇 哈 里斯 附近 被称为 ashraf 营地 但是 iraqi 多年 的 紧张局势 最终 导致 该 营地 的 居民 被 转移到 一个 新 的 偏远 的 目的地 阿尔巴尼亚 上面 的 文档 利 用了 外部 模板 技术 允许 它从 远程 服务器 加载 文档 模板 在 本例 中 是 远程 模块 如 下图 所示 出于 对 这个 网站 的 好奇 我们 开始 探索 更多 关于 它 的 信息 我们 发现 一些 反对 伊朗 zq 的 账户 发布 推 文 提 到了 一个 非常 类似 的 sharepoint 网站 该 文档 中 的 网站 很可能 冒充 了 以下 网站 afalr 的 官方网站 如 下图 所示 二 感染 链 当 受害者 打开文档 并 下载 了 远程 模板 后 模板 中 的 恶意 宏代码 将 执行 一个 批处理 脚 本该 脚本 尝试 从 下载 并 执行 下一阶段 的 有效 负载 然后 有效 负载 会 检查 是否 在 受 感染 的 计算 机上 安 装了 telegram 如果 检查 有效 它将 继续 从 其 资源 中 提取 三个 额外 的 可执行文件 bobccda 加载 器 loader 由 rundll 执 行将 主要 有效载荷 注入 explorerexe 中 codabcc 信息 窃取 的 有效载荷 修改 电报 的 更新 程序 三 有效载荷 分析 该 恶意 软件 的 主要功能 包括 信息 窃取 者 上传 受害者 电脑 的 相关 电报 文件 这些 文件 允许 攻击者 充分利用 受害者 的 电报 帐户 从 keepass 应用程序 窃取 信息 上传 任何 它能 找到 的 以 预 定义 扩展名 结尾 的 文件 记录 剪贴板 数据 并 采取 桌面 屏幕 截图 模块 下载 器 下载 并 安装 几个 额外 的 模块 独特 的 持久性 实现 了 一种 基于 telegram 内部 更新过程 的 持久性 机制 电报 结构 基础 首先 让我们 回顾 一下 telegramdesktop 如何 组织 其 文件 以下 是 一个 普通 的 电报 文件 结构 通常 可以 在 路径 找到 如上所述 在 感染 链 期间 有 几个 文件 被 拖 放到 telegram 工作 目录 中 删除 的 文件 位于 一个 名为 abecs 的 目录 中 由 于是 一个 定制 的 desktopini 文件 所以 第一眼 看上去 像 一个 文件 但它 实际上 是 一个 目录 受 感染 的 telegramdesktop 目录 如 下图 所示 配置 有效 负载 的 一个 资源 包含 编码 的 配置 数据 编码方案 使用 常规 的 base 算法 但是 使用 自定义 索引 表 为 对 该 资源 进行 解码 可为 我们 提供 以下 配置 信息 cc 沟通 该 恶意 软件 使用 soap 进行 通信 soap 是 用于 web 服务 通信 的 基于 xml 的 简单 数据结构 soapweb 服务 的 api 是 公开 的 可以 从 以下 浏览器 访问 网站 来 观察 cc 网站 中 的 soapapi 如 下图 所示 消息 命令 可以 分为 以下 几类 身份 认证 helloworld 身份 认证 消息 模块 下载 器 检查 是否 应该 下载 模块 downloadfile 从 远程 服务器 下载 模块 数据 渗漏 uploadfileexist 检查 是否 已 上传 特定 的 受害者 文件 uploadfile 上传 一个 特定 的 受害者 文件 身份 认证 有效 通信 隧道 的 第一条 消息 应该是 helloworld 它 实现 了 简单 的 用户名 密码 身份验证 凭证 在 示例 中进 行了 硬 编码 并且 该 消息 的 soap 响应 包含 一个 会话 id 该 会话 id 必须 用于 其余 的 会话 模块 下载 器 该 程序 尝试 获 取其 当前 模块 的 更新 并 下载 几个 其他 模块 一些 额外 的 确实 模块 无法 获取 包括 数据 渗漏 该 恶意 软件 的 核心 功能 是 从 目标 设备 中 窃取 尽可能 多 的 信息 有效 负载 针对 两个 主要 应用程序 telegramdesktop 和 著名 的 密码 管理器 keepass 一旦 相关 的 telegram 桌面 和 keepass 的 文件 已被 上传 恶意 软件 就会 列举 在 受害者 电脑 上 找到 具有 以下 扩展名 的 相关 文件 对于 每个 这样 的 文件 恶意 软件 在 将其 编码 为 base 后 将其 上传 持久性 该 恶意 软件 使用 一种 独特 的 持久性 方法 该 方法 与 电报 更新过程 相关联 它将 定期 将 telegram 主 可执行文件 复制到 中 一旦 电报 应用程序 启动 就会 触发 一个 更新 程序 该 恶意 软件 的 持久性 方法 的 一个 隐藏 技巧 是 更改 默认 的 telegram 更新 器 文件 其中 包含 已 删除 的 有效载荷 之一 具体 的 是 cobaccd 该 更新 程序 最 显着 的 更新 是 再次 运行 有效 负载 其中 telegram 更新 程序 运行 主要 有效 负载 如 下图 所示 四 基础设施 和 连 接在 分析 了 有效载荷 之后 我们 能够 追溯到 年 的 多种 变体 这表明 这种 攻击 已经 酝酿 了 多年 由 相同 攻击者 开发 的 恶意 软件 变体 之间 常常 会有 细微 的 差异 尤其是 在 相同 的 时间 范围内 使用 它们 时 但是在 这种 情况下 我们 注意到 虽然 某些 变体 是 同时 使用 的 但 它们 是 用 不同 的 编程 语言 编写 的 利 用了 多种 通信协议 并不 总是 窃取 相同 类型 的 信息 在 下表 中 我们 列 出了 发现 的 变体 并 突 出了 它们 的 独特 特征 请参阅 下面 的 技术 附录 了解 关于 每种 变体 的 详细信息 相关 样本 还 揭示 了 更多 的 cc 服务器 通过 查找 它们 的 被动 dns 信息 和 其他 元 数据 我们 可以 找到 由 同一 攻击者 操作 的 相似 域 事实证明 某些 域名 出现在 恶意 android 应用程序 和 网络 钓鱼 页面 中 从而 暴 露了 该 操作 的 更多 层次 信息 下图 为 恶意 基础 架构 的 maltego 图 五 android 后门 在 我们 的 调查 过程中 还 发现了 与 相同 威胁 参与者 有 关联 的 恶意 android 应用程序 该 应用程序 伪装成 一种 服务 以 帮助 在 瑞典 说 波斯语 的人 获得 驾照 的 服务 我们 已经 找 到了 同一 应用程序 的 两个 不同 变体 一个 似乎 是为了 测试 而 编译 的 另 一个是 要在 目标 设备 上 部署 的 发行版 android 应用程序 的 主 界面 如 下图 所示 此 android 后门 包含 以下 功能 窃取 现有 的 sms 消息 向 攻击者 控制 的 campc 服务器 提供 的 电话号码 转发 两 因素 认证 短信 检索 个人信息 例如 联系 人和 帐户 详细信息 启动 电话 周围环境 的 录音 执行 google 帐户 网络 钓鱼 检索 设备 信息 如 已 安装 的 应用程序 和 正在 运行 的 进程 有关 此 应用程序 的 详细信息 请参阅 下面 的 技术 附录 六 电报 网络 钓鱼 这些 后门 并不是 攻击者 试图 窃取 有关 telegram 帐户 信息 的 唯一 方法 与 该 恶意 活动 相关 的 某些 网站 还 托 管了 仿冒 telegram 的 网络 钓鱼 页面 如 下图 所示 令人 惊讶 的 是 几个 伊朗 电报 频道 实际上 已经 发 出了 针对 这些 钓鱼 网站 的 警告 并 声称 伊朗 zq 是 他们 的 幕后 黑手 针对 网络 钓鱼 尝试 的 翻译 后 的 消息 警告 如 下图 所示 根据 这些 频道 钓鱼 信息 是 由 电报 机器人 发送 的 这些 信息 警告 收件人 他们 正在 不当 使用 telegram 的 服务 如果 他们 不 进入 钓鱼 链接 他们 的 账户 将被 封掉 另一个 telegram 频道 提供 了 钓鱼 企图 的 截图 显示 攻击者 建 立了 一个 冒充 官方 telegram 的 账户 最初 攻击者 在 新 的 telegram 更新 中发 送了 有关 这些 功能 的 消息 使其 显得 合法 网络 钓鱼 消息 仅在 天后 发送 并 指向 与 上面 图 相同 的 域 下图 展示 了 从 假 电报 帐户 发送 的 网络 钓鱼 消息 七 有效载荷 传递 尽管 在 某些 情况下 我们 无法 确定 恶意 文件 如何 到达 受害者 但 我们 收 集了 一些 有关 攻击者 分发 恶意 软件 方式 的 潜在 线索 例如 访问 mailgoogleinfo 表明 它 模拟 ozvdarozvcom 并 推广 了 一种 软件 以 增加 telegram 频道 中 的 成员 数量 mailgoogleinfo 下载页 面如 下图 所示 但是在 单击 下载 后 一个 名为 的 有 密码保护 的 文档 就 会被 下载 其 包含 一种 恶意 软件 变种 年 一篇 被 删除 的 博客 文章 指控 一名 网络安全 专家 剽 剽窃 当时 他 在 接受 阿拉 比 亚 新闻频道 采访 讨论 伊朗 的 网络 攻击 我们 相信 这个 页面 是 针对 此人 或 他 的 同伙 的 有 针对性 的 攻击 的 一部分 这个 博客 包 含了 一个 链接 可以 下载 一个 有 密码保护 的 档案 其中 包 含了 来自 endploadcom 的 抄袭 证据 enduploadcom 通过 几个 被动 dns 跃 点 连接 到 上述 pc 和 android 操作 包括 通过 历史 dns 服务器 信息 直接 连 接到 mailgoogleinfo 域名 我们 不仅 没有 发 现在 合法 环境 中使 用过 该 域名 的 任何 实例 而且 还 发现了 该 域名 已被 波斯语 黑客 注册 的 证据 请 参见 下面 的 归因 部分 已 删除 的 博客 文章 及其 链接 enduploadcom 如 下图 所示 与 年 不同 的 博客 文章 讨论 了 伊朗 人权 活动 家协会 附属 新闻机构 hrana 的 侵犯 人权 行为 报告 再次 此 博客 引 用了 可以 从 enduploadcom 以下 网站 下载 的 文档 年 的 另一 篇 博客 文 章则 讨论 了 伊朗 rq 活动 人士 协会 下属 新闻机构 hrana 发布 的 一篇 报告 同样 这个 博客 引 用了 一个 可以 从 endploadcom 下载 的 文档 下图 展示 了 博客 中 带有 指向 enduploadcom 的 链接 不幸 的 是 我们 无法 获得 两个 博客 条目 所指 的 文件 也 无法 确认 它们 是否 是 恶意 的 但是 似乎 enduploadcom 已 经由 攻击者 控制 了 多年 因为 与此 攻击 有关 的 一些 恶意 样本 可 追溯到 年 已与 该 网站 进行了 通信 八 溯源 尽管 我们 发现 多年来 在此 攻击 中使 用过 的 许多 文件 和 网站 但 它们 并未 归因于 特定 的 威胁 组织 或 实体 但是 威胁 攻击者 留在 恶意 事件 中 的 一些 指纹 使 我们 可以 更好 地 了解 攻击 可能 来自 何处 攻击 起源 首先 某些 恶意 网站 的 whois 信息 表明 它们 据 称是 由 伊朗 个人 注册 的 下图 展示 了 enduploadcom 和 picfilenet 的 whois 信息 whois 记 录了 endploadcom 还 提到 一个 电子 邮件地址 显然 该 网站 的 注册 用户 在 网上 非常 活跃 因为 查询 的 用户名 是 nobodygust 我们 可以 在 伊朗 黑客 论坛 上 看到 关于 他 的 许多 帖子 目标 我们 观察到 的 目标 清单 反映 了 伊朗 内部 的 一些 斗争 和 这次 xi 击 背后 的 动机 精心 挑选 的 目标 包括 sz 组织 和 阿塞拜疆 组织 的 支持者 这两个 著名 的 抵抗运动 提倡 jf 伊朗人 民和 伊朗 境内 的 少数 mz 这些 运动 与 伊朗 当局 之间 的 意识形态 ct 使 它们 成为 这种 xi 击 的 自然 目标 因为 它们 与 该 zq 的 目标 相吻合 此外 后门 的 功能 以及 窃取 敏感 文件 访问 keepass 和 telegram 账户 的 重点 表明 攻击者 对 收集 受害者 的 情报 了解 他们 的 更多 活动 很感兴趣 九 结论 追踪 这次 攻击 的 踪迹 可以 发现 这次 大规模 行动 在 很大 程度 上 成功地 隐藏 了 至少 年根 据 我们 收集到 的 证据 这些 似乎 来自 伊朗 的 攻击者 利用 多种 攻击 载体 暗中 监视 他们 的 受害者 及其 个人电脑 和 移动 设备 由于 我们 确认 的 大多数 目标 都是 伊朗人 这 可能是 伊朗 攻击者 正在 收集 关于 该 组织 潜在 对手 的 情报 sandblastmobile 可提供 实时 威胁 情报 和 对 移动 威胁 的 可 见性 防止 受到 恶意 软件 网络 钓鱼 中间人 攻击 操作系统 攻击 等 的 侵害 checkpoint 的 反 网络 钓鱼 解决方案 包括 针对 网络 钓鱼 攻击 的 所有 攻击 媒介 的 产品 包括 电子邮件 移动电话 端点 和 网络 十 技术 附录 pc 后门 变异 分析 telb 变体 telb 是 我们 遇到 的 最新 变体 其 分析 如上 所示 我们 之所以 这样 命名 是因为 下一个 调试 字符串 变体 此 变体 可能是 telb 的 旧版本 主要 在年 和 年 期间 活跃 它与 新版本 共享 以下 特性 和 技术 在 delphi 中 开发 与 telb 变体 共享 大量 代码 专注 于 telegramdesktop 应用程序 类似 的 持久 化 和 更新 方法 使用 ftp 而 不是 soap 进行 数据 溢出 我们 将此 变体 命名为 telandext 因为 下一个 调试 字符串 为 信息 窃取 变体 分析 我们 发现了 一些 使用 以下 方法 的 样本 两层 sfx 自 解压 存档 可 提取 多个 batvbsnfsconf 文件 通过 将可 执行 文件 以 结尾 nfs 复制到 可执行文件 的 名 称为 speakeraudioexe 或 keyboardenexe 具体 取决于 示例 该 可执行文件 是 使用 pyinstaller 创建 的 下载 名为 netupdateexe 的 第二阶段 有效 负载 在 上传 之前 使用 带有 硬 编码 密码 的 库 pyaescrypt 对 数据 进行 加密 根据 我们 的 分析 该 变体 在 信息 窃取 方面 使用 硬 编码 的 凭据 与 ftp 服务器 通信 并 窃取 以下 数据 电报 桌面 应用程序 相关 文件 paltalkng 应用程序 相关 文件 chromefirefox 和 edge 的 相关 数 据以 给定 配置 中 列出 的 扩展名 结尾 的 任何 文件 如果 未 提供 任何 配置 它将 搜索 具有 以下 扩展名 的 文件 同时 在 调查 过程中 我们 看到了 几个 python 信息 窃取 器 它们 与 同一个 ftp 服务器 通信 但是 将 窃取 的 信息 以 不同 的 别名 存储 在 不同 的 页面 中 我们 怀疑 这是 恶意 软件作者 的 操作 方式 选择 一个 目标 并在 ftp 服务器 中 为 它们 创建 一个 指定 的 文件夹 使用 针对 数据 上传 的 唯一 aes 密钥 和 ftp 凭证 构建 针对 目标 定制 的 样本 通过 感染 链 载体 之一 提供 武器 化 的 可执行文件 第二阶段 有效 负载 hookinjex 其 核心 功能 之 一是 获取 第二阶段 的 有效 负载 如果 指定 的 ftp 文件夹 包含 名为 netupdateexe 的 文件 则 它将 下载 并 执行 该 文件 我们 分析 了 其中 的 几个 netupdateexe 样本 发现 与 下面 的 hookinjex 变体 完全 重叠 从而 使其 成为 有 针对性 的 高级 有效 负载 hookinjex 变体 该 变体 自 年 以来 一直在 使用 并 具有 位 和 位 版本 随着 时间 的 流逝 该 变体 不断 演变 并 添 加了 一些 功能 同时 还 更 改了 其 感染 链 中 不同 组件 的 名称 我们 发现了 两种 主要 的 感染 链 sfx 自 解压 存档 包含 所有 组件 它将 所有这些 文件 放入 一个 文件夹 然后 执行 主 加载 程序 在 旧版本 中 伪造 的 scr 文件 充当 可执行文件 为了 看起来 像 合法 的 scr 文件 加载 程序 包含 一个 诱饵 jpegpptxdoc 文件 作为 资源 resource 该 文件 在运 行时 加载 scr 文件 还将 其他 有效载荷 作为 其 资源 删除 并 使用 命令行 运行 主 加载 程序 恶意 scr 打开 诱饵 jpg 资源 如 下图 所示 该 变体 在 挂钩 和 注入 方面 主 加载 程序 使用 称为 hookinjex 的 挂钩 和 注入 方法 该 方法 将 dll 映 射到 explorerexe 在其 中将 start 按钮 子 类化 在 我们 的 示例 中 加载 的 dll 是 在 较早 的 版本 中 在 新版本 中 该 恶意 软件 还会 以其 他 语言 挂起 start 按钮 不同 语言 的 存在 可能 表明 它 的 受害者 来自 世界各地 的 国家 不同 的 翻译 是 该 恶意 软件 从一 个 名为 devinfasd 的 文件 接收 其 配置 asd 在 旧版本 中 命名为 fileasd 配置 被 解密 并 写入 一个 名为 drvcnf 的 新文件 asd 旧版本 中 命名为 fileasd 加密 方法 为 该 恶意 软件 从一 个 名为 的 文件 devinfasd 在 较早 的 版本 中 名为 fileasd 接收 配置 解密 配置 并 将其 写入 名为 drvcnfasd 的 新文件 在 旧版本 中 名为 fileasd 加密 方法 为 defdecode content len content contentj chr curbyte chr curbyte returnoutputstr 解密 配置 后 恶意 软件 会 解析 这些 值 并 将其 放入 全局变量 中 clbfjpg clbtjpg clbpjpg 在 持久 化 方面 该 恶意 软件 将 ltreggt 配置文件 值 中 的 注册 表项 几乎 总是 注册 表项 runonce 设置 为 以下 值 它将 名称 设置 为 sunjavahtml 或 devnicjava 其 值 为 drvupdtexe 这样 恶意 软件 就 知道 它 已经 被执行 了 在 旧版本 中 该 恶意 软件 用来 删除 名为 rreeggexe 或 capdevexe 的 文件 该 文件 被 添加到 runonce 中 然后 依次 执行 drvupdtexe 在 信息 窃取 方面 该 恶意 软件 的 主要功能 是 从 受害者 的 计算机中 窃取 信息 然后 使用 ftp 将其 发送到 c 该 恶意 软件 窃 取了 不同 类型 的 数据 登录 数据 firefox 信息 配置文件 密钥 和 数据库文件 的 输出 whois 信息 基于 ltwsgt 值 前台 窗口 的 屏幕 截图 和 标题 一分钟 的 波形 音频 记录 来自 可 移动 驱动程序 的 文件 文件 类型 基于 文件 中 的 ltcpygt 标记 在 旧版本 中 在 某些 版本 中 该 逻辑 是 在 名为 的 文件 中 实现 的 uflscanexe 有趣 的 是 如果 驱动程序 的 名字 是 以下内容 之一 artwef 或 transcend 恶意 软件 就会 终止 线程 我们 认为 它是 一个 调试 代码 它 的 目的 是 防止 恶意 软件 从 作者 的 电脑 收集 文件 来自 其他 驱动器 的 基于 devufltmp 旧版本 为 winufltmp 文件 中 的 标记 的 文件 键盘 日志 和 剪贴板 数据 从 各种 格式 包括 拖放 虚拟 键 代码 和 cfdib 使用 webcam 捕获 旧版本 的 tcwinexe 自 telegram 桌面 数据 下 图为 带有 硬 编码 可 移动 驱动程序 的 调试 代码 在 c 通讯 方面 此 变体 使用 ftp 协议 将 文件 上 传到 其 c 域 ftp 域 位于 ltsngt 标记 内 的 配置文件 中 该 连接 首先 使用 配置文件 中 的 密码 和 用户名 进行 身份验证 然后 该 恶意 软件 根据 ltffgt 标记 和 其中 的 子目录 及其 之前 生成 的 用户 id 创建 一个 目录 用户 id 根据 写入 文件 中 的 网络适配器 的 信息 生成 的 在 较早 的 版本 中 之后 连接 typei 和 pasv 命令 继续进行 然后再 使用 命令 存储 文件 stor 该 变体 还与 其他 域 联系 以 更新 其 不同 组件 域 被 放置 在 配置文件 内 ltuugtltuugt 和 ltuugt 标签 使用 从 给定 的 url 下载 文件 这些 文件 userid 包 含在 url 中 在 字符串 混淆 方面 在 较 新版本 自 年 起 中使 用以 下 脚本 对 字符串 进行 加密 ampbufamp len inputstr curbyte outputstr 十一 技术 附录 android 后门 分析 第一个 活动 是 mainactivity 它 负责 向 用户 提供 诱饵 内容 并 请求 执行 特权 活动 的 权限 它还 启动 一个 名为 mainservice 的 后台 服务 并在 服务器 发送 命令 时 启动 第二个 gmailactivity 下图 展示 了 要求 用户 允许 一组 权限 数据 采集 一旦 gmailactivity 启动 mainservice 它将 负责 以下 任务 计时器 注册 配置 监视 显示 虚假 通知 如下 所述 和 敏感数据 收集 在此 初始 数据 收集 过程中将 读取 并 准备 以下 信息 已 安装 的 应用程序 列表 账户 信息 短信 联系人 信息 从 cc 服务器 收到 命令 后 其余 信息 将 按需 收集 录音 默认 情况 下为 秒 录音 google 凭据 服务器 触发 身份验证 网络 钓鱼 尝试 google 凭据 盗窃 在 收到 正确 的 命令 从 campc 服务器 谷歌 登录 页面 将 显示 给 受害者 通过 激活 gmailactivity google 登录 页面 如 下图 所示 此时 用户 会 看到 一个 合法 的 登录 页面 位于 android 的 webview 中 为了 窃取 输入 的 凭证 使 用了 android 的 以及 一个 定时 从 用户名 和 密码 输入 字段 中 检索 信息 的 计时器 定期 检索 google 帐户 凭据 代码 如 下图 所示 已 启用 google 保护 如前所述 它 的 核心 功能 之 一是 打开 麦克风 并 记录 周围环境 为了 实时 实现 这一 目标 应用程序 需要 在 后台 运行 其 服务 任何 想要 执行 此类 操作 的 android 应用程序 都 需要 向 用户 发布 一个 正在进行 的 通知 提醒 用户 设备 上有 未 启动 的 活动 为了 规避 这个 问题 恶意 软件 开发者 选择 向 用户 显示 一个 谷歌 保护 已 启用 的 假 通知 下图 展示 了 应用程序 显示 虚假 通知 结果是 伪装成 google 保护 的 永远 在线 的 诱饵 通知 cc 该 恶意 软件 使用 常规 的 http 与 campc 服务器 通信 它将 初始 请求 发送给 alarabiyenet 并 继续 与 通信 以 获得 配置 命令 和 状态 更新 信息 为了 上传 所有 敏感 信息 该 恶意 软件 使用 带有 硬 编码 凭证 的 ftps 此 外在 将 敏感 文件 上 传到 ftp 服务器 之前 它会 使用 aes 算法 以及 预先 配置 的 密码 对 它们 进行 加密 aes 加密 代码 如下 短信 渗透 此 恶意 应用程序 的 独特 功能 之 一是 将 前缀 为 g 谷歌 双 因素 身份 验证码 的 前缀 的 短信 转 发到 它从 campc 服务器 接 收到 的 电话号码 此外 所有 来自 telegram 等 社交 网络 应用 的 短信 也 会 自动 发送到 攻击者 的 电话号码 在 我们 的 分析 过程中 很明显 这个 恶意 应用程序 仍在 积极 开发 中 各种 资产 和 功能 要么 是 以前 操作 的 遗留 要么 是 尚未 使用 其中 一个 未 使用 的 网络 钓鱼 资产 甚至 包含 一个 预先 输入 的 用户名 可能是 攻击者 先前 操作 的 目标 未 使用 的 网络 钓鱼 html 资产 和 位置 跟踪 代码 如 下图 所示 十二 相关 指标 及 总结 网络 钓鱼 安 卓 cc 服务器 文件 的 文件 的 文件 的 变体 cc 服务器 后门 的 后门 的 后门 的 最后 希望 这篇 文章 对 您 有所 帮助 更多 指标 推荐 大家 阅读 原文 非常感谢 大家 的 祝 福和 关心 希望 早些时候 带 思 远去 珞珈山 看看 如果 以后 他 能 考上 就 更 好了 哈哈 爸爸 即将 返校 奋斗 希望 宝宝 和 女神 都 健健康康 开开心心 敏 而 多思 宁静致远 无 思 远 人 劳心 忉 忉 爱 你们 喔 回去 后 得 更加 努力 脚踏实地 当然 最 重要 的 还有 远方 和 你们 晚 安娜 前文 分享 译 apt 分析 报告 linux 系统 下 针对性 的 apt 攻击 概述 译 apt 分析 报告 钓鱼 邮件 网址 混淆 url 逃避 检测 译 apt 分析 报告 opblueraven 揭露 apt 组织 fincarbanak 上 tirion 恶意 软件 译 apt 分析 报告 kraken 新型 无 文件 apt 攻击 利用 windows 错误报告 服务 逃避 检测 译 apt 分析 报告 turla 新型 水坑 攻击 后门 netflash 和 pyflash 译 apt 分析 报告 猖獗 的 小猫 针对 伊朗 的 apt 攻击 活动 详解 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 逆向 分析 apt 分析 报告 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 ccfsci 南 核 北 核 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 星期 一晚 上点 写 于 贵阳 