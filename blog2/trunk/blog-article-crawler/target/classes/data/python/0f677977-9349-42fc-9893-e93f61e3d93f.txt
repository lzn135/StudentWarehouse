系统安全 十六 pe 文件 逆向 基础知识 pe 解析 pe 编辑 工具 和 pe 修改 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 作者 前文 介绍 了 三个 漏洞 包括 chrome 浏览器 保存 密码 渗透 解析 通过 chrome 浏览器 实现 win 蓝屏 音乐 软件 解密 功能 复现 这篇 文章 将 介绍 基础知识 详细 讲解 pe 文件 格式 熟悉 各种 pe 编辑 查看 工具 针对 目标 exe 程序 新增 对话框 等 这也 为 后续 pe 病毒 和 恶意代码 的 攻防 打下 扎实 基础 这些 基础 性知识 不仅 和 系统安全 相关 同样 与 我们 身边 的 app 常用软件 及 系统 紧密联系 希望 这些 知识 对 您 有所 帮助 更 希望 大家 提高 安全意识 安全 保障 任重道远 使用 工具 包括 待 分析 程序 helloexe 从 年月 开始 我 来 到了 一个 陌生 的 专业 网络空间 安全 初 入 安全 领域 是 非常 痛苦 和 难受 的 要 学 的 东西 太多 涉及面 太 广 但 好在 自己 通过 分享 篇 网络安全 自学 系列 文章 艰难 前行 着 感恩 这一 年 相识 相知 相 趣 的 安全 大佬 和 朋友们 如果 写得 不好 或 不足之处 还请 大家 海涵 接下来 我 将 开启 新 的 安全 系列 叫 系统安全 也是 免费 的 篇文章 作者 将 更加 深入 的 去 研究 恶意 样本 分析 逆向 分析 内网 渗透 网络 攻防 实战 等 也 将 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 加油 推荐 前文 网络安全 自学 篇 系列 篇文章 目录 一 pe 文件 基础 二 pe 文件 格式 解析 editor 解析 pe 文件 ollydbg 动态 调试程序 仅 弹出 第二个 窗口 三 熟悉 并 分析 pe 文件 的 引出 表 peview 和 studpe 查看 文件 寻找 函数 messageboxa 的 地址 四 pe 文件 新增 对话框 五 总结 作者 的 github 资源 逆向 分析 网络安全 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 系统安全 四 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 系统安全 五 ollydbg 和 cheatengine 工具 逆向 分析 植物 大战 僵尸 游戏 系统安全 六 逆向 分析 之 条件 语句 和 循环 语句 源码 还原 及 流程 控制 系统安全 七 逆向 分析 之 pe 病毒 原理 c 实现 文件 加解密 及 ollydbg 逆向 系统安全 八 windows 漏洞 利 用之 cve 复现 及 蓝屏 攻击 系统安全 九 windows 漏洞 利 用之 ms 远程 代码 执行 漏洞 复现 及 深度 提 权 系统安全 十 windows 漏洞 利 用之 smbv 服务 远程 代码 执行 漏洞 cve 复现 系统安全 十一 那些 年 的 熊猫 烧香 及 pe 病毒 行为 机理 分析 系统安全 十二 熊猫 烧香 病毒 ida 和 od 逆向 分析 上 病毒 初始化 系统安全 十三 熊猫 烧香 病毒 ida 和 od 逆向 分析 中 病毒 释放 机理 系统安全 十四 熊猫 烧香 病毒 ida 和 od 逆向 分析 病毒 释放 过程 下 系统安全 十五 chrome 浏览器 保留 密码 功能 渗透 解析 蓝屏 漏洞 及 某 音乐 软件 漏洞 复现 系统安全 十六 pe 文件 逆向 基础知识 pe 解析 pe 编辑 工具 和 pe 修改 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 该 样本 不会 分享 给 大家 分析 工具 会 分享 参考文献 见 后 一 pe 文件 基础 什么 是 pe 文件 pe 文件 的 全 称是 意为 可 移植 的 可执行 的 文件 常见 的 exedllocxsyscom 都是 pe 文件 pe 文件 是 微软 windows 操作系统 上 的 程序 文件 可能是 间接 被执行 如 dllexe 文件 格式 dosmz 格式 位 windows 可执行文件 格式 为什么 要 重点 学习 这种 文件 格式 呢 pe 文件 是 可 移植 可执行 跨 win 平台 的 文件 格式 所有 win 执行 体 知道 pe 文件 本质 后 能 更好 进行 恶意 样本 分析 apt 攻击 分析 勒索 病毒 分析 了解 软件加密 和加 壳 的 思想 能够 pj 相关 的 pe 文件 它是 您 熟悉 windows 操作系统 的 第一步 包括 exe 程序 怎么 映 射到 内存 dll 怎么 导入 等 软件 逆向 工程 的 基本思想 与 pe 文件 格式 息息相关 如果 您想 成为 一名 黑客 系统安全 工程师 那么 精通 pe 文件 是 非常 必要 的 可执行 程序 是 具有 不同 的 形态 的 比如 用户 眼中 的 qq 如 下图 所示 本质上 qq 如 下图 所示 pe 文件 格式 总体 结构 接着 让我们 来 欣赏 下 pe 文件 格式 总体 结构图 包括 mz 头部 dosstubpe 文 件头 可选 文 件头 节 表 节 等 本文 的 第二 部分 我们 将对 pe 文件 格式 进行 详细 解析 比如 mz 头文件 是 定位 pe 文 件头 开始 位置 用于 pe 文件 合法性 检测 dos 下 运行 该 程序 时会 提示 用户 文件 格式 与 恶意 软件 的 关系 何为 文件 感染 或 控制权 获取 使 目标 pe 文件 具备 或 启动 病毒 功能 或 目标 程序 不 破坏 目标 pe 文件 原有 功能 和 外在 形态 如 图标 等 病毒 代码 如何 与 目标 pe 文件 融为一体 呢 代码 植入 控制权 获取 图标 更改 hookpe 文件 解析 常用工具 包括 peview 可 按照 pe 文件 格式 对 目标 文件 的 各 字段 进行 详细 解析 studpe 可 按照 pe 文件 格式 对 目标 文件 的 各 字段 进行 详细 解析 ollydbg 可 跟踪 目标 程序 的 执行 过程 属于 用户 态 调试 工具 ultraediteditor 可对 目标 文件 进行 进制 查看 和 修改 二 pe 文件 格式 解析 该 部分 实验 内容 使用 editor 观察 pe 文件 例子 程序 helloexe 的 进制 数据 使用 ollydbg 对 该 程序 进行 初步 调试 了解 该 程序 功能 结构 在 内存 中 观察 该 程序 的 完整 结构 使用 editor 修改 该 程序 使 得该 程序 仅 弹出 第二个 对话框 editor 解析 pe 文件 pe 文件 结构 如 下图 所示 我 推荐 大家 使用 editor 工具 及其 模板 来 进行 pe 文件 分析 mz 头部 dosstubpe 文 件头 可选 文 件头 节 表 节 使用 editor 工具 打开 pe 文件 并 运行 模板 该 pe 文件 可分为 若干 结构 如 下图 所示 mz 文 件头 hfh 下 图为 helloexe 的 mz 文 件头 该 部分 固定 大小 为 h 个 字节 偏移 ch 处 字段 指示 nt 映 象头 的 偏移 地址 其中 b 是 nt 映 象头 的 文件 偏移 地址 定位 pe 文 件头 开始 位置 用于 pe 文件 合法性 检验 b 指向 pe 文 件头 开始 位置 dos 插 桩 程序 hafhdosstub 部分 大小 不 固定 位于 mz 文 件头 和 nt 映 象头 之间 可由 mz 文件 头中 的 字段 确定 下 图为 helloexe 中 的 该 部分内容 pe 文 件头 bhah 该部 分 包括 pe 标识 映像 文 件头 可选 文 件头 signature 字串 pe 个 字节 bhbh 映象 文 件头 fileheaderh 个 字节 bhch 偏移 h 处 字段 numberofsection 给出 节 的 个数 个 字节 偏移 h 处 字段 给出 可选 映 象头 的 大小 个 字节 e 可选 映 象头 对应 解析 如 下图 所示 包括 pe 标识 x 架构 个 节 文件 生成 时间 coff 便宜 可选 头大 小文件 信息 标记 等 editor 使用 模板 定位 pe 文件 各 节点 信息 pe 文件 可选 文 件头 字节 其 对应 的 字段 信息 如下 所示 机器 型号 判断 是 pe 是 位 还是 位 连接器 版本号 高 版本 连接器 版本号 低版 本组 合起来 就是 其中 是 高 版本 c 是 低版本 dwordsizeofcode 代码 节 的 总 大小 为 一个 磁盘 扇区 初始化 数据 的 节 的 总 大小 也 就是 未 初始化 数据 的 节 的 大小 也 就是 程序 执行 入口 oep rva 相对 偏移 dwordbaseofcode 代码 的 节 的 起始 rva 相对 偏移 也 就是 代码 区 的 偏移 偏移 模块 首 地址 定位 代码 区 dwordbaseofdata 数据 结 的 起始 偏移 rva 同上 dwordimagebase 程序 的 建议 模块 基址 意思 就是说 作 参考 用 的 模块 地址 在 哪里 内存 中 的 节 对齐 文件 中 的 节 对齐 操作系统 版本号 高位 操作系统 版本号 低位 版本号 高位 版本号 低位 子系统 版本号 高位 子系统 版本号 低位 位 系统 版本号 值 注意 只能 修 改为 表示 操作系统 支持 nt 以上 的话 依次 类推 整个 程序 在 内存 中 占用 的 空间 pe 映 尺寸 所有 头 头 的 结构 体 大小 节 表 的 大小 dwordchecksum 校验 和 对于 驱动程序 可能会 使用 wordsubsystem 文件 的 子系统 重要 文件 属性 也 可以 成为 特性 可能 dll 文件 可以 当做 驱动程序 使用 预留 的 栈 的 大小 立即 申请 的 栈 的 大小 分页 为 单位 预留 的 堆 空间 大小 立即 申请 的 堆 的 空间 的 大小 与 调试 有关 下面 的 成员 数据 目录 结构 的 项目 数量 数据 目录 默 认个 是 宏 这里 方便 直接 写成 节 表 ahfh 表项 大小 固定 h 个 字节 表项 个数 由 映象 文 件头 的 字段 numberofsection 给出 每个 表项 的 起始 位置 起 个 字节 字段 name 给出 对 应节 的 名称 每个 表项 的 偏移 h 处 个 字节 字段 offsettorawdata 给出 对 应节 的 起始 文件 偏移 该 结构 包括 个 节 对应 上图 的 个 即 testrdatadata 节 其 偏移 地址 对应 下图 紫色 区域 分别 是的 位置 个 节 hffh 代码 节 hffh 引入 函 数节 hffh 数据 节 注意 代码 节 text 前 h 为 数据 后面 全是 位 填 充值 为了 实现 文件 的 h 对齐 所以 代码 节 是 h 到 ffh 引入 函 数节 来 从 其他 dll 中 引 函数 引 入了 kerneldll 和 userdll 这个 节 一般 名为 rdata 引入 函数 是 被 某 模块 调用 的 但又 不在 调用者 模块 中 的 函数 用来 从 其他 系统 或 第三方 写 的 dll 中 引入 函数 例如 kerneldllgdidll 等 editor 打开 如 下图 所示 详细 标注 信息 如 下图 所示 图 引自 hyq 同学 再 此 感谢 数据 节 数据 节 实际 大小 h 对齐 后 大小 h 地址 为 hffh 包括 对话框 弹出 的 具体内容 ollydbg 动态 调试程序 使用 ollydbg 对 该 程序 进行 初步 调试 了解 该 程序 功能 结构 在 内存 中 观察 该 程序 的 完整 结构 注意 内存 对齐 单位 和 文件 对齐 单位 的 不同 内容 和 文件 中 iat 表 内容 的 不同 我们 以 helloexe 程序 作为 示例 进行 调试 第一步 打开 od 加载 pe 文件 od 是 一款 pe 文件 动态 调试器 此时 程序 断点 自动 停止 在 程序 入口 点 h 位置 在 editor 中 我们 可以 看到 该 pe 程序 基 地址 是 h 程序 入口 地址 是 h 两个 相 加为 加载 至 内存 中 的 地址 即 h 第二步 动态 调试程序 当 我们 双击 地址 位置 则可 以下 断点 且 变红 比如 fh 接着 查看 对应 调试 快捷键 f 是 单步 步入 f 是 单 步步 过 我们 直接 按 f 单 步步 过 此时 的 位置 会 call 一个 messageboxa 函数 直接 单 步步 过 此时 会 弹出 第一个 对话框 点击 确定 按钮 第三步 动态 调试程序 之 数据 跟随 接着 我们 看 左下角 部分 的 内存 数据 在 该 区域 按 下 ctrlg 在 数据 窗口 中 跟随 输入 基 地址 此时 可以 看到 加 载到 内存 中 的 数据 可以 看到 该 数据 与 editor 打开 的 pe 文件 数据 一致 的 接着 继续 按 f 单 步步 过 弹出 第二个 窗口 右上角 是 它 寄存器 的 值 包括 各个 寄存器 中 的 数据 我们 实验 中 主要 使用 的 寄存器 包括 eaxecxedxebx 等 接着 步 过 e 它是 退出 进程 exitprocess 的 位置 此时 进程 已经 终止 如 下图 所示 实验 讲到 这里 使用 od 动态 调试 的 pe 文件 的 基础 流程 就 讲解 完毕 后续 随着 实验 深入 我们 还会 使用 该 工具 仅 弹出 第二个 窗口 使用 editor 修改 该 程序 使 得该 程序 仅 弹出 第二个 对话框 思路 为 修改 程序 的 入口 点 地址 第一步 确定 程序 入口 点 地址 前面 我们 用 editor 或 peview 确定 了 可选 文件 头中 这一 项 里面 的 值 是 h 这个 是 rva 相对 便宜 地址 偏移 在 d 处 大小 为 字节 装 载到 内存 后 程序 入口 点 应该是 h 第二步 确定 第二个 对话框 的 偏移 地址 然后 看到 od 里 为 第二个 call 做 传入 参数 的 push 语句 从 开始 故 我们 将 改为 即可 弹出 第二个 窗口 第三步 利用 pe 编辑 工具 修改 程序 入口 地址 注意 可以 在 pe 模板 中 修改 该 值 将 修 改为 h 第四步 双击 运行 仅 弹出 第二个 对话框 三 熟悉 并 分析 pe 文件 的 引出 表 实验 内容 如下 熟悉 各类 pe 文件 格式 查看 和 编辑 工具 如 peviewstudpe 等 结合 helloexe 熟悉 pe 文件 头部 引入 表 的 结构 熟悉 函数 导入 的 基本原理 找到 系统 system 目 录下 的 userdll 文件 用 editor 打开 并 分析 该 文件 引出 表 找出 函数 messageboxa 的 地址 并 验证 该 地址 是否 正确 在 文件 中 的 引入 表 结构 在 内存 中 的 引入 表 结构 和 studpe 查看 文件 使用 peview 查看 文件 属性 peviewexe 工具 是 一款 可以 进行 pe 文件 解析 的 强大 pe 文件 解析 工具 通过 peview 软件 可以 分析 pe 文件 的 详细 格式 如 下图 所示 左边 是 相应 结构 右边 是 对应 的 数据 peview 虽然能 读写 pe 文件 的 数字化 模板 但 作者 更 推荐 使用 editor 编辑 imagebasepe 文件 在 内存 中 的 优先 装载 地址 rva 地址 相对 虚拟地址 它是 相对 内存 中 imagebase 的 偏移 位置 比如 pe 文 件头 imagentheaders 中 为 h 基 地址 为 h 下面 是 导入 表 信息 第一条 指令 在 内存 中 的 地址 计算方法 如 下图 所示 使用 studpe 查看 文件 属性 该软件 用于 显示 头部 dos 区段 函数 等 信息 包括 导入 表 导出 表 等 显示 对应 的 个 节 信息 显示 该 exe 程序 加载 的 两个 dll 文件 及 函数 寻找 函数 messageboxa 的 地址 userdll 是 windows 用户 界面 相关 应用 程序接口 用于 包括 windows 处理 基本 用户 界面 等 特性 这里 采用 peviewstudpe 方法 分析 找到 系统 system 目 录下 的 userdll 文件 用 editor 打开 并 分析 该 文件 引出 表 找出 函数 messageboxa 的 地址 并 验证 该 地址 是否 正确 第一步 使用 peview 打开 userdll 查找 messageboxa 的 rva 找到 系统 system 目 录下 的 userdll 文件 并 打 开在 addressofnames 数组 中找到 messageboxa 字符串 其 数组 序 号为 dd 在 ordinaltable 找到 序号 valuedd 项 data 为 dc 而 由于 ordinaltable 中 data 从 开始 故 在 addresstable 中找到 第 dc 即 dd 项 addresstable 中 dd 项 的 data 为 ea 也 即 messageboxa 的 rva 相对 虚拟地址 第二步 得到 rva 为 d 后用 studpe 打开 userdll 使用 raw 与 rva 转换 功能 得 其 va 为 dea 第三步 用 od 打开 helloexe 查看 messageboxa 两个 值 并不 一 致用 od 调试程序 的 时候 发现 其 va 地址 其实是 daf 与 计算出 的 dea 位置 有所 偏差 然后 查找 资料 发现 这 应该是 操作系统 处于 安全 原因 改 变了 真实 地址 之后 我 在 虚拟机 的 xp 环境 下 进行了 相同 的 实验 其 值 为 dea 完全一致 注意 userdll 来自 xp 操作系统 最终 得出结论 xp 之后 的 操作系统 对 真实 地址 做了 相关 的 保护 四 pe 文件 新增 对话框 实验 内容 是 手工 修改 helloexe 程序 使得 其 可以 弹出 第三个 对话框 提示框 标 题为 武汉 大学 信 安 病毒 实验 内容 为 你 的 姓名 日期 基本思路 为 修改 text 段 添加 messageboxa 的 函数 调用 修改 data 段 添加 messageboxa 的 参数 信息 修改 text 和 data 的 节 表 信息 第一步 使用 od 打开 目标 pe 文件 如 下图 所示 包括 第一个 对话框 第二个 对话框 和 退出 进程 第二步 修改 数据 区 datatitlerva 是 textrva 是 a 注意 从 下图 所示 的 位置 开始 修改 地址 为 需要 留 一个 字符 表示 截断 符 同样 title 和 text 之间 也 要用 隔开 右键 选择 二进制 gt 编辑 其 快捷键 为 ctrle 输入 标题 武汉 大学 信 安 病毒 实验 此时 标题 已经 成功 写入 接着 空 一个 从 下图 所示 位置 接着 写入 正文 内容 地址 为 a 接着 写入 内容 如 下图 所示 增加 内容 如 下图 所示 注意 现在 我们 只是 写入 内存 而 没有 写入 pe 文件 中 第三步 选中 新增 内容 右键 点击 复制到 可执行文件 此时 显示 如 下图 所示 成功 复制到 pe 文件 中 第四步 修改 代码 段 我们 需 要在 代码 段 第二个 对话框 之后 插入 新 的 数据 从而 弹出 第三个 对话框 需 要将 下图 阴影 部分 整体 后移 首先在 b 位置 进行 数据 跟随 数据 跟随 显示 如 下图 所示 代码 段 中 每个 弹 框 是 字节 从 开始 共计 两个 弹 框 接着 我们 将 退出 函数 的 所有 字节 复制 出来 为了 整体 后移 aeccffffcff 接着 空 字节 用于 填写 第三个 对话框 信息 将 复制 的 二进制 数据 粘贴 出来 ctrle 如 下图 所示 将 第一个 对话框 字节 代码 复制 至 第三个 对话框 如 下图 所示 第五步 修改 text 段 第二个 栈 的 参数 是 它 的 title 需 要将 偏移 地址 设置 为 对应 的 位置 右键 数据 窗口 中 跟随 gt 立即 数 第三个 窗口 标题 的 地址 修 改为 ctrle 修 改为 修改 第三个 窗口 text 地址 为 a 第六步 修改 call 对应 的 地址 注意 三个 对话框 call 对应 的 e 值 需 要以 usermessageboxa 为 基址 第一个 对话框 e 第二个 对话框 eca 第三个 对话框 e 修改 如 下图 所示 第七步 保存 文件 选择 复制到 可执行文件 gt 所有 修改 按钮 点击 全部 复制 最终 保存 修改 的 pe 文件 运行 pe 文件 成功 弹出 第三个 框 新增 的 内容 如 下图 所示 注意 检 查在 od 中所 做的 全部 修改 是否 保 存到 可执行文件 中 text 和 data 节 表 中 表示 节 实际 大小 的 字段 virtualsize 应该 做出 修改 但不 修改 文件 依然 能 正常 运行 五 总结 文章 写到 这里 就 介绍 完毕 本文 主要 讲解 pe 文件 解析 pe 编辑 工具 使用 和 pe 结构 修改 属于 系统安全 和 pe 逆向 相关 知识 希望 对 您 有所 帮助 内容 包括 pe 文件 基础 pe 文件 格式 解析 editor 解析 pe 文件 ollydbg 动态 调试程序 仅 弹出 第二个 窗口 熟悉 并 分析 pe 文件 的 引出 表 peview 和 studpe 查看 文件 寻找 函数 messageboxa 的 地址 pe 文件 新增 对话框 后续 将 学习 pe 文件 图标 修改 对话框 分析 exe 解析 加 壳 解密 等 希望 这 系列 文章 对 您 有所 帮助 同时 真的 感觉 自己 技术 好菜 要 学 的 知识 好多 未知 攻 焉知 防 人生 漫漫 其 路 远 兮 作为 初学者 自己 真是 爬着 前行 感谢 很多人 的 帮助 继续 爬着 继续 加油 欢迎 大家 讨论 是否 觉得 这 系列 文章 帮助 到 您 如果 存在 不足之处 还请 海涵 任何 建议 都可以 评论 告知 读者 共勉 逆向 分析 网络安全 学 安全 一年 认识了 很多 安全 大佬 和 朋 朋友 希望 大家 一起 进步 这篇 文章 中 如果 存在 一些 不足 还请 海涵 作者 作为 网络安全 和 系统安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 深知 自己 很菜 得 努力 前行 编程 没有 捷径 逆向 也没有 捷径 它们 都是 搬 砖 活 少 琢磨 技 巧干 就 对了 什么时候 你 把 攻击 对手 按在 地上 摩擦 你 就 赢了 也 会 慢慢 形 成了 自己 的 安全 经验 和 技巧 加油 吧 少年 希望 这个 路线 对 你 有所 帮助 共勉 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 ccfsci 南 核 北 核 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 星期 一夜 于 武汉 参考文献 武大 软件 安全 课程 师姐 ppt 师弟 师妹 ppt 及 视频 pe 文件 格式 分析 eriope 文件 学习 系列 一 为什么 是 peegojit 第二章 pe 文件 结构 解析 百度 文库 