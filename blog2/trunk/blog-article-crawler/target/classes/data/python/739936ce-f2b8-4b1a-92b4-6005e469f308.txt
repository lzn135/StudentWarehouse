性能 超越 gpu fpga 华人 学者 提出 软件 算法 架构 加速 ai 实时 化 作者 王 言 治 美国 东北大学 电子 与 计算机 工程系 助理 教授 出品 ai 科技 大本营 idrgznai 近年来 机器 学习 machinelearning 领域 的 研究 和 发展 可谓 是 与日 俱 新 各式各样 与 机器 学习 相关 的 研究成果 与 应用 层出不穷 如 图像识别 自动驾驶 语音 识别 等 机器 学习 能够 处理 的 任务 也 愈发 的 复杂 但 与此同时 新 的 问题 也 随之而来 机器 学习 模型 变得 更加 庞大 复杂 因 实时 性 而对 算 力 所 产生 的 需求 也 远远 超乎 了 我们 的 想象 这一 问题 严重 阻碍 了 人工智能 ai 产品 及 应用 融入 到 人们 的 日常 生活 中 因此 亟待解决 谷歌 微软 亚马逊 华为 和 苹果 等 科技 巨头 以及 众多 初创 公司 每年 都会 花费 数以亿计 的 经费 来 研发 机器 学习 专用 硬件 加速器 他们 希望 能够 早日 在 边缘 设备 edgedevice 与 物 联网 设备 iotdevice 上 实现 人工智能 应用 的 部署 并将 人工智能 真正 的 带入 到 人们 的 生活 中 现今 全球 有 不少于 家 的 ai 芯片 初创 公司 各种 新 硬件 层出不穷 从 重塑 可编程 逻辑 和 多核 设计 到 开发 自己 的 全新 架构 再到 使用 神经 形态 架构 等 此外 我们 还看 到了 诸如 英特尔 以 极其 高昂 的 价格 收购 了 和 alteranvidia 在 自动驾驶 处理器 方面 花 费了 大笔 的 开销 谷歌 开 发了 tpu 各家 公司 都 试图 都在 硬件 上 抢占 先机 这里 我们 不难 发现 工业界 目前 的 认知 是 硬件 才是 真正 制约 移动 ai 发展 的 主要因素 他们 缺乏 对于 软件 以及 目 前所 使用 的 通用 芯片 的 计算 资源 及 计算 能力 的 信任 因此 相较 于 软件 他们 将 注意力 更多 地 放在 了 开发 机器 学习 和 推理 专用 的 硬件 加速器 上 但是在 如此 巨大 的 资金 注入 下到 目前为止 硬件加速 仍 成效 甚微 我们 尚未 看到 任何 边缘 ai 硬件 加速器 的 大规模 部署 这不 禁 令人深思 专用 硬件加速 真的 是 正确 的 道路 吗 软件 能否 成为 移动 ai 时代 的 主导 从 各大 公司 的 角度 来看 如果 想 要让 自家 的 ai 产品 或 应用 迅速 落地 抢占市场 设计 专用 的 芯片 或 硬件 显然 并不是 最优 选择 众所周知 芯片 以及 硬件 的 开发 成本 非常 高昂 且 开发 周期 漫长 并非 所有 公司 都可以 承受 若是 选用 第三方 提供 的 ai 加速 硬件 则 可能会 面临 诸如 成本 增加 兼容性 等 一系列问题 而 设计 专用 软件 则 不同 它 的 开发 成本 低廉 容易 实现 快速 部署 可以 做到 针对性 优化 且 通常 具有 完备 的 生态系统 从 大众 的 角度 来看 若想 让 ai 产品 或 应用 真正 融入 人们 的 日常 生活 那么 它 至少 需 具备 几个 特点 价格低廉 随时随地 方便快捷 价格低廉 就 不必 多 说了 很多 ai 产品 和 应用 都会 给 人们 的 生活 带来 更大 的 便利 但 这 更多 的 是 锦上添花 而非 必不可少 而 使用 专用 硬件 加速器 无疑 会 增加 产品 的 成本 所以 人们 究竟 会不会 为 这一 成本 增加 而 买单 究竟 可以 接受 的 尺度 有 多大 这 仍然是 个 未知数 目前 很多 ai 相关 应用 比如 最常 见 的 手机 语音 助手 智能 音 箱等 采取 的 模式 是 云端 计算 即 用户端 将 数据传输 给 云端 服务器 进行 运算 云端 再将 结果 传回 给 用户 这就 对 用户 所处 的 网络 环境 提 出了 要求 如果 ai 相关 运算 能在 例如 手机 音箱 等 边缘 设备 上 完成 那么 用户 就可以 不受 网络 环境 影响 随时随地 的 使用 ai 应用 试想 当你 在 地铁 上 看 高清 视频 由于 网络 信号 不好 高清 视频 数据传输 量 又大 导致 了 视频卡 顿 但 如果 在你 的 手 机上 能够 本地 运行 一个 实时 视频 超 分辨率 转换 的 ai 应用 那么 就可以 使用 低 清 分辨率 视频 源 进行 传输 从而 减少 卡 顿 此外 能够 方便快捷 的 使用 ai 应用 也是 至关重要 的 一环 由于 移动 支付 的 普及 很多人 出门 连 钱包 都 省了 只带 一个 手机 显然 随身携带 gpu 或 fpga 硬件 加速器 是 不现实 的 所以 无论 从 公司 的 角度 还是 大众 的 角度 来说 基于 软件 和 通用 计算 设备 比如 手机 的 ai 加速 无疑是 ai 应用 的 最佳 选择 那么 我们 不禁 要问 我们 能否 在 没有 特殊 硬件 加速器 的 普通 手机 或 其他 边缘 设备 上 克服 高 算 力 需求 将 各种 ai 应用 实时 化 呢 如果 真的 可以 那么 与 专用 硬件 加速器 相比 基于 软件 优化 和 普通 手机 的 实现 方式 性能 又 如何 呢 能不能 比 硬件 加速器 跑 的 还快 能量 效率 还高 呢 答案 是 肯定 的 近期 由 美国 东北大学 王 言 治 研究 组 威廉 玛丽 学院 任 彬 研究 组 和 北 卡 州立大学 慎 熙 鹏 研究 组 共同 提出 了 名为 cocopie 的 软件 算法 架构 通过 有效 的 压缩 编译 协同 设计 在 没有 特殊 硬件 加速器 的 情况下 使用 现有 边缘 设备 如 智能手机 依然 可以 实现 人工智能 的 实时 化 并且在 性能 上 超越 了 特殊 硬件 加速器 他们 还 坚信 ai 应用程序 的 软件 优化 潜力 仍未 得到 充分 开发 即使 在 移动 ai 时代 软件 仍然 将 占有 业界 的 主导地位 一旦 我们 可以 在数 十亿 现有 的 移动 设备 上 启用 实时 ai 那么 一个 拥有 万亿 美元 的 庞大 市场 将被 彻底 释放 他们 将 cocopie 架构 在 三星 galaxys 智能手机 上 的 性能 和 基于 asic 和 fpga 的 硬件 机器 学习 加速器 的 性能 进行了 对比 图 cocopie 架构 在 三星 galaxys 智能手机 上 与 专用 asic 解决方案 和 fpga 解决方案 的 性能 对比 对比 结果 总结 在上 图中 其中 图 abc 对 比了 cocopie 和 专用 asic 硬件 包括 google 的 云 tpuv 和 edgetpueyeriss 以及 在 性能 和 能 效 方面 的 表现 图 d 对 比了 cocopie 与 fpga 解决方案 ese 在 准确性 和 能 效 上 的 表现 为了 达到 公平 他们 使用 相同 的 网络 模型 进行 比较 并且 cocopie 未 采用 权重 量化 quantization 结果 显示 cocopie 在 能 效 方面 始终 优于 这些 代表性 的 asicfpga 解决方案 这种 独特 的 现象 归因于 三个 原因 智能手机 本身 具有 超高 的 能量 效率 智能 手机芯片 使用 最 先进 的 技术 例如 nmnm 技术 构建 而 fpgaasic 解决方案 则 基于 nm 或 nm 技术 这些 技术 本身 节能 效果 较差 同样 arm 移动 cpu 和 高 通 移动 gpu 尤其 擅长 高效 电路系统 设计 cocopie 可以 最大 限度 地 利用 这些 前人 的 成果 虽然 现有 的 移动 编译器 框架 对 不同 神经网络 的 支持 有限 例如 不支持 rnn 或 大规模 dnn 但 cocopie 可以 支持 所有 的 主流 神经网络 从而 释 放了 移动 设备 的 全部 潜力 由于 基于 软件 的 解决方案 具有 高度 的 灵活性 因此 cocopie 在 不同 的 dnn 上 始终保持 高性能 相反 当前 的 asicfpga 解决方案 通常 针对 特定 的 dnn 类型 大小 进行 优化 从而 影响 其 通用性 具体 而言 边缘 tpu 通常 针对 小型 dnn 优化 而 云端 tpu 通常 针对 大型 dnn 优化 他们 利用 cocopie 框 架在 一台 普通 的 三星 galaxys 手 机上 实现 了 多种 具有 代表性 的 ai 应用 并 成功地 做 到了 可 实时 比 如图所示 的 风格 转换 视频 上色 以及 超 分辨率 应用 全部 达 到了 实时 运行 标准 每秒 不小于 帧 此外 他们 还在 手 机上 成功 实现 了 更具 挑战性 的 ai 应用 包括 基于 yolov 的 物体 检测 以及 基于 d 卷积 的 行为 识别 并且 分别 达 到了 帧 每秒 和 帧 每秒 如图所示 更多 的 演示 视频 请 参考 下面 的 网址 站 图 利用 cocopie 框架 在手 机上 实现 的 实时 ai 应用 包括 实时 风格 转换 实时 视频 上色 实时 超 分辨率 图 利用 cocopie 框架 在手 机上 实现 物体 检测 以及 d 行为 识别 除了 cnn 网络 他们 还在 rnn 上 与 fpga 硬件 加速器 ese 和 clstm 做了 对比 如图所示 即使 cocopie 不 使用 任何 量化 技术 cocopie 当 压缩率 高于 倍 时 有着 与 ese 相同 的 推理 时间 ese 为 us 而 cocopie 的 gpu 能量 效率 比 ese 高 将近 倍 比 clstm 高 近 倍 因为 与 ese 的 查找 表 激活 算法 相比 cocopie 的 编译器 优化 显著 提高了 并行性 和 内存 性能 而 ese 的 查找 表 激活 算法 导致 了 有限 的 并行 化 和 不规则 的 内存 访问 clstm 则 存在 两个 不容忽视 的 问题 一是 识别 能力 不高 二是 无法 利用 手机 gpu 的 并行 节能 运算 模式 而 cocopie 框架 可以 同时 确保 高 识别率 高能量 效率 多 平台 执行 图 对于 rnn 模型 googlelstm 网络 cocopie 架构 使用 三星 galaxys 手机 的 cpugpu 上 与 专用 与 fpga 硬件 加速器 ese 和 clstm 的 性能 对比 他们 还将 cocopie 的 测试 结 果与 现有 的 加速 框架 进行了 对比 由于 这些 框架 缺乏 像 cocopie 所 使用 的 压缩 编译 协同 设计 方法 他们 的 性能 不如 cocopie 图为 cocopie 与 tflitetvm 以及 mnn 加速 框 架在 普通 的 三星 galaxys 手机 的 cpu 和 gpu 上 的 性能 对比 s 拥有 最新 的 高 通 骁 龙 移动 平台 包 含了 高 通 kryo 核 cpu 和 高 通 adreno 移动 gpu 结果 显示 在所 有 情况下 cocopie 都 超越 了 其它 的 加速 框架 图 cocopie 与 tflitetvm 以及 mnn 加速 框架 的 性能 对比 cocopie 架构 中使 用了 两个 关键技术 来 实现 ai 应用在 手机 端 的 加速 即 模型 压缩 与 编译器 优化 模型 压缩 技术 主要 分为 两类 剪枝 pruning 量化 quantization 剪枝 技术 意在 删除 模型 中 冗余 的 权 重来 减少 权重 的 存储量 和 计算 量 而 量化 技术 意在 降低 权重 的 精度 来 减少 存储 和 加快 计算速度 在 cocopie 架构 中 他们 新 提 出了 卷积 核 模式 剪枝 和 连通性 剪枝 以 便在 不 损失 准确性 的 情况下 实现 更高 的 剪枝 倍率 和加 速 效果图 cocopie 压缩 编译 架构 在 编译器 优化 方面 cocopie 主要 使 用了 以下 技术 压缩 权重 存储 压缩 权重 存储 格式 是 专门 为 cocopie 中 使用 的 卷积 核 模式 和 连通性 剪枝 设计 的 卷积 核 与 输出 通道 重排 结合 后 这种 紧凑 的 数据结构 比 传统 的 csr 压缩 稀疏 行 格式 能够 产生 更好 的 压缩率 消除 负载 冗余 通过 在 内核 执行 代码 生成 过程中 通过 分析 处理 两个 寄存器 级 负载 冗余 问题解决 了 基于 卷积 核 模式化 剪枝 对 内存 性能 的 挑战 在 内存 和 缓存 之间 的 数据 移动 已 通过 高级 数据 平铺 技术 进行了 优化 的 前提下 这种 负载 冗余 消除 有着 更加 重要 的 意义 参数 自动 调整 参数 自动 调整 专门 测试 关键 性能参数 的 不同 配置 包括 将 数据 放置 在 各种 gpucpu 存储器 上 不同 的 数据 平铺 大小 以及 每个 处理 单元 上 每个 dnn 层 的 循环 置换 的 策略 从而 为 生成 最优 的 模型 执行 代 代码 扫 清了 障碍 总而言之 压缩 编译 协同 设计 方法 允许 编译器 将 剪枝 后 的 内核 视为 特殊 模式 不仅 可以 实现 模型 的 高精度 与 高 压缩率 还 可以 有效地 将 卷积 核 模式 转 换为 性 能上 的 提升 结语 由此看来 工业界 所 争相 追逐 的 硬件 加速器 是否 真是 ai 发展 的 决定性 因素 依然 有待 商榷 cocopie 作为 一个 很好 的 例子 向 我们 证明了 我们 还是 可以 在 现有 的 商业 计算 设备 上 实现 ai 并且 提供 甚至 比 专业 的 ai 硬件 加速器 更高 的 加速 效果 以及 能量 效率 这 能够 扩展 ai 在 边缘 计算 设备 上 的 能力 并且 改变 人们 对 终端设备 上 实现 实时 ai 就必须 采用 专业 的 特殊 ai 硬件 的 认知 ai 应用 的 软件 优化 潜力 仍未 得到 充分 开发软件 依然 可能 成为 ai 时代 的 业界 主导 无需 专业 硬件 加速器 cocopie 压缩 编译 协同 设计 软件 算法 方案 可以 在数 十亿 的 现有 的 移动 设备 以及 数 万亿 的 大有可为 的 物 联网 设备 上 快速 实现 多种 ai 应用 的 实时 化 以及 部署 产生 巨大 的 商业价值 本文 的 技术 详情 请见 该文 涵 盖了 完整 的 cocopie 的 概览 以下 网站 展示 了 cocopie 在 现有 的 移动 设备 上 实现 各种 实时 功能 的 视频 分辨率 提升 b 站 作者简介 王 言 治 是 美国 东北大学 电子 与 计算机 工程系 助理 教授 他 在 清华 电子系 和南 加州大学 拿到 本科 和 博士学位 他 的 主要 研究 方向 是 深度 神经网络 的 加速 与 安全性 他们 的 cocopie 压缩 编译 协同 优化 框架 可以 实现 大多数 神经网络 在 移动 端 的 实时 推理 他 的 文章 广泛 发表于 各个 顶 会 顶 刊 包括 机器 学习 方向 等 电路 与 设计 自动化 方向 等 计算机 系统 方面 等他 的 文章 引用 超过 次 得过 等 研究 奖项 得过 项 最佳 论文 奖 另外 次 提名 多次 设计 竞赛 奖项 他 的 研究工作 被 媒体 广泛 报道 和 引用 超过 次 他 的 多位 学生 已经在 各个 学校 担任 教职 包括 康涅狄格 大学 克 莱姆 森 大学 等 工作单位 包括 谷歌 脸 书 腾讯 滴滴 超新星 员工 更多 精彩 推荐 github 多次 霸 榜 两个月 拿下 star 他 说 基础 软件 不 开源 必死无疑 达摩 院 nlp 团队 斩获 六项 世界冠军 背后 让 ai 没有 难懂 的 语言 万字 长文 总结 机器 学习 的 模型 评估 与 调 参 附 代码 下载 你 一行 代码 有 多少 漏洞 科普 定义 eth 中 的 验 证者 质量 