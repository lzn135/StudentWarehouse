系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 系统安全 系列 作者 将 深入研究 恶意 样本 分析 逆向 分析 攻防 实 战和 windows 漏洞 利用 等 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 前文 作者 先 带领 大家 学习 什么 是 逆向 分析 这篇 文章 将 继续 普及 逆向 分析 基础知识 告诉 大家 如何 学好 逆向 分析 并 结合 作者 经验 给出 逆向 分析 的 路线 推荐 最后 给出 吕布 传 游戏 逆向 案例 该 篇文章 也是 作者 学习 科 锐 钱 林 松 老师 在华 中 科技大学 的 分享 视频 这里 非常 推荐 大家 去 看看 话 不 多说 让我们 开始 新 的 征程 吧 您 的 点 赞 评论 收藏 将是 对 我 最大 的 支持 感恩 安全 路上 一路 前行 如果有 写得 不好 的 地方 可以 联系 我 修改 基础性 文章 希望 对 您 有所 帮助 作者 的 目的 是 与 安 全人 共同进步 加油 文章 目录 一 如何 学好 软件 逆向 技能 软件 逆向 前沿 逆向 技能 学习 路线 二 安全 系列 书籍 及 工具 推荐 三 吕布 传 游戏 逆向 分析 四 总结 作者 的 github 资源 系统安全 网络安全 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 参考文献 见 后 一 如何 学好 软件 逆向 技能 软件 逆向 前沿 怎么 学好 软件 逆向 技能 呢 钱 老 师说 软件 逆向 属于 搬 砖 活 哈哈 的确 任何 技术 任何 学科 方向 都是 在你 刚开始 参与 实际工作 时会 觉得很 好玩 当你 做 多了 之后 就会 觉得 它是 搬 砖 活 你 刚开始 接触 它会 觉得 是 技巧 如果 你 每天 都 靠 这个 吃饭 就 不再是 技 巧了 在 逆向 分析 中 很多人 都 会去 网上 学习 脱壳 之类 的 教程 会教 你 在 哪个 地方 下 断 点按 几下 fff 后 就 到了 指定 位置 然后 右键 脱壳 这一 系列 操作 是 大师 多年 的 经验 积累 你 可能 学 会了 这个 最 简答 的 方案 却不 理解 具体 的 原理 第一个 提出 方案 的人 他 需要 走过 这个 壳 各种各样 的 坑 才会 形成 这个 所谓 的 技巧 它就 是为了 节约 时间 和 人力 成本 无数次 重复 工作 且不 影响 质量 的 解决方案 这种 最优 解决方案 提供给 新人 看 的 时候 他 会 觉得 充满了 技巧性 或 不理解 但 大家 在 学习 逆向 分析 的 时候 还是 少 琢磨 技 巧干 就 对了 市面上 会有 各种各样 的 工具 比如 脱壳 你 需要 先去 学 会写 壳 写好 壳 才会 觉得 壳 有 多么 的 脆弱 我 的 程序 里 到处 都有 bug 如果 别人 触 发了 程序 的 某个 点我 的 壳 可能 就 会被 摧毁 同时 还 有人 会 研究 反 调试 甚至 汇 编出 反 调试 技巧 十几 则 你 为什么 发现 不 了 呢 为什么 不能自己 总结 一个 呢 只要 你 自己 写 一个 调试器 就会 出现 很多 方案 当你 写完 一个 调试器 之后 你 会 发现 调试器 也 很 脆弱 一不小心 某个 样本 就 会把 你 的 调试器 给 弄 奔 溃 那么 一旦 你 找到 样本 规律 对于 你 的 调试器 而言 就是 一种 反 调试 所以 如果 你 只是 学习 网上 别人 的 脱壳 反 调试 技巧 这是 没用 的 你 需 要去 深入 实践 和 理解 然后 总结 属于 自己 的 技巧 对于 对抗 行业 而言 它是 没有 一点 侥幸 而言 你 能把 对手 按在 地上 摩擦 你 就算 赢了 同样 很多 时候 我们 只 看到 安全 分析 人员 光鲜 的 一面 只 看到 最后 几秒钟 那个 补丁 攻击 的 厉害 却不 知道 分析 人员 已经 被 这个 壳 调试 折磨 得 不行 反复 躺 坑 最终 才能 解决 所以 对抗 考验 的 是 人 的 任性 和 基本功 任性 信念 支撑 基本功 写 代码 读 代码 基本功 很 重要 网上 现在 三天 学会 脱壳 两天 学会 反 调试 之类 的 教程 很多 我们 需要 却是 基本功 比如 我们 在 扫雷 逆向 分析 时 关于 ollydbg 的 教程 也 非常 多 它们 详细 讲解 每个 功能 干什么 这些 功能 其实 都可以 简略 学习 我们 需要 做的 是 把 下图 所示 的 反汇编 窗口 的 代码 搞 明白 就 ok 了 这些 自动化 工具 可能 不是 很熟悉 只是 工作效率 慢点 但 换个 角度 如果 od 工具 中 的 每个 功 能及 快捷键 你 都 会用 但是 反汇编 窗口 的 代码 看不懂 那你 不就 废 了吗 所以 大家 的 注意力 应该 放到 反汇编 窗口 同样 对于 ida 静态 分析 也是 一个 道理 它也 有 很多 的 功能 但 我们 的 重点 其实 还是 代码 窗口 因为 搞 安全 的人 会 遇到 很多 资料 归纳 学习 总结 是 必备 的 技能 通过 训练 是 可以 培养出来 的 它能 帮助 你 快速 的 找到 重点 所以 技巧 不是 决定性 因素 逆向 分析 人员 真正 拼 的 是 基本功 那么 如何 学好 编程 语言 或 逆向 分析 呢 不要 这样 学习 只 看书 不 上机 只 运行 不 调试 只 做 课后练习 不做 工程项目 应该 这样 学习 多 敲 代码 重要 实战 程序 不是 写出来 的 是 调出来 的 根据 自己 的 兴趣 或者 市场 的 需要 多做 一些 有 一定 规模 的 项目 逆向 分析 底层 推荐 的 三门 课程 数据结构 操作系统 编译 原理 逆向 的 理论知识 课程 想要 逆向 反汇编 还原成 高级 代码 就需要 对 编译器 有 一定 了解 否则 只能 去看 别人 公布 的 技巧 比如 操作系统 课程 你 能不能 做一个 小型 的 操作系统 出来 呢 编译 原理 你 能不能 找到 开源 的 编译器 看看 词法 分析 语法分析 的 源代码 写点 注释 呢 年 之前 钱 老师 是 玩 黑客工具 的 但 后来 发 现学 不到 本质 学 的 都是 技巧 而 技巧 是 有 时效性 的 所以 想 学好 还得 研究 其本质 并且 逆向 分析 底层 的 知识 很少 更新 而 上层 技术 更新 较快 逆向 技能 学习 路线 在校 可以 做 哪些项目 准备 呢 关注 网络 社区 参与 技术 讨论 推荐 看 雪 论坛 搜索 安全 公司 招聘 信息 了解 技能 要求 逆向 技能 表 针对性 开发 实际 项目 科 锐 逆向 公司 在看 雪 分享 的 逆向 资料 推荐 大家 去 学习 下 逆向 并 公开 ollydbg 的 原理 逆向 并 公开 xp 版 createprocess 的 原理 及 流程 分析 逆向 并 公开 winx 版 createprocess 的 原理 及 流程 分析 逆向 并 公开 xp 版 原理 及 流程 分析 逆向 工程 技能 树 下面 给出 软件 逆向 工程 的 技能 表 包括 提前 知识 基础 技能 开发 技能 逆向 技能 学习 书单 和 实践 项目 基础 技能 包括 汇编语言 c 语言 c 语言 数据结构 至 少得 学 一个 低级语言 和 高级 语言 然 后会 一个 面向对象 语言 重点是 数据结构 开发 技能 逆向 分析 需要 懂 开发 开发 至少 需要 了解 一个 操作系统 平台 的 编程 可以 选择 windows 或 linux 如 windowssdk 编程 然后 至少 了解 一种 框架 java 框架 微软 mfc 等 同时 需要 懂 网络 编程 sockettcphttp 等 有空 可以 了解 下 设计 模式 学习 设计 模式 前 需要 有 项目 经验 因为 阅读 大型项目 代码 时会 遇到 然后 数据库 是 必 须要 学习 的 技能 非常重要 在 数据库 学习 中 大家 应该 好好学习 下 数据 关系 理论 范式 集合 等 而 大家 可能 更 关注 后面 的 sql 语句 为什么 呢 因为 语句 是 可能 变化 的如 neoj 和 mysql 不同 而 关系 理论 一直 在那里 同时 我们 的 操作系统 也 可以 理解为 一个 专用 型 数据库 它 的 职责 是 管理 和 分配 硬件 资源 的 比如 我们 的 系统 有 个 以上 进程 在 跑 一 个位 进程 的 理论 地址 空间 假设是 g 这就 需要 g 的 内存 那 怎么 解决 这个 问题 呢 通过 数据 关系 可以 解决 微软 的 操作系统 都用 到了 数据 关系 都会 建 表 和 主外 键 从而 避免 空间 的 无故 或 重复 占用 逆向 技能 逆向 技能 比较 偏 实战 windows 逆向 包括 ollydbgpe 文件 格式 ida 使用 windows 内核 驱动 开发 核心 操作系统 android 逆向 包括 baksmaildex 文件 格式 linux 内核 nix 操作 等 学习 书单 主要 推荐 编程 语言 开发 数学 基础 数学 结构 与 算法 操作系统 编译 原理 软件 分析 工具 及 参考手册 等 书籍 数学 基础 也 非常重要 但 我们 逆向 以 应用 为主 数学 简单 了解 就好 实践 项目 这里 给出 一些 推荐 的 开发 项目 和 逆向 项目 供 大家 学习 感觉 难度 都 不小 由于 作者 开发 类 的 项目 很多 都做 过所 以 后面 只会 详细 讲解 一个 远 控 软件 的 实现 过程 更 多是 系统 学习 和 分享 逆向 项目 远 控 软件 对 我们 分析 木马 有 帮助 cad 软件能 帮助 我们 分析 c 程序 调试器 能 辅助 反 调试 pe 分析 工具 帮助 对 pe 文件 格式 的 理解 逆向 项目 更是 直观 地 提升 逆向 分析 能力 下面 是 推荐 的 一些 项目 以及 作者 的 完成 情况 这些年 确实 学得 很杂 o o 编写 一个 小游戏 如 俄罗斯方块 五子棋 贪吃蛇 坦克 年 大二 完成 坠 梦 等 多款 游戏 编写 一个 远 控 软件 支持 pcandroid 年 大四 毕 设 已 完成 编写 一个 cad 支持 图形 编辑 图像 变换 存储 年 大三 图形学 课 完 成年 完成 android 端 编写 一个 调试器 编写 一个 小型 操作系统 年 大三 小 学期 c 实现 u盘 操作系统 编写 一个 任务 管理器 可 以对 进程 线程 等 程序 活动 进行 监控 年 大四 毕 设 已 完成 编写 一个 网络 聊天室 支持 多人 聊 天年 研 一 python 实现 编写 一个 pe 分析 工具 做一个 针对 windows 扫雷 的 作弊 程序 年 博 一 完成 分析 一个 rpg 游戏 存档 并 写 程序修改 存档 年 大三 完成 仙剑 存档 器 通过 注入 方法 为 windows 计算机 添加 一个 菜单 程序 选项 通过 注入 内联 钩子 实现 对 指定 程序 api 监控 详细 逆向 分析 一个 典型 的 病毒 和 机理 完 成年 wannacry 蠕虫 分析 不用 编译器 只 借助 十六进制 编译器 可以 手写 一个 编译器 从 内存 中 durmp 出 某 应用程序 并 修复 导入 表 等 消息 尝试 pj 看 雪 论坛 crakeme 模块 的 各 crakeme 习题 年 正在 进行中 结合 安全 机理 找到 安全漏洞 并 提交 cve 漏洞 报告 二 安全 系列 书籍 及 工具 推荐 作为 安全 初学者 我 结合 自己 和 小伙伴 们 的 经验 简单 给 大家 推荐 下 网络安全 系统安全 和 人工智能 三个 方向 的 书籍 以及 相关 技术 工具 希望 大家 喜欢 首先 推荐 如下 书籍 这些 都是 我 读过 或 正在 学习 的 都还 不错 网络安全 白 帽子 讲 web 安全 web 前端 黑客技术 揭秘 xss 跨 站 脚本 攻击 剖析 与 防御 web 攻防 业务 安全 实战 指南 内网 安全 攻防 渗透 测试 实战 指南 安全 之路 web 渗透 技术 及 实战 案例 解析 黑客 攻防 技术 宝典 浏览器 实战篇 网络 攻防 实战 研究 漏洞 利用 与 提 权 ctf 训练营 等 系统安全 加密 与 解密 恶意代码 分析 实战 windows 黑客 编程技术 详解 逆向 工程 权威 指南 软件 安全 windows 高级 编程 windowspe 权威 指南 idapro 权威 指南 android 软件 安全 与 逆向 分析 c 反汇编 与 逆向 分析 技术 揭秘 day 安全 软件 漏洞 分析 技术 等 人工智能 推荐 机器 学习 深度 学习 统计 学习方法 等 下图 是 作者 的 一些 书籍 感觉 还 挺多 的 建议 大家 一定 结合 实战 进行 阅读 坚持就是胜利 常见 安全 网站 及 论坛 看 雪 看 雪 论坛 是 个 软件 安全 技术交流 场 所为 安全 技术 爱好者 提供 一个 技术 交流平台 和 资源 国内 关注 度 最高 的 全球 球 互联网 安全 媒体 平台 爱好者 们 交流 与 分享 安全 技术 的 社区 吾爱 吾爱 pj 论坛 是 致力于 软件 安全 与 病毒 分析 的 非营利性 技术论坛 i 春秋 由 国内 网络安全 机构 永 信 至诚 打造 的 信息 安全 在线教育 平台 非常 多 的 在线 网络安全 资源 安全 客 提供 权威 信息 发布 的 漏洞 信息 发布 安全 资讯 分享 安全 知识 和 精彩 的 安全 活动 直播 先知 社区 一个 开放型 技术 平台 包括 非常 优秀 的 安全 技术文章 bilibili 网站 站 真的 提供 了 非常 多 的 各类 学习 资源 去 b 站 学习 安全 课程 真是 不错 的 选择 csdn 网站 全国 最大 的 编程 社区 可惜 安全 文章 比 较少 但 上面 有 正在 进步 的 我 哈哈 更 重要 也有 很多 不错 的 安全 分享 比如 冰河 谢 公子 等 作者 谋 篇文章 会 详细 总结 csdn 的 那些 白 帽子 微 信 公众 号 微 信 公众 号 也 提供 了 非常 便捷 的 安全 学习 环境 包括 很多 安全 资源 推荐 安全 gcow 谢 公子 看 雪 渗透 云 等 公众 号 安全 牛 安全 内参 绿 盟 阿里 聚 安全 网络安全 常用工具 推荐 如下 其中 加粗 字体 是 作者 学习 或 使 用过 的 优秀 工具 fiddler 网络 漏洞 扫描器 burpsuite 网络 漏洞 扫描器 nmap 端口 扫描器 nessus 漏洞 扫描 程序 wireshark 手动 分析 包 工具 sqlmap 渗透 测试 工具 metasploit 漏洞 监测 工具 cobaltstrike 渗透 测试 框架 hydra 密码 破 j 工具 acunetix 网络 漏洞 扫描 软件 pangolinsql 注入 测试 工具 ettercap 中间人 攻击 工具 maltego 取证 工具 owaspzed 攻击 代理 工具 caidao 网站 渗透 工具 中国 蚁 剑 网站 渗透 工具 冰 蝎 behinder 网站 渗透 工具 系统安全 分析 常用工具 推荐 如下 ollydbg 动态 分析 工具 倚天剑 idapro 静态 分析 工具 屠龙刀 windbg 微软 内核 级 调试 工具 peid 查 壳 工具 cuckoosandbox 开源 沙箱 系统 peviewpe 文件 查看 工具 editor 二进制 分析 监视 工具 processexplorer 文件 进程 查看器 cheatengine 内存 修改 编辑 工具 outpostfirewall 共享软件 hexeditor 十六进制 编辑 工具 ubertooth 蓝牙 嗅 探 工具 汇编语言 编译器 下面 分 享年 看 雪 安全 峰会 关于 攻击 检测 和 对抗 的 常见 技术 三 吕布 传 游戏 逆向 分析 下面 以 老 游戏 新 吕布 传为 例 这是 非常 老 的 一款 游戏 我们 在 玩 这个 游戏 的 时候 会 遇到 一个 问题 就是 npc 说话 太慢 在 不断地 过 剧情 我们 想 逆向 分析 让 它 迅速 完成 对话 加快 我们 游戏 的 进程 第一步 通过 ollydbg 软件 打开 吕布 传 游戏 ekdexe 第二 右键 点击 查找 选择 当前 模块 中 的 名称 查看 该游戏 打 开了 哪些 函数 返回 界面 如 下图 所示 包括 该游戏 需要 调用 的 各种 函数 并且 猜测 各种 函数 的 应用 场合 第三步 发现 两个 异常 函数 作者 在 游 戏中 设置 两个 钩子 函数 做什么 呢 难道 想 检测 我们 的 键盘 吗 卸载 钩子 消息 函数 安装 钩子 消息 函数 ps 这些 分析 经验 需要 我们 不断地 实践 来 总结 这是 一个 大量 反复 训练 的 过程 目前 作者 也 还在 学习 的 过程 一起 加油 第四步 选中 该 函数 右键 点击 在 每个 参 考上 设置 断点 可以 看到 已经 设置 了 两个 断点 第五步 运行 程序 或 双击 断点 可以 进入 反汇编 窗口 具体位置 可以 看到 它是 一个 键盘 钩子 并且 回 调 函数 为 第六步 双击 回 调 函数 那行 复制 地址 d 输入 ctrlg 跟 随到 指定 位置 第七步 再 跳转 的 地址 xd 位置 按 下 f 增加 新 的 断点 第八 步 按 下 f 运行 程序 并 进入 对话 界面 第九步 按 下 某个 按键 我们 来 详细分析 这段 汇编 代码 作者 按 下 的 是 数字 其 输出 结果 存储 在 eax 寄存器 中 对应 的 十六进制 为 x 然后 它会 检测 我 按键 的 ascii 码 是否 等于 x 空格 cmpeax 第 十步 给 该 位置 xda 下个 断点 继续 运行 和 分析 代码 当 输入 空格 相等 后 它会 比较 一个 全局变量 的 值 是否 为 然后 进入 新 的 运行 代码 进入 call 函数 然后 去到 xa 位置 如 下图 所示 发现 它 开启 了 一个 线程 我们 接着 需要 定位 到 线程 的 处理 函数 第 十 一步 按 下 ctrlg 跟 随到 xaf 位置 接着 分析 汇编 代码 给 该 位置 下个 断点 然后 分析 该 函数 内容 发现 它 首先 比较 状态 如果 状态 为 就 设置 个 wmlbuttondown 消息 即 点击 鼠标 然后 间隔 一个 sleep 函数 时间 为 毫秒 接着 又 设置 一个 up 消息 相当于 左键 按 下 后又 弹起 来了 写到 这里 我们 发现 空格 的 效果 就是 反复 按 下 鼠标 左键 又 弹起 右键 原来 该游戏 已经 自 带了 过 场景 的 功能 就是 按 下 空格 哈哈 但是 该游戏 的 说明书 并没有 讲述 这个 按键 的 情况 相当于 一个 隐藏 功能 这里 大家 也 可以 进一步 修改 制作 游戏 辅助 器 这里 主 要是 带领 大家 来 学习 下 游戏 逆向 的 过程 尤其是 od 工具 的 基础 用法 总之 如果 你 喜欢 逆向 分析会 非常 有意思 包括 玩游戏 也 会 从 另一个 角度 思考 但 如果 你 不喜欢 逆向 千万别 进 这个 行业 每天 逆向 代码 看到 想 吐 可以 换个 喜欢 的 行业 因为 逆向 分析 工作 就是 每天 泡在 代码 堆 里 四 总结 写到 这里 这篇 文章 就 介绍 完毕 希望 对 您 有所 帮助 最后 进行 简单 的 总结 下一 如何 学好 软件 逆向 技能 软件 逆向 前沿 逆向 技能 学习 路线 二 安全 系列 书籍 及 攻击 推荐 三 吕布 传 游戏 逆向 分析 学 安全 一年 认识了 很多 安全 大佬 和 朋友 希望 大家 一起 进步 这篇 文章 中 如果 存在 一些 不足 还请 海涵 作者 作为 网络安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 深知 自己 很菜 得 努力 前行 珈 国情 明月 千里 两 相思 清风 缕缕 寄 离愁 燕 归 珞 珈 花 已 谢 情 满 景 逸 映 深秋 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 by 娜 璋 ai 之家 eastmount 星期天 写 于 高 铁 参考文献 真心 推荐 大家好 好看 看 这些 视频 和 文章 感恩 这些 大佬 科 锐 逆向 的 钱 林 松 老师 受 华中 科技大学 邀请 逆向 分析 计算 引导 c 学习 笔记 vs 中 添加 graphicsh 头文件 行 歌 网络安全 自学 篇 五 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 网络安全 自学 篇 六 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 