系统安全 三 ida pro 反汇编 工具 初识 及 逆向 工程 解密 实战 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 系统安全 系列 作者 将 深入研究 恶意 样本 分析 逆向 分析 攻防 实 战和 windows 漏洞 利用 等 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 前文 作者 普及 了 逆向 分析 基础知识 告诉 大家 如何 学好 逆向 分析 并 给出 吕布 传 游戏 逆向 案例 这篇 文章 将 详细 讲解 idapro 反汇编 工具 的 基础 用法 并 简单 讲解 一个 exe 逆向 工程 解密 实战 方法 希望 您 喜欢 话 不 多说 让我们 开始 新 的 征程 吧 您 的 点 赞 评论 收藏 将是 对 我 最大 的 支持 感恩 安全 路上 一路 前行 如果有 写得 不好 的 地方 可以 联系 我 修改 基础性 文章 希望 对 您 有所 帮助 作者 的 目的 是 与 安 全人 共同进步 加油 文章 目录 一 idapro 工具 简介 及 初识 idapro 简介 idapro 新建 工程 二 idapro 工具 基本 用法 idaview 窗口 hexview 窗口 strings 窗口 文件 类型 三 idapro 逆向 工程 实战 代码 加密 逆向 解密 四 总结 作者 的 github 资源 系统安全 网络安全 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 参考文献 见 后 一 idapro 工具 简介 及 初识 idapro 简介 简称 ida 是 hexrays 公司出品 的 一款 交互式 反汇编 工具 是 目前 最 棒 的 一个 静态 反编译 软件 为 众多 day 世界 的 成员 和 shellcode 安全 分析 人士 不可 缺少 的 利器 idapro 具有 强大 的 功能 但 操作 较为 复杂 需要 储备 很多 知识 同时 它 具有 交互式 可编程 可 扩展 多处理器 等 特点 可以 通过 windows 或 linuxmacos 平台 来 分析 程序 被 公认为 最好 的 逆向 工程 利器 之一 idapro 已经成为 分析 敌意 代码 的 标准 并 让 其 自身 迅速 成为 攻击 研究 领域 的 重要 工具 它 支持 数十 种 cpu 指令集 其中 包括 等等 idapro 新建 工程 idapro 是 点击 下一步 傻瓜式 安装 安装 成功 会 后会 显示 两个 运行 程序 idapro bit 和 idapro bit 分别 对应 位 和 位 程序 的 分析 ida 支持 常见 的 pe 格式 等 平台 的 文件 格式 下面 讲解 首次 打开 idapro 的 流程 第一步 打开 idapro 软件 双击 exe 文件 弹出 如 下图 所示 的 supportmessage 界面 点击 ok 按钮 第二步 新建 一个 文件 ida 包括 三种 加载 文件 的 方式 其中 new 是 新建 打开 一个 标准文件 的 对话框 go 是 运行 打开 一个 空白 工作 用户 将要 分析 的 文件 拖入 分析 previous 是 选择 最近 一次 使 用过 的 文件 第三步 选择 一个 exe 文件 载入 它 将是 我们 要 进行 分析 的 程序 作者 通过 c 语言 写了 一段 代码 并在 本地 生成 一个 testexe 文件 它 就是 接下来 分析 的 可执行文件 printf helloworldn return 选 择要 导入 的 文件 第四步 装载 pe 文件 在 loadanewfile 窗口 中 选择 装载 pe 文件 包括 text 代码 块 data 数据 块 rsrc 资源 块 idata 输入 表 和 edata 输出表 等 也 可以 载入 二进制 文件 ida 反汇编 包括 两个 阶段 首 先将 程序 的 代码 和 数据 分开 分别 标记 函数 并 分析 参数 调用 跳转 指令 关系 等 接着 如果 ida 能 识别 文件 的 编译 类型 就 装载 对应 的 编译器 特征 文件 给 各 函数 赋 名 同时 ida 会 创建 一个 数据库 其 组件 分别 保 存在 ididnam 和 til 的 文件 里 接着 弹出 确认 窗口 可以 选择 选项 第五步 在 中 点击 ok 在 接下来 弹出 的 hexrays 信息 框 再 点击 ok 后会 要求 设置 更新 选项 这里 直接 点击 ok 默认 即可 第六步 显示 运行 结果 此时 运行 结果 如 下图 所示 接着 可以 开始 我们 的 逆向 分析 idaview 显示 如 下图 所示 hexview 十六进制 显示 如 下图 所示 下图 可以 看到 代码 中 的 helloworldn 第七步 查看 源代码 按 下 f 能够 查看 对应 的 源代码 第八 步 关闭 idapro 并 保存 数据库文件 保存 idb 数据库文件 至 本地 它 记 录了 用 idapro 对 该 程序 分析 中 的 工作 状态 包括 反汇编 分析 区段 扫描 用户 自定义 结构 用户 自定义 名称 注释 等 信息 点击 右上角 的 关闭 按钮 弹出 idapro 保存 数据库 窗口 savedatabase 使用 默认 选项 直接 点击 ok 即可以 保存 生成 数据库 idb 文件 下次 载 入时 可以 直接 加载 数据库文件 获取 之前 分析 的 状态 二 idapro 工具 基本 用法 idapro 工具 打开 的 主 界面 如 下图 所示 idaview 窗口 该 窗口 显示 如 下图 所示 它是 通过 点击 view 中 调出来 的 idaview 包括 两种 浏览 模式 一种 是 textview 一种 是 graphview 右键 能够 相互 跳转 如 下图 所示 变 换成 另一种 模式 idaview 主要 包括 三个 区域 地址 区 pe 文件 加 载到 内存 后 的 虚 地址 为准 镜像 地址 偏移 地址 如 xopcode 操作 区 该 部分 默认 因此 需要 设置 为 显示出来 它是 进制 数 反编译 代码 区 ida 主 功能 区域 能 高亮 显示 双击 函数 或 变量名 能 跳转 对应 的 地址 hexview 窗口 显示 进制 默 认为 只读 状态 可以用 快捷键 f 对 数据 区域 绿色 字符 区域 在 只读 和 编辑 两种 状态 切换 strings 窗口 ida 的 view 有 几个 按钮 对 定位 代码 很 重要 如 下图 所示 打开 导出 窗口 打开 导入 窗口 opennameswindow 函数 和 参数 的 命名 列表 程序 调用 的 所有 函数 窗口 打开 字符串 显示 窗口 这里 作者 点击 strings 显示 程序 中所 有 字符串 该 窗口 有助于 你 通过 程序 的 运行 输出 逆向 找出 对应 的 代码 片断 如 下图 的 字符串 及 对应 的 address 双击 string 跳转 iadview 页面 如 下图 所示 的 地址 单击 会 高亮 其他 窗口 导 出入 窗口 导出 窗口 列出 文件 的 入口 点 导入 窗口 列出 由 被 分析 的 二进制 文件 导入 的 所有 函数 函数 窗口 函数 名称 区域 起始 位置 长度 描述 函数 的 标记 结构 体 窗口 分析 数据结构 双击 数据结构 名称 展开 查看 详细 布局 枚举 窗口 enums 可列举 定义 枚举 类型 段 窗口 segmentation 段 的 简单 列表 文件 类型 ida 会 创建 一个 数据库 名为 idb 文件 它 由 四个 文件 组成 id 二叉树 形式 的 数据库 id 程序 字节 标识 namnamed 窗口 的 索引 信息 til 给定 数据库 的 本地 类型 定义 的 相关 信息 三 idapro 逆向 工程 实战 代码 加密 前面 第一篇 博客 讲解 音乐文件 通常 采用 异 或 加密 接下来 作者 通过 c 语言 简单 编 写了 一段 加密 代码 如下 所示 密钥 charright 正确 值 请 输入 正确 的 密码 printf scanf sampkey 判断 lenstrlen key if lenltlengt printf else 加密 for iiltleni resi keyinumi 异 或 加密 printf snres if strcmp resright printf elseprintf return 输入 长度 不在 之间 反馈 错误 输入 错误 反馈 正确 的 key 才 显示 正确 信息 接下来 我们 通过 idapro 工具 解密 这个 exe 文件 尝试 获取 key 值 逆向 解密 第一步 按照 第一 部分 步骤 向 idapro 中 导入 文件 显示 的 调用 程序 如 下图 所示 树形图 把 条件 分支 清晰 地 显示出 来了 左下角 有 ida 视图 的 缩略图 在上面 点击 可以 快速 定位 到 视图 的 指定 位置 并且 各个 部分 都有 详细 的 代码 信息 比如 定义 的 两个 变量 及 偏移 位置 第二步 查看 字符串 显示 窗口 idapro 工具 中 菜单栏 的 view 有 几个 按钮 对 定位 代码 很 重要 如 下图 所示 打开 导出 窗口 打开 导入 窗口 opennameswindow 函数 和 参数 的 命名 列表 程序 调用 的 所有 函数 窗口 打开 字符串 显示 窗口 这里 作者 点击 strings 显示 程序 中所 有 字符串 该 窗口 有助于 你 通过 程序 的 运行 输出 逆向 找出 对应 的 代码 片断 如 下图 的 字符串 及 对应 的 address 双击 string 跳 转到 如 下图 所示 的 地址 单击 会 高亮 第三步 查看 源代码 在 如 下图 所示 界面 中 按 下 f 键 可以 显示 源代码 显示 的 源代码 如下 所示 intcdeclmain printf scanf sstr vstrlen str if vgtampampvlt for iiltvi strcmp str printf elseprintf elseprintf return 注意 该 部分 代码 与 之前 写 的 c 语言 代码 略有不同 比如 之前 判断 长度 if lenltlengt 提示 错误 而 这里是 if vgtampampvlt 正确 执行 else 显示 错误 这段 代码 的 基本 逻辑 是 输入 字符串 str 然后 循环 与 gcccompiled 变量 异 或 加密 输出 为 str 变量 当 加密 后 的 str 变量值 为 则 解密 成功 否则 失败 那么 gcccompiled 变量 的 值 是多少 呢 第四步 定位 核心 代码 接着 选中 gcccompiled 变量 当 它 变 高亮 双击 之 后会 跳 转到 对应 的 页面 原来如此 它 的 密钥 是 eastmount 加密 结果是 第五步 逆向 解密 最后 撰写 解密 代码 实现 逆向 解密 eastmount 异 或 输入 代码 str 并且 值 等于 则 可以 成功 显示 密钥 charright 正确 值 判断 num for iiltleni resi rightinumi 异 或 加密 resiprintf return 解密 结果 如 下图 所示 注意 idapro 本地 创建 的 文件 如 下图 所示 四 总结 写到 这里 这篇 基础性 文章 就 叙述 完毕 安 全要 学习 的 知识 真的 很多 涉及面 很广 包括 汇编 网络 操作系统 加密 解密 ccpython 等 希望 自己 能 慢慢 进步 科研 与 实践 并重 也 希望 读者 喜欢 这 系列 总结 笔记 不 喜 勿 喷 与 你 同行 三 年前 你 在 敦煌 日出 前 写下 璋 娜 而 今天 我 写了 封 情书 作为 礼物 三张 薄纸 道 不出 无数 思恋 武汉 美 武大 更美 但我 知道 此行 的 目的 是 来 求知 来 充电 的 吾 家有 女 初 成长 早日 学成 团聚 才是 我 的 归属 深夜 写 的 博客 记录 今天 idapro 学习心得 一起 加油 今天 刚好 csdn 粉丝 破 十万 真心 感谢 大家 这些年来 的 陪伴 和 支持 感恩 认识 您也 希望 未来 能 继续 分享 更高 质量 的 文章 帮助 更 多人 入门 和 解决 为 题 寓教于乐 共勉 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 星期 四晚 上点 写 于 武汉 