转载 如 何用 python 发送 email 邮件 文章 目录 综述 连接 smtp 服务器 登录 smtp 服务器 如何 获得 邮箱 授权 码 通过 ssl 登录 smpt 服务器 发送 抄送 文本 邮件 密 送 文本 邮件 发送 html 邮件 参考 综述 用 代码 发送 email 在 很多 场景 下 都有 使用 需求 基本思路 是 代码 准备 好要 发送 的 内容 然后 连接 发送 邮箱 的 smtp 服务器 通过 smtp 服务器 将 email 发送 出去 比如 网站 服务器 定时 发送 解析 log 后 的 统计数据 给 维护 人员 定期 备份 的 数据库 并 通过 邮件 发送给 管理人员 企业 每个月 发 工资条 邮件 等等 这些 需求 很 常见 甚至 是 基本 需要 本文 介绍 如何 通过 python 代码 实现 发送 常用 的 文本 邮件 和 html 邮件 发送 其它 类型 的 邮件 以后 再说 smtp 的 全 称是 即 简单 邮件 传输 协议 smtp 协议 属于 tcpip 协议 簇 它 帮助 每台 计算机 在 发送 或 中转 email 的 时候 找到 下一个 目的地 smtp 服务器 就是 遵循 smtp 协议 的 发送 邮件 的 服务器 你 的 qq 信箱 gmail 或 hotmail 信箱 这些 公 网上 免费 的 email 服务 提供商 基本上 都会 提供 邮箱 的 smtp 服务 本文 会 介绍 如何 通过 python 代码 连接 这些 smtp 服务器 然后 发送 email 连接 smtp 服务器 连接 smtp 服务器 要 使用 python 标准 库 中 的 smtplib 模块 importsmtplib 本文 用 连接 qq 信箱 的 smtp 服务器 来 举例 下面 的 示例 代码 连接 qq 信箱 的 smtp 服务器 然后 什么 都 不干 发 一个 noopnoop 是 一个 命令 它 什么 都 不做 后 退出 smtpservernoop smtpserverquit 用来 创建 一个 smtp 服务器 对象 smtpserver 创建 时 指明 服务器 端口 超时 时间 可选 如果 超时 抛出 sockettimeout 异常 smtp 服务器 对象 的 setdebuglevel 函数 用来 设置 debug 信息 的 显示 级别 设置 后会 将与 smtp 服务器 交互 时 的 信息 往来 打印 出来 以上 代码 使 用了 参数 还可 以 使用 参数 即 区 别是 有 每条 交互 信息 的 时间 显示 而 没有 时间 显示 然后 代码 发了 一个 noop 操作 服务器 回应 ok 什么 都 不干 最后 使用 quit 函数 断开 连接 smtp 服务器 的 默认 端口号 是以 上 代码 也 可以 将 端口号 去掉 下面 是 另外 一种 连接 方式 使用 connect 函数 smtpsmtplibsmtp smtpconnect smtpqqcom smtpnoop smtpquit connect smtpqqcom connectto smtpqqcom msgbbye 默认 连接 的 是 smtp 服 务求 的 号 端口 使用 号 端口 有 一个 问题 就是 保密性 不够好 数据 都是 明文 传输 没有 加密 现在 一般 都 推荐 使用 的 smtplib 模块 支持 ssl 请看 下面 的 示例 代码 smtpnoop smtpquit msgbbye 这次 使用 的 是 smtpssl 函数 直接进行 连接 端口 是 默认 的 smtpoverssl 的 端口号 同样 端口号 可以 省略 登录 smtp 服务器 连接 上了 smtp 服务器 接下来 的 动作 是 登录 用你 自己 的 email 账户 登录 使用 login 函数 注意 没有 logout 函数 只有 quit 只有 成功 登录 才 可以 发送 邮件 smtpsmtplibsmtp smtpqqcom 此处 的 密码 不是 真实 的 邮箱 密码 而是 授权 码 smtplogin smtpquit 当 login 函数 使用 的 密码 为 你 的 邮箱 真实 密码 时 就会 出现 错误 需要 注意 的 是 此处 使用 的 不是 真实 密码 而是 邮箱 授权 码 如何 获得 邮箱 授权 码 参考 登陆 qq 邮箱 点击 设置 账户 step 找到 服务 点击 开启 smtp 服务 step 根据 提示 要求 发送 指定 短信 即可 获取 授权 码 当 填写 正确 的 授权 码 之后 代码 运行 结果 如下 msgbbye 通过 ssl 登录 smpt 服务器 smtpqqcom 此处 的 密码 不是 真实 的 邮箱 密码 而是 授权 码 smtplogin smtpquit 发送 抄送 文本 邮件 一封 email 邮件 不仅仅是 有 一些 字符串 组成 的 内容 它是 一个 结构 有 收件人 发件人 抄送 名单 邮件 主题 等等 要 组织 好 这样 一个 结构 我们 才能 发送 邮件 而 组织 email 邮件 内容 结构 的 任务 不属于 smtplib 模块 范围 我们 需要 用到 email 模块 标准 库 中 的 模块 提供 的 一些 工具 msgstrplainutf 发送 邮件 给 多 个人 抄送 邮件 encode smtpqqcom smtplogin smtpsendmail smtpquit 密 送 文本 邮件 密 送 就是 收件 人在 邮件 的 头部 to 和 cc 地址 看不到 自己 的 地址 但是 还是 收 到了 邮件 所有 to 和 cc 地址 中 的 收件人 都 看不到 密 送 地址 要 实现 密 送 只需 要在 sendmail 函数 中将 密 送 地址 加入 第 个 参数 的 list 即可 msgstrplainutf 发送 邮件 给 多 个人 抄送 邮件 encode smtpqqcom smtplogin smtpsendmail smtpquit 看上 面的 代码 注意 添 加密 送 地址 的 位置 toaddr 和 ccaddr 的 收件人 都不会 知道 bccaddr 的 存在 发送 html 邮件 在上 一节 中 基本上 已经 介绍 完了 python 发送 邮件 的 各项 基本技能 发送 html 邮件 只有 一个 细节 细节 与 上 一节 不同 就是在 创建 mimetext 对象 的 时候 使用 html 参数 msgstrhtmlutf 参考 