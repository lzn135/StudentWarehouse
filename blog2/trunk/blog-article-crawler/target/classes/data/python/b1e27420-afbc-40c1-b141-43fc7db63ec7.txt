cnvd-2020-10487 cve-2020-1938 tomcat ajp 文件 读取 漏洞 漏洞 简介 tomcat 服务器 是 一个 免费 的 开放源代码 的 web 应用服务器 属于 轻量级 应用服务器 在 中小型 系统 和 并发 访问 用户 不是 很多 的 场合 下 被 普遍 使 用是 开发 和 调试 jsp 程序 的 首选 由于 tomcat 默认 开启 的 ajp 服务 端口 存在 一处 文件 包含 缺陷 攻击者 可 构造 恶意 的 请求 包 进行 文件 包含 操作 进而 读取 受影响 tomcat 服务器 上 的 web 目录 文件 影响 范围 环境 搭建 之前 代码 审计 的 时候 安 装了 apachetomcat 还 存在 这个 漏洞 所以 索性 复现 一下 漏洞 这里 环境 搭建 很简单 去 官方网站 下载 tomcat 下载安装 就 好了 不会 随便 百度 一篇 文章 看看 笔者 这里 就不 多说 什么 了 漏洞 复现 骚 操作 rce 利用 大佬 hero 修改 poc 脚本 修改 成了 python 版本 增加了 rce 选项 会 使用 jsp 渲染 执行 文本 中 包含 的 命令 默认 读取 文件 模式 可以 配合 上传 漏洞 进行 漏洞 利用 命令 执行 一句话 ltoutprintln exec whoami getinputstream readline gt 利用 msf 反弹 shell 也是 需要 配合 上传 漏洞 漏洞 防护 如果 相关 用户 暂时 无法 进行 版本 升级 可根据 自身 情况 采用 下列 防护 措施 一 若不 需要 使用 tomcatajp 协议 可直接 关闭 ajpconnector 或 将其 监听 地址 改为 仅 监听 本机 localhost 具体操作 编辑 找到 如 下行 为 tomcat 的 工作 目录 将 此行 注释 掉 也 可 删掉 该行 保存 后 需 重新启动 tomcat 规则 方可 生效 二 若需 使用 tomcatajp 协议 可根据 使用 版本 配置 协议 属性 设置 认证 凭证 使用 tomcat 和 tomcat 的 用户 可为 ajpconnector 配置 secret 来 设置 ajp 协议 的 认证 凭证 例如 注意 必 须将 更 改为 一个 安全性 高 无法 被 轻易 猜 解 的 值 使用 tomcat 的 用户 可为 ajpconnector 配置 requiredsecret 来 设置 ajp 协议 的 认证 凭证 例如 注意 必 须将 更 改为 一个 安全性 高 无法 被 轻易 猜 解 的 值 文件 资料 下载 文中 所以 资料 都在 这里 链接 提 取码 xgs 参考 