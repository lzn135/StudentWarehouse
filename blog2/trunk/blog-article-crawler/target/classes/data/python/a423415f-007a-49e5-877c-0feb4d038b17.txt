系统安全 十五 chrome 密码 保存 功能 渗透 解析 chrome 蓝屏 漏洞 及 音乐 软件 漏洞 复现 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 作者 前面 详细 介绍 了 熊猫 烧香 病毒 的 逆向 分析 过程 这篇 文章 换个 主题 继续 介绍 本文 将对 chrome 浏览器 保留 密码 的 功能 进行 渗透 解析 同时 复现 一个 最近 流行 的 漏洞 通过 chrome 浏览器 实现 win 蓝屏 最后 介绍 音乐 软件 的 加密 功 能及 漏洞 复现 这些 基础 性知识 不仅 和 系统安全 相关 同样 与 我们 身边 的 app 常用软件 及 系统 紧密联系 希望 这些 知识 对 您 有所 帮助 更 希望 大家 提高 安全意识 开发 厂商 进行 相关 的 漏洞 修补 安全 保障 任重道远 从 年月 开始 我 来 到了 一个 陌生 的 专业 网络空间 安全 初 入 安全 领域 是 非常 痛苦 和 难受 的 要 学 的 东西 太多 涉及面 太 广 但 好在 自己 通过 分享 篇 网络安全 自学 系列 文章 艰难 前行 着 感恩 这一 年 相识 相知 相 趣 的 安全 大佬 和 朋友们 如果 写得 不好 或 不足之处 还请 大家 海涵 接下来 我 将 开启 新 的 安全 系列 叫 系统安全 也是 免费 的 篇文章 作者 将 更加 深入 的 去 研究 恶意 样本 分析 逆向 分析 内网 渗透 网络 攻防 实战 等 也 将 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 加油 推荐 前文 网络安全 自学 篇 系列 篇文章 目录 一 chrome 浏览器 密码 保存 功能 解析 chrome 密码 保存 功能 密码 元素 定位 密码 提取 复现 chrome 浏览器 密码 存储 机制 安全 建议 二 chrome 致 win 蓝屏 漏洞 复现 三 音乐 软件 漏洞 复现 四 总结 作者 的 github 资源 逆向 分析 网络安全 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 系统安全 四 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 系统安全 五 ollydbg 和 cheatengine 工具 逆向 分析 植物 大战 僵尸 游戏 系统安全 六 逆向 分析 之 条件 语句 和 循环 语句 源码 还原 及 流程 控制 系统安全 七 逆向 分析 之 pe 病毒 原理 c 实现 文件 加解密 及 ollydbg 逆向 系统安全 八 windows 漏洞 利 用之 cve 复现 及 蓝屏 攻击 系统安全 九 windows 漏洞 利 用之 ms 远程 代码 执行 漏洞 复现 及 深度 提 权 系统安全 十 windows 漏洞 利 用之 smbv 服务 远程 代码 执行 漏洞 cve 复现 系统安全 十一 那些 年 的 熊猫 烧香 及 pe 病毒 行为 机理 分析 系统安全 十二 熊猫 烧香 病毒 ida 和 od 逆向 分析 上 病毒 初始化 系统安全 十三 熊猫 烧香 病毒 ida 和 od 逆向 分析 中 病毒 释放 机理 系统安全 十四 熊猫 烧香 病毒 ida 和 od 逆向 分析 病毒 释放 过程 下 系统安全 十五 chrome 浏览器 保留 密码 功能 渗透 解析 蓝屏 漏洞 及 某 音乐 软件 漏洞 复现 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 该 样本 不会 分享 给 大家 分析 工具 会 分享 参考文献 见 后 一 chrome 浏览器 密码 保存 功能 解析 chrome 密码 保存 功能 大家 可能 都 见过 浏览器 保存 密码 的 功能 那么 chrome 浏览器 是 如何 存储 这些 用户名 和 密码 呢 它 是否 也 不安全 呢 我们 以 chrome 浏览器 为 例 进行 安全 测试 知识 普及 首先 打开 密码 管理器 设置 gt 高级 gt 密码 或者 输入 然后 我们 查看 某个 网站 的 密码 所幸 chrome 浏览器 对 显示 的 密码 进行了 一道 验证 需要 输入 正确 的 电脑 账户 密码 才能 查看 如 下图 所示 为了 执行 加密 在 windows 操作系统 上 chrome 使 用了 windows 提供 的 api 该 api 只允许 用于 加密 密码 的 windows 用户 账户 去 解密 已 加密 的 数据 所以 基本上 来说 你 的 主 密码 就是 你 的 windows 账户 密码 所以 只要 你 登 录了 自己 的 windows 账号 chrome 就可以 解密 加密 数据 最后 输出 windows 账户 正确 显示 对应 网站 的 密码 安全 普及 由于 windows 账户 密码 是 一个 常量 并不是 只有 chrome 才能 读取 主 密码 其他 外部 工具 也 能 获取 加密 数据 同样 也 可以 解密 加密 数据 比如 使用 nirsoft 的 免费 工具 官方 下载 就可以 看得 你 已 保存 的 密码 数据 并且 可以 轻松 导出 为 文本文件 既然 chromepass 可以 读取 加密 的 密码 数据 那么 恶意 软件 也是 能 读取 的 注意 当 chromepassexe 被 上传 至 virustotal 时 超过 半数 的 反病毒 av 引擎 会 标记 这一 行为 是 危险 级别 不过 微软 的 并没有 把 这一 行为 标 记为 危险 假设 你 的 电脑 被盗 小偷 重 设了 windows 账号密码 如果 他们 随后 尝试 在 chrome 中 查看 你 的 密码 或用 chromepass 来 查看 密码 数据 都是 不可用 原因 很简单 因 为主 密码 并不 匹配 所以 解密 失败 此外 如果 有人 把 那个 sqlite 数据库文件 复制 走了 并 尝试 在 另外 一台 电脑 上 打开 chromepass 也 将 显示 空 密码 原因 同上 综合 结论 chrome 浏览器 中 已 保存 密码 的 安全性 一定 程 度上 取决于 用户 本身 密码 元素 定位 首先 我们 在 web 渗透 或 python 网络 爬虫 中都 知道 分析 网页 dom 树结构 可以 定位 指定 元素 那么 作者 能不能 修改 input 密码 的 属性 让 它 显示 密码 呢 如 下图 所示 再次 幸运 chrome 应该 已经 解决 了 该 漏洞 显示 空白 密码 提取 复现 接下来 作者 尝试 获取 本地 chrome 浏览器 登录 的 账户 信息 第一步 找到 密码 存储 的 位置 文件 或者是 注册表 这个 时候 需要 开启 监控 工具 processmonitor 后面 的 文章 会 详细 介绍 查看 打开 注册表 和 文件 操作 信息 然 后到 chrome 密码 管理 界面 随便 删除 一条 记录 然后 看看 chrome 本身 对 哪些 文件 或者 注册表 进行了 修改 推荐 tk 大神 文章 同样 可以 直接 寻找 文件 通常 用户名 文件 的 存储 路径 为 cusers 用户名 第二步 找到 如 下图 所示 的 文件 logindata 第三步 打开 这个 文件 还好 这个 文件 是 加密 的 而 不是 明文 存储 虽然 该 文件 加密 了 但是 可以 看到 它是 sqliteformat 的 格式 接着 通过 工具 读取 该 数据 这里 使用 navicatpremium 工具 navicatpremium 是 一款 数据库 管理工具 是 一个 可 多重 连线 资料库 的 管理工具 它 可以 让 你 以 单一 程式 同时 连线 到 及 postgresql 资料库 让 管理 不同 类型 的 资料库 更加 的 方便 第四步 打开 navicatpremium 新建 连接 第五步 输入 连接 名 如 test 并 导入 本地 的 logindata 数据 第六步 打开 之后 在 main 数据库 中 包 含了 三张 表 其中 logins 为 登录 表 新版本 表 增加 如 下图 所示 第七步 打开 如下 所示 比如 邮箱 的 用户 名为 我 的 电话 密码 是 加密 的 第八 步 解密 思想 想要 解密 一个 加密算法 是 很难 的 这 学习 tk 大神 的 文章 了解 到 chrome 开源 的 加密 函数 和 这对 加解密 函数 非常 特别 调用 的 时候 会去 验证 本地 登录 身份 这也 就是 为什么 别人 的 那个 密码 文档 不能 直接 拷贝到 我们 自己 chrome 相关 文件夹 下 去看 的 原因 了 接下来 是 代码 实现 找到 开源 的 sqllite 库 把 数据库 解析 出来 然后 得到 密码 的 加密 数据 用 解密 注意 如果 chrome 开启 的 时候 直接 对 这个 数据库文件 操作 会 失败 建议 每次 操作 先把 文件 拷贝 出来 再 处理 第九步 使用 工具 进行 解密 将 logindata 放置 到 同一个 文件 夹下 运行 即可 下载 地址 渗透 结论 是不是 很 可怕 所以 个人电脑 大家 一 定要 保护好 开机 密码 别 轻易 让 坏人 使用 后续 尝试 破 壳 看看 这个 exe 程序 源代码 是 如何 解析 的 chrome 浏览器 密码 存储 机制 下面 分享 nckwrm 大神 讲解 的 chrome 浏览器 密码 存储 机制 谷歌 浏览器 加密 后 的 密钥 存储 于 下 的 一个 sqlite 数据库 中 那么 他 是 如何 加密 的 呢 通过 开源 的 chromium 我们 来 一探 究竟 首先 我们 作为 用户 登录 一个 网站 时 会在 表单 提交 username 以及 password 相应 的 值 chrome 会 首先 判断 此次 登录 是否 是 一次 成功 的 登录 部分 判断 代码 如下 if if 当 我们 登录 成功 时 并且 使用 的 是 一套 新 的 证书 也就是说 是 xx 次 登录 该 网站 chrome 就会 询问 我们 是否 需要 记住 密码 那么 登录 成功 后 密码 是 如何 被 chrome 存储 的 呢 答案 在 encryptedstring 函数 通过 调用 encryptstring 函数 代码 如下 plaintextlength if result returnfalse 复制 操作 outputpbdata localfree outputpbdata returntrue 代码 利 用了 widowsapi 函数 前面 提到 过来 加密 当 我们 拥有 证书 时 密码 就 会被 回复 给 我们 使 用在 我们 得到 服务器 权限 后 证书 的 问题 已经 不用 考虑 了 所以 接下来 就可以 获得 这些 密码 下面 通过 python 代码 实 现从 环境变量 中 读取 logindata 文件 的 数据 再获 取用 户名 和 密码 并将 接收 的 结果 通过 解密 密码 logindata 文件 可以 利用 python 中 的 sqlite 库 来 操作 filepath 利用 来 对 通过 加密 的 密码 进行 解密 操作 cursorexecute 接收 全部 返回 结果 利用 解密 后 通过 输出 passwd 这个 元组 中 内容 获取 chrome 浏览器 存储 的 密码 用 函数 解密 与 之 对应 的 是 前面 提到 的 理论上 来说 加密 的 文本 内容 都可以 通过 函 数来 解密 对 其他 服务 的 解密 方式 大家 可以 自行 尝试 完整 的 脚本 代码 如下 所示 dbfilepath cursorexecute 接收 全部 返回 结果 用户名 dataprintu 密码 passwdprintu 网站 urldata 安全 建议 个人 安全 建议 电脑 不用 轻易 借给 他人 使用 除非 身边 非常 信任 的人 非 私人 电脑 一定 不 能让 浏览器 保存 密码 设定 一些 易于 记住 的 密码 浏览器 里 登录 时 重要 账户 选择 不要 保存 密码 每次 登录 手动 输入 离开 电脑 务必 记得 随时 锁 屏 或者 关机 登录 系统 一 定要 设定 密码 使用 一个 极高 强度 的 windows 账号密码 必须 记住 有 不少 工具 可以 解密 windows 账号密码 如果 有人 获 取了 你 的 windows 账号密码 那 他 也就 可以 知道 你 在 chrome 已 保存 的 密码 远离 各种各样 的 恶意 软件 如果 工具 可以 轻易 获取 你 已 保存 的 密码 那 恶意 软件 和 那些 伪 安全 软件 同样 可以 做到 如果 非得 下载 软件 请到 软件 官方网站 去 下载 把 密码 保存 至 密码 管理软件 中 如 keepass 或 使用 可以 整 合到 chrome 中 的 第三方 工具 如 lastpass 使用 主 密码 来 管理 你 的 那些 密码 用 工具 如 truecrypt 完全 加密 整个 硬盘 并且 非 私人 电脑 一定 不 能让 浏览器 保存 密码 二 chrome 致 win 蓝屏 漏洞 复现 接下来 补充 一个 年初 大家 会 遇到 的 chrome 浏览器 导致 win 蓝屏 的 漏洞 注意 该 漏洞 请勿 轻易 测试 需 要在 个人 虚拟 机上 测试 测试 前先 保存 好 资料 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 第一步 在 win 谷歌 浏览器 建议 使用 虚拟机 测试 中 输入 命令 第二步 我们 的 计算机 就会 自动 蓝屏 重启 该 漏洞 请勿 轻易 测试 个人 虚拟机 测试 前先 保存 好 资料 漏洞 可 用于 拒绝服务 攻击 并且 微软 还未 修复 该 漏洞 微软 edge 浏览器 也 具有 相同 的 效果 第三步 分析 漏洞 原因 参考 网站 该 windows 中 的 错误 是 通过 在 浏览器 的 地址栏 中 打开 特定 路径 或 使用 其他 windows 命令 即 可使 操作系统 崩溃 并 显示 蓝屏 死机 据 了解 这是 windows 安全 研究人员 在 twitter 上 披露 的 两个 错误 攻击者 可以 在 各种 攻 击中 滥用 这些 错误 第一个 错误 允许 无 特权 的 用户 或 程序 输入 单个 命令 该 命令 会 导致 ntfs 卷 被 标 记为 已损坏 该 测试 表明 该 命令 导致 硬盘驱动器 损坏 从而 导致 windows 无法 启动 本文 不 复现 该 漏洞 第二个 漏洞 是 windows 通过 尝试 打开 一条 异常 路径 而 导致 蓝屏 死机 崩溃 致使 电脑 蓝屏 重启 自 去 年月 以来 windows 安全 研究员 jonaslykkegaard 已经 多次 在 推 特 上 发布 了 一个 路径 当 输入 到 chrome 浏览器 地址栏 时 该 路径 会 立即 导致 windows 崩溃 并 显示 bsod 蓝屏 死机 当 开发人员 想要 直接 与 windows 设备 进行 交互 时 他们 可以 将 win 设备 命名 空间 路径 作为 参数 传 递给 windows 编程 函数 例如 允许 应用程序 直接 与 物理 磁盘 进行 交互 而 无需 通过 文件 系统 lykkegaard 告诉 他 发现了 以下 控制台 多路 复用器 驱动程序 的 win 设备 命名 空间 路径 他 认为 该 路径 用于 内核 用户 模式 ipc 当 以 各种方式 打开 该 路径 时 即使是 低 权限 用户 也 会 导致 windows 崩溃 当 连 接到 该 设备 时 开发人员 应 传递 attach 扩展 属性 以 与 该 设备 正确 通信 如果 你 试图 在 没有 传递 属性 的 情况下 由于 错误 检查 不当 而 连 接到 该 路径 它将 导致 一个 异常 最终 导致 win 出现 bsod 崩溃 更 糟糕 的 是 特权 低 的 windows 用户 可以 尝试 使用 此 路径 连 接到 设备 从 而使 计算 机上 执行 的 任何 程序 都很 容易 让 windows 崩溃 在 测试 中 已经 确认 此 错误 在 windows 版 及 以后 的 版本 中 存在 winver 查看 windows 版本 信息 如 下图 所示 公司 上周 与 microsoft 联系 以 了解 他们 是否 已经 知道该 错误 以及 是否 会 修复 该 错误 微软 表示 调查 了 已 报告 的 安全问题 并 承诺 会尽 快为 受影响 的 设备 提供 更新 虽然 目前 尚不 确定 此 漏洞 是否 可 用于 远程 执行 代码 或 提升 特权 但可以 将其 以 当前 形式 用 作对 计算机 的 拒绝服务 攻击 通过 共享 一个 windowsurl 文件 url 其 设置 指向 路径 当下 载 文件 后 windows 会 尝试 从 有 问题 的 路径 中 呈现 url 文件 的 图标 并 自动 使 windows 崩溃 此后 发现了 许多 其他 利用 此 bug 的 方法 包括 在 windows 登录 时 自动 导致 bsod 的 方法 浏览器 能 致使 蓝屏 死机 最新 微 信 打开 文件 导致 bsod 的 变体 也 出现 确实 如果 浏览器 能 导致 直接 死机 各种 变体 是 非常 容易 实现 的 提醒 大家 升级 该 漏洞 吧 注 意在 现实生活 中 该 漏洞 可能 会被 攻击者 滥用 他们 可以 访问 网络 并 希望 在 攻击 过程中 掩盖 自己 的 踪迹 如果 他们 具有 管理员 权限 则可 以 远程 执行 访问 网络 上 所有 windows 设备 上 的 此 路径 的 命令 以使 它们 崩溃 在 网络 上 造成 的 破坏 可能会 延迟 调查 或 阻止 管理 控件 检 测到 特定 计算 机上 的 攻击 年在 攻击 远东 国际 银行 feib 银 行时 攻击者 就使 用了 类似 的 攻击 手法 在 该 攻 击中 威胁 行为 者 在 网络 上 部署 了 爱马仕 勒索 软件 以 延迟 对 攻击 的 调查 作为 安全 白 帽子 我们 应该 发现 漏洞 即时 通知 相关 厂商 进行 漏洞 修补 既然 操作系统 浏览器 存在 一些 漏洞 那么 常用 的 软件 会 存在 漏洞 吗 三 音乐 软件 漏洞 复现 接下来 复现 csdn 鬼 手 大神 的 文章 他 的 网络安全 crackme 病毒 分析 软件 逆向 等 系列 文章 真心 推荐 大家 学习 包括 他 开源 的 项目 他 的 文章 我 都 准备 allin 参考 原文 第一步 打开 pc 端 某 音乐 客户端 比如 想 下载 周杰伦 的 骑士 精神 通常 会被 拒绝 第二步 此时 点开 设置 选中 下载 设置 找到 缓存 文件 目录 cusers 用户名 第三步 双击 播放 该 歌曲 然后 按照 寻找 最新 的 文件 或 只 保留 一首歌 其中 后缀 名为 uc 的 最大 文件 就是 加密 过后 的 文件 第四步 接在 将 文件 拖 动到 editor 软件 如 下图 所示 它是 一个 加密 文件 最多 的 数据 是 a 鬼 手 大神 成果 的 预测 其 是 加密 后 的 无意义 通常 音频 的 加密 方式 不会 太 复杂 而 最 简单 的 异 或 加密 密 可逆 第五步 接着 点开 菜单 tools 工具 将其 转 换为 十六进制 进行 二进制 异 或 操作 修改 数据 为 无 符号 十六进制 并 对 a 进行 异 或 即可 注意 选择 无 符号 unsignedbyte 和 异 或 a 异 或 加密 解密 aaaa 文件 解密 如下 所示 其中 a 变 换为 解密 完 之后 的 字符 变得 有意义 前 三个 字节 是 id 这个 是 mp 文件 格式 的 头部 最后 将 文件 重 命名为 mp 此时 可以 听歌 了 骑士 精神 走起 注意 这是 一个 简单 的 加密 过程 推荐 读者 们 下载 正版 歌曲 共同 维护 版权 和 绿色 网络 环境 同时 异 或 加密 音乐 已经 很 多年 了 希望 这些 开发公司 优化 下 加密算法 解决 这个 漏洞 四 总结 写到 这里 这篇 文章 介绍 结束 分别 叙述 了 三个 漏洞 浏览器 漏洞 windows 蓝屏 漏洞 音乐 软件 漏洞 如果 你 是 一名 新人 一 定要 踏踏实实 亲自动手 去 完成 这些 基础 的 逆向 分析 相信 会 让 你 逐步 提升 过程 确实 很 痛苦 但 做 什么事 又不 辛苦 呢 加油 希望 你 能 成长 为 一名 厉害 的 系统安全 工程师 或 病毒 分析师 到时候 记得 回到 这篇 文章 的 起点 告诉 你 的 好友 学 安全 一年 认识了 很多 安全 大佬 和 朋友 希望 大家 一起 进步 这篇 文章 中 如果 存在 一些 不足 还请 海涵 作者 作为 网络安全 和 系统安全 初学者 的 慢慢 成长 路 吧 希望 未来 能 更 透彻 撰写 相关 文章 同时 非常感谢 参考文献 中 的 安全 大佬 们 的 文章 分享 深知 自己 很菜 得 努力 前行 编程 没有 捷径 逆向 也没有 捷径 它们 都是 搬 砖 活 少 琢磨 技 巧干 就 对了 什么时候 你 把 攻击 对手 按在 地上 摩擦 你 就 赢了 也 会 慢慢 形 成了 自己 的 安全 经验 和 技巧 加油 吧 少年 希望 这个 路线 对 你 有所 帮助 共勉 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 ccfsci 南 核 北 核 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 星期 四夜 于 武汉 