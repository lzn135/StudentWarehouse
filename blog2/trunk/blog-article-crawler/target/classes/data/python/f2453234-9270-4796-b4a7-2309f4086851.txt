系统安全 十三 熊猫 烧香 病毒 ida 和 od 逆向 分析 中 病毒 释放 机理 您 可能 之前 看到过 我 写 的 类似 文章 为什么 还要 重复 撰写 呢 只是 想 更好 地 帮助 初学者 了解 病毒 逆向 分析 和 系统安全 更加 成 体系 且不 破坏 之前 的 系列 因此 我 重新 开 设了 这个 专栏 准备 系统 整理 和 深入 学习 系统安全 逆向 分析 和 恶意代码 检测 系统安全 系列 文章 会 更加 聚焦 更加 系统 更加 深入 也是 作者 的 慢慢 成长史 换 专业 确实 挺 难 的 逆向 分析 也是 块 硬骨头 但我 也 试试 看看 自己 未来 四年 究竟 能 将它 学到 什么 程度 漫漫 长征路 偏向虎山行 享受 过程 一起 加油 如果 你想 成为 一名 逆向 分析 或 恶意代码 检测 工程师 或者 对 系统安全 非常 感兴趣 就必须 要 认真 分析 一些 恶意 样本 熊猫 烧香 病毒 就是 一款 非常 具有 代表性 的 病毒 当年 造成了 非常大 的 影响 并且 也有 一定 技术手段 本文 将 详细 讲解 熊猫 烧香 的 行为 机理 并 通过 软件 对 其 功能 行为 进行 分析 这将 有助于 我们 学习 逆向 分析 和 反病毒 工作 后续 作者 还 将对 其 进行 逆向 调试 以及 wannacry 勒索 蠕虫 各种 恶意 样本 及 木马 的 分析 基础性 文章 希望 您 喜欢 ida 和 od 作为 逆向 分析 的 倚天剑 和 屠龙刀 学好 它们 的 基本 用法 至关重要 本文 重点 分析 熊猫 烧香 病毒 的 功能 函数 大家 掌握 这些 技巧 后 才能 更好 地 分析 更多 的 代码 同时 本文 部分 实验 参考 姜 晔 老师 的 视频 分析 真的 非常 佩服 和 值得 去 学习 的 一位 老师 技术 路上 哪有 享乐 为了 提升 安全 能力 别 抱怨 干 就 对了 上 一篇 文章 讲 解了 熊猫 烧香 病毒 样本 的 反汇编 代码 入口处 的 分析 接下来 我们 分析 病毒 的 核 心部 其 分析 思路 基本 一致 同时 越 深入 核心 部 分会 遇到 越多 的 api 函数 我们 将 利用 od 和 ida 工具 结合 调用 函数 的 参数 进行 分析 它将 有助于 我们 更好 地 理解 病毒 行为 同时 将 分 析出 的 每一个 call 函数 改为 我们 能够 理解 的 名字 这 往往 也有 助于 对 后续 程序 的 理解 作者 结合 两篇 文章 绘制 了 一张 分析 图 希望 加深 大家 对 熊猫 烧香 的 了解 这 系列 文章 写得 不容易 希望 大家 给 点个 赞 和 收藏 也 欢迎 评论 和 交流 从 年月 开始 我 来 到了 一个 陌生 的 专业 网络空间 安全 初 入 安全 领域 是 非常 痛苦 和 难受 的 要 学 的 东西 太多 涉及面 太 广 但 好在 自己 通过 分享 篇 网络安全 自学 系列 文章 艰难 前行 着 感恩 这一 年 相识 相知 相 趣 的 安全 大佬 和 朋友们 如果 写得 不好 或 不足之处 还请 大家 海涵 接下来 我 将 开启 新 的 安全 系列 叫 系统安全 也是 免费 的 篇文章 作者 将 更加 深入 的 去 研究 恶意 样本 分析 逆向 分析 网络 攻防 实战 等 也 将 通过 在线 笔记 和 实践 操作 的 形式 分享 与 博 友 们 学习 希望 能与 您 一起 进步 加油 推荐 前文 网络安全 自学 篇 系列 篇 话 不 多说 让我们 开始 新 的 征程 吧 您 的 点 赞 评论 收藏 将是 对 我 最大 的 支持 感恩 安全 路上 一路 前行 如果有 写得 不好 或 侵权 的 地方 可以 联系 我 删除 基础性 文章 希望 对 您 有所 帮助 作者 目的 是 与 安 全人 共同进步 加油 文章 目录 一 实验 背景 二 sub 核心 函数 分析 subc 子函数 sub 子函数 subed 子函数 suba 子函数 分析 suba 后续 删除 功能 sube 子函数 subc 子函数 subecc 子函数 三 总结 作者 的 github 资源 逆向 分析 网络安全 前文 分析 系统安全 一 什么 是 逆向 分析 逆向 分析 基础 及 经典 扫雷 游戏 逆向 系统安全 二 如何 学好 逆向 分析 及 吕布 传 游戏 逆向 案例 系统安全 三 idapro 反汇编 工具 初识 及 逆向 工程 解密 实战 系统安全 四 ollydbg 动态 分析 工具 基础 用法 及 crakeme 逆向 破解 系统安全 五 ollydbg 和 cheatengine 工具 逆向 分析 植物 大战 僵尸 游戏 系统安全 六 逆向 分析 之 条件 语句 和 循环 语句 源码 还原 及 流程 控制 系统安全 七 逆向 分析 之 pe 病毒 原理 c 实现 文件 加解密 及 ollydbg 逆向 系统安全 八 windows 漏洞 利 用之 cve 复现 及 蓝屏 攻击 系统安全 九 windows 漏洞 利 用之 ms 远程 代码 执行 漏洞 复现 及 深度 提 权 系统安全 十 windows 漏洞 利 用之 smbv 服务 远程 代码 执行 漏洞 cve 复现 系统安全 十一 那些 年 的 熊猫 烧香 及 pe 病毒 行为 机理 分析 系统安全 十二 熊猫 烧香 病毒 ida 和 od 逆向 分析 上 病毒 初始化 系统安全 十三 熊猫 烧香 病毒 ida 和 od 逆向 分析 中 病毒 释放 机理 声明 本人 坚决 反对 利用 教学方法 进行 犯罪 的 行为 一切 犯罪行为 必将 受到 严惩 绿色 网络 需要 我们 共同 维护 更 推荐 大家 了解 它们 背后 的 原理 更好 地 进行 防护 该 样本 不会 分享 给 大家 分析 工具 会 分享 参考文献 见 后 一 实验 背景 对 病毒 进行 逆向 分析 可以 彻底 弄清楚 病毒 的 行为 从而 采取 更 有效 的 针对 手段 为了 节省 篇幅 在这里 我 不 打算 将 熊猫 烧香 进行 彻底 的 分析 只会 讲解 一些 比较 重要 的 部分 大家 只要 掌握 了 这些 思想 那么 就可以 处理 很多 的 恶意程序 了 这里 主要 使用 的 工具 包括 peid 病毒 加 壳 脱壳 基础性 分析 idapro 静态 分析 ollydbg 动态 分析 实验 文件 setupexe 熊猫 烧香 病毒 基本 流程 利用 查 壳 工具 检查 病毒 是否 带 壳 利用 od 动态 分析 病毒 利用 ida 静态 分析 病毒 注意 由于 od 工具 会将 程序 运行 起来 所以 我们 在 进行 恶意代码 分析 时 尽量 在 搭 建好 的 虚拟机 中 操作 如果 病毒 传播 性 较强 如 wannacry 建议 断开 网络 和 断开 共享 分析 实验 思路 利用 od 分析 每一个 call 的 功能 使用 idapro 在 宏观 上 把握 程序 的 功能 并 及时 对 函数 进行 重命名 操作 上篇 回顾 xcbecallsubc 重 命名为 分配 内存空间 sub 字符串 拷贝 功能 xcbfcallsub 重 命名为 decodestringxcc 循环 入口 点 xe 获取 xboy 解密 字符 x 完成 异 或 解密 操作 xcbaccallsub 重 命名为 cmpstringx 循环 入口 点 功能 字符串 比较 武汉 男生 感染 下载者 xcbccloccbbc 功能 字符串 解密 和 比较 操作 解密 字符 二 sub 核心 函数 分析 上 一篇 文章 我们 详细 介绍 了 熊猫 烧香 病毒 起始 阶段 的 初始化 操作 这篇 文章 将 进入 该 病毒 的 核心 功能 函数 进行 相关 的 逆向 分析 letsgosubc 子函数 第一步 打开 idapro 载入 我们 的 病毒 样本 第二步 定位 到 loccbe 位置 这里 看到了 三个 call 函数 它们 又是 什么 功能 呢 这三个 call 是 熊猫 烧香 病毒 最 重要 的 功能 也是 我们 接下来 要 深入 逆向 分析 的 内容 subsubcacsubcc 第三步 查看 函数 sub 内容 在 这个 函数 的 最 开始 位置 我们 看到了 将 h 赋值 给 ecxh 表示 循环 的 次数 循环 的 主体 是 下面 两个 push 其中 每一个 push 能 开辟 个 字节 位 的 空间 两个字 节能 获得 个 字节 的 空间 这样 的 空间 一共 申 请了 ecxh 次 movecxhpushpush 第四步 我们 主要 分析 call 函数 往下 看到 第一个 函数 subc 第五步 接着 用 od 载入 exe 程序 进行 动态 的 分析 直接 跳 转到 该 地址 xdcallsubc 基本 流程 为 右键 转到 gt 表达式 gt 输入 d 按 下 f 增加 断 点按 f 直接 执行 到 该 位置 该 函数 我们 可以 在 ida 中 先 双击 查看 会 发现该 函数 首先 调 用了 该 函数 功能 主 要是 获取 当前 进程 已 加载 模块 文件 的 完整 路径 第六步 回到 od 中 subc 函数 按 下 f 单步 进入 函数 接着 进入 函数 后 按 f 单 步步 过 可以 看到 右下角 的 内容 在 这个 pathbuffer 里 会 保存 即将 获取 的 路径 信息 接着 选中 pathbuffer 值 右键 点击 数据 窗口 中 跟随 注意 按 下 f 大家 可以 在 数据 窗 口中 留意 该 值 的 前后 变化 发现 它 成功 获 取了 该 样本 的 本地 路径 第七步 我们 打开 ida 给 subc 函数 重命名 小 技巧 ida 中 双击 会 进入 对应 的 函数 那么 如何 返回 上 一层 呢 按 下 esc 即可 返回 如 下图 所示 从 中 按 esc 返回 subc 位置 而 按 f 键 会 逆向 出 c 语言 程序 然后 选中 函数 重命名 快捷键 为 n 总结 重命名 及 对应 功能 如下 功能 获取 文件 的 完整 路径 及 文件名称 sub 子函数 接着 往下 看 函数 如下 xecallsub 第一步 继续 在 od 中 进行 跟进 首先 我们 表达式 跳转 到 位置 然后按 下 f 增加 断 点按 下 f 执行 过来 我们 首先 可以 看看 它 压 入 的 参数 是什么 第二步 在 数据 窗口 中 跟随 eax 按 下 f 单步 执 行在 寄存器 中 选中 eax 右键 数据 窗口 中 跟随 显示 结果 如 下图 所示 可以 看到 eax 中 保存 的 是 刚刚 获取 的 病毒 文件 完整 路径 第三步 在 数据 窗口 中 跟随 edx 按 下 f 单步 执 行在 寄存器 中 选中 edx 右键 数据 窗口 中 跟随 目前 edx 还是 空 值 第四步 进入 后面 的 call 查看 它 的 内容 先 选中 eax 右键 数据 窗口 中 跟随 然后按 下 f 进入 函数 可以 看到 这里 出现 了 粗线条 说明 它是 一个 循环 我们 步入 循环 分析 其 内容 前面 按 下 f 执行 然 后到 循环 位置 按 f 步入 moveaxlocal 注意 这里 简单 介绍 下 局部变量 的 概念 小 技巧 local 是 局部变量 的 意思 例如 local 就是 第一个 局部变量 存放在 栈 里 的 ebp 位置 local 就是 ebp 图片 上 的 命令 其实 就是 moveaxebp 方法 一 可以 在 od 的 选项 gt 调试 设置 gt 分析 里面 有 个 选项 把 勾 去掉 设置 方法 二 选中 该 命令 右键 汇编 即可 但 修改 后会 显示 灰色 第五步 接着 分析 循环 分析 语句 首 先将 ebp 赋值 给 eax 而 当前 的 ebp 就是 所 获取 的 病毒 的 完整 路径 然后 再按 f 这里是 将 eax 加上 ebx 再 减 其中 eax 是 病毒 完整 路径 的 首 地址 ebx 是 它又 是什么 呢 我们 查看 ebx 如 下图 所示 凡是 由 delphi 编写 的 程序 它 会在 字符串 减 的 位置 保存 一个 数值 这个 数值 就是 字符串 的 长度 我们 可以 看到 当前 路径 长度 是 xeaxebxx 计算 字符串 最后 一个 字母 的 位置 即 e 下 图中 也 显示出 来了 ds e 第六步 继续 按 f 执行 这里 结合 ida 分析 分析 xcxfxa 对应 的 值 我们 在 xb 看到 有 一系列 的 比对 然后 右键 分别 选中 xcxfxa 解析 成 对应 的 值 或者 选中 按 下 r 键 c 代表 斜杠 f 代表 反 斜杠 a 代表 冒号 小结 该 循环 是 将 病毒 所在 完整 的 路径 从 后 向前 检索 直到 遇到 斜杠 反 斜杠 冒号 结束 结合 病毒 来看 它 找 斜杠 的 位置 其实 这段 程序 要么 是 想 不 包含 病毒 文件名 的 路径 要么 想 获取 病毒 毒 的 文件名 setupexe 第七步 在 od 中 继续 按 f 调试 注意 观察 数据 窗口 的 变化 发现该 程序 不断地 从 后 往前 获取 路径 信息 并 进行 对比 接着 发现 程序 在 调 用完 call 函数 之后 会 出现 一个 新 的 字符串 事实上 很明显 它是 想 获取 去除 病毒 文件名 后 的 路径 可见 程序 将去 除了 文件名 的 路径 拷贝 到了 之前 申请 的 空 间中 于是 可以 将 sub 重命名 xdcallc 总结 重命名 及 对应 功能 如下 功能 获取 去除 病毒 文件名 后 的 路径 ida 位置 xesubed 子函数 第一步 继续 在 od 中 往下 分析 代码 赋值 语句 返回 的 第一 句 代码 是 将 我们 之前 所 获取 的 不带 文件名 的 地址 赋值 给 我们 选中 eax 在 数据 窗口 中 跟随 可以 看到 对应 的 值 是 对应 的 值 如 下图 所示 即 不带 文件名 的 文件 路径 现在 eax 保存 的 就是 这个 地址 第二步 继续 分析 代码 接下来 将 desktopini 赋值 给 edx 注意 x 表示 为 d 十进制 对应 的 ascii 码 movedxxc 第三步 通过 ida 大致 看看 call 函数 edxecallsubed 但是 通过 这个 很难 分 析出 它 的 具体 功能 我们 不妨 只 关注 它 的 两个 参数 观察 执行 完 该 函数 后 的 参数 位置 有 什么 变化 第四步 我们 留意 着 数据 窗口 然后按 f 执行 可以 看到 刚才 所 获取 的 不带 文件 的 路径名 在其 后面 增加了 一个 desktopini 从而 组 成了 新 的 字符串 分析 这里 我们 就 知道 subed 功能 是 将 上面 所 获取 的 不带 文件名 的 路径 的 地址 赋值 给 eax 然后 将 字符串 desktopini 的 地址 赋 给 edx 总结 重命名 及 对应 功能 如下 功能 拼接 字符串 包含 desktopini 后缀 同样 我们 可以 进入 subed 进行 详细分析 suba 子函数 接着 继续 分析 suba 子函数 功能 xcallsuba 第一步 我们 在 od 中 查看 eax 的 地址 在这里 我们 跟踪 查看 这个 地址 选中 堆栈 数值 右键 数据 窗口 中 跟随 数值 可以 看到 它 的 这个 参数 是 我们 之前 已经 连 接好 的 字符串 的 首 地址 xf 第二步 按 下 f 运 行至 calla 函数 再按 f 进入 该函 数 分析 继续 按 下 f 进入 callc 发现有 个 findfirstfilea 函数 我们 直接 来 看看 它 的 参数 注意 很多 时候 右边 注释 内容 是 没有 的 需要 我们 手动 分析 按 下 f 执行 到 函数 调用 前 位置 可以 看到 eax 中 存放 是的 是 刚才 连接 出来 的 字符串 该 函数 的 作用 就是 说明 要 查找 当前 目 录下 desktopini 文件 是否 存在 总结 重命名 及 对应 功能 如下 功能 检测 文件 desktopini 是否 存在 分析 suba 后续 删除 功能 接着 我们 继续 分析 由于 之前 进行了 重命名 操作 所以 代码 的 可读性 更 好了 从 x 位置 下面 的 代码 我们 都能 看懂 它会 根据 上 一段 代码 的 查找 结果 进行 判定 al 即 如果 当前 目 录下 desktopini 文件 存在 那么 就会 调用 函数 该 函数 会 改变 他 的 属性 将它 的 属性 改为 h 所 代表 的 值 即 该 文件 的 文件 属性 调整 为 normal 正常 属性 继续 往下 看 调 用了 一个 sleep 函数 停止 毫秒 停止 毫秒 之后 它 接着 调用 deletefilea 函数 将 desktopini 删除 正常 来讲 病毒 还没有 运行 的 时候 这个 desktopini 文件 应当是 不存在 的 如果 存在 的话 病毒 首先 会 改变 这个 文件 的 属性 再将 这个 病毒 给 删 除掉 这里 看到 一个 未知 函数 subcc 它 的 参数 是 ebpvarc 事实上 c 就是 文件 的 路径 将 文件 路径 赋值 给 eax 我们 进入 subcc 函数 发现 其 功能 验证 eax 是否 存 在即 判定 文件 的 路径 是否 为 空 如果 文件 不存在 它会 直接 执行 loc 位置 的 函数 subcc 其实 就是 一个 验证 机制 在 ida 中 按 下 esc 返回 我们 给它 进行 重命名 总结 重命名 及 对应 功能 如下 功能 检测 文件 的 路径 是否 存在 sube 子函数 继续 往下 分析 我们 看到 sube 函数 xcallsube 第一步 我们 在 ida 中 大致 看下 函数 的 内容 我们 可以 看到 这个 函数 非常 的 长 且 也 调 用了 很多 其它 的 函数 那么 看上去 很难 分析 清楚 这个 函数 到底是 做什么 的 这里 我们 先 不管 其 具体 的 实现 细节 只 看看 该 函数 执行 完 后 这些 参数 或 寄存器 位置 发 生了 什么 变化 主要 关注 该 函数 执行 前后 程序 使 用了 哪些 寄存器 第二步 打开 od 跳 转到 d 位置 按 下 f 增加 断点 再按 f 执行 过来 注意 病毒 逆向 分析 就是 调用 ida 和 od 反复 调试 的 过程 第三步 在 od 中 分析 具体 代码 首先 它是 将 ebpcc 赋值 给 eax 再将 ebp 赋值 给 edx 调用 call 函数 我们 现 在按 f 来 步 过 这个 call 函数 再 观察 数据 窗 口中 存在 什么 变化 可以 看到 执行 完 call 函数 后 这个 函数 用了 很大 一片 区域 写 入了 非常 多 看似 无意义 的 字符 结合 右边 的 ascii 码 可以 将 这些 内容 理解为 暴力 p 解 的 字典 病毒 的 编写者 企图 利用 暴力 p 解 的 方式 来 攻破 计算机中 某些 验证 机制 当然 这些 内容 还是 非常 多 的 病毒 作者 也 写 入了 很多 其他 信息 有 兴趣 的 作者 可以 好好 分析 下 这些 信息 有助于 我们 获取 病毒 的 行为 信息 只有 当 我们 深入分析 其 原理 和 实现 过程 才有 助于 我们 获取 病毒 的 行为 信息 总结 重命名 及 对应 功能 如下 功能 写入 病毒 信息 到 内存 中 病毒 作者 企图 利用 暴力 p 解 的 方式 来 攻破 计算机中 的 某些 验证 机制 subc 子函数 继续 在 od 中 分析 subc 子函数 第一步 查看 ebp 地址 对应 的 值 在 数据 窗 口中 可以 看到 eax 的 值 为 ebpvar 的 地址 通过 od 可以 知道 这个 地址 中 保存 的 是 可以 理解为 没有 数据 第二步 我们 按 下 f 进入 这个 call 查看 具体内容 xecallc 可以 看到 它 首先是 将 eax 的 内容 赋值 给 edx 我们 按 下 f 可以 看到 edx 也 变 成了 值 之后 的 test 运算 使得 zf 变为 满足 跳转 条件 直接 跳 转至 retn 那么 本段 函数 也就 结束 了 刚才 我们 通过 testedxedx 发现 zeroflag 标志 位 变 成了 这个 标志 位 变为 说明 这个 值 是 一个 这段 函数 似乎 并没有 实现 什么 特别 清晰 具体 的 功能 那么 不妨 将 这个 操作 理解为 某种 标志 的 设置 总结 重命名 及 对应 功能 如下 功能 设置 零 标志 位 重设 将其 设置 为 subecc 子函数 回到 od 我们 分析 subecc 子函数 第一步 查看 并 分析 ebp 保存 的 内容 在 数据 窗口 中 跟随 可以 看到 mzp 这里 大致 是 保存 了 一个 pe 文件 事实上 就是 将 这个 pe 文件 的 首 地址 赋值 给 这个 eax 接着 看看 这个 call 第二步 分析 callecc 函数 按 下 f 进入 这个 call 函数 首先 调用 testeaxeax 验证 pe 文件 是否 存 在按 下 f 继续 这里是 跳转 不成立 然后 出现在 eax 位置 我们 在 数据 窗口 中 跟随 内容 小 技巧 这里 需要 特别强调 的 是 由于 本 病毒 程序 是 使用 delphi 编写 的 因此 字符串 的 首 地址 减去 后 所 取出 的 个 字节 的 内容 就是 此 字符串 的 长度 换句话说 这段 代码 中 的 eax 就是 eax 所 指向 的 文件 长度 字符串 长度 就是 ec 这条 语句 就是 将 ec 保 存在 寄存器 里面 于是 可以 将 subecc 重命名 字符串 长度 ec 现在 eax 保存 的 就是 字符串 的 长度 即 pe 文件 的 长度 总结 重命名 及 对应 功能 如下 功能 获取 pe 文件 的 长度 之前 这个 文件 的 长度 是 保 存在 eax 里面 这里 又将 文件 长度 赋值 给 ebx 接下来 在 获取 文件 长度 后 程序 会 跳 转到 loc 处 执行 首先 它会 验证 ebx 是否 为 零 文件 长度 是否 为 正常 来说 文件 长度 是 不为 的 也 就是 这个 文件 是 真实 存在 的 所以 接下来 的 跳转 不成立 会 继续 往下 执行 接着 我们 尝 试用 od 进行 分析 跳 转到 x 的 位置 按 下 f 增加 断点 再按 f 让 它 执行 过来 按 f 跳转 不成立 继续 执行 可以 看到 将 ebp 赋值 给 eax 事实上 就是 让 eax 重新 指向 这个 pe 文件 的 起始 位置 按 下 f 继续 执行 这里是 将 eaxebx 由于 eax 指向 的 是 文件 起始 地址 而 ebx 是 文件 的 长度 减 一是 获取 整个 pe 文件 最后 一个 字符 它是 什么 事实上 cmp 语句 就是 验证 这个 文件 最后 一个 数据 它 是否 为 零 如果 为 则 接下来 的 跳转 不成立 经过 od 的 动态 分析 发现 因为 这里 显示 跳转 未 实现 故 文件 尾端 的 值 为 所以 不 执行 跳转 继续 向下 执行 三 总结 写到 这里 该 部分 关于 sub 核心 函数 的 部分 功能 就 介绍 完毕 请 大家 一 定要 动手 跟着 调试 先 感受 下 这 部分 的 实验 后面 的 文章 我们 将 继续 分析 熊猫 烧香 病毒感染 的 过程 再次 感谢 姜 晔 老师 经过 这篇 文章 的 讨论 我们 详细 调 试了 病毒 的 各个 模块 当然 整个 病毒 的 所有 功能 都没 时间 完全 概述 文章 更 多是 提供 一种 恶意 样本 分析 的 方法 和 思路 带领 大家 入门 正如 姜 老师 所说 只要 各位 读者 勤于 动手 并将 所讲 的 逆向 分析 的 基本原理 搞清楚 那么 这个 病毒 分析 根本 不在话下 最后 简单 总结 这篇 文章 的 逆向 过程 主要 分析 sub 核心 函数 xdcallsubc 重 命名为 功能 获取 文件 的 完整 路径 及 文件名称 xecallsub 重 命名为 getfilepath 功能 获取 去除 病毒 文件名 后 的 路径 ida 位置 xe 技巧 循环 将 病毒 的 完整 路径 从 后 往前 检索 直到 遇到 斜杠 反 斜杠 冒号 结束 从而 提取 病毒 的 路径 或 病毒 的 文件名 如 重命名 stringcat 功能 拼接 字符串 包含 desktopini 后缀 功能 检测 文件 desktopini 是否 存在 功能 检测 文件 的 路径 是否 存在 功能 写入 病毒 信息 到 内存 中 病毒 作者 企图 利用 暴力 p 解 的 方式 来 攻破 计算机中 的 某些 验证 机制 功能 设置 零 标志 位 将其 设置 为 功能 获取 pe 文件 的 长度 cmp 语句 就是 验证 pe 文件 最后 一个 数据 是否 为 零 再 给出 这张 图 希望 加深 大家 对 熊猫 烧香 的 了解 这 系列 文章 写得 不容易 您 的 点 赞 评论 收藏 将是 对 我 最大 的 支持 感恩 安全 路上 一路 前行 如果 果有 写得 不好 或 侵权 的 地方 可以 联系 我 删除 基础性 文章 希望 对 您 有所 帮助 作者 目的 是 与 安 全人 共同进步 加油 csdn 年度 回忆 最 开心 的 是 已经 在这里 分享 了 近十年 与它 走 过了 天 十年 啊 人生 的 八分 之一 最 回味 的 是 今年 分享 了 篇 原创 文章 近十年 最高 每 一篇 字数 都 快过 万 都是 我 很 用心 的 总结 最 感谢 的 是 购买 专栏 的 朋友 和 每一位 阅读 我 文章 的 博 友 博客 让 我 每月 收入 过 千 感恩 编程 路上 的 同行 最 满意 的 还是 那篇 年终总结 敏 而 多思 宁静致远 分享 我们 一家 的 故事 年 挺 难 我 还是 那句话 希望 能在 csdn 写有 温度 的 代码 分享 高质量 的 原创 文章 帮助 更多 初学者 年 继续 加油 共勉 csdn 这个 画风 我 很喜欢 年月 新开 的 娜 璋 ai 安全 之家 主要 围绕 python 大数 据分析 网络空间 安全 人工智能 web 渗透 及 攻防 技术 进行 讲解 同时 分享 ccfsci 南 核 北 核 论文 的 算法 实现 娜 璋 之家 会 更加 系统 并 重构 作者 的 所有 文章 从 零 讲解 python 和 安全 写了 近十年 文章 真心 想把 自己 所学 所 感 所做 分享 出来 还请 各位 多多指教 真诚 邀 请您 的 关注 谢谢 byeastmount 星期 四夜 于 武汉 参考文献 姜 晔 老师 真的 非常 佩服 和 值得 去 学习 包括 他 苏 宁 到 卡巴 斯基 的 故事 推荐 大家 去 阅读 也 希望 自己 和 大家 的 技术 能 不断 提升 加油 姜 晔 老师 技术 分享 b 站 姜 晔 老师 的 技术 空间 目录 csdn 网络安全 自学 篇 木马 原理 详解 远程 服务器 ipc 漏洞 及 木马 植入 实验 腾讯 安全 联合 实验室 知 乎 文章 网络安全 自学 篇 七十九 windowspe 病毒 原理 分类 及 感染 方式 详解 网络安全 自学 篇 四十九 procmon 软件 基本 用法 及 文件 进程 注册表 查看 安全 攻防 进阶篇 八 那些 年 的 熊猫 烧香 及 pe 病毒 行为 机理 分析 网络安全 自学 篇 七十三 wannacry 勒索 病毒 复现 及 分析 四 蠕虫 传播 机制 源码 详解 