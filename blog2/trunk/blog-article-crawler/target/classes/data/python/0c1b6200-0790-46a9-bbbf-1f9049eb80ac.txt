pyhon 大数 据分析 五 人民网 新闻 话题 抓取 及 gephi 构建 主题 知识 图谱 该 系列 文章 是 python 大数 据分析 系列 博客 包括 网络 爬虫 可视化 分析 gis 地图 显示 情感 分析 舆情 分析 主题 挖掘 威胁 情报 溯源 知识 图谱 预测 预警 及 ai 和 nlp 应用 等 希望 该 系列 文章 对 您 有所 帮助 前文 分享 了 采用 snownlp 对 微 博 话题 进行 简单 的 情感 分析 及 文本 挖掘 这篇 文章 将 讲解 python 抓取 人民网 新闻 并 利用 gephi 构建 主题 知识 图谱 发现 各 主题 关键词 的 关联 希望 这篇 基础性 文章 对 您 有所 帮助 也 非常感谢 参考文献 中 老师 的 分享 如果 您有 想 学习 的 知识 或 建议 可以 给 作者 留言 本文 的 重点 不是 数据 抓取 请 读者 结合 自己 的 需求 和 数据 进行 分析 也 可以 直接 使用 作者 的 数据 集 希望 给 大家 知识 图谱 提供 一点 思路 就 作者 而言 知识 图谱 包括 两种 类型 一种 是 google 于 年 提出 的 knowledgegraph 下一代 搜索引擎 另一种 是 图书 情报 和 文献 分析 的 知识 图谱 这里 其实 介于 两者之间 也 建议 读者 结合 自己 领域 理解 代码 下载 地址 下载 地址 文章 目录 一 人民网 数据 抓取 二 文本 关键词 提取 三 共 现 矩阵 四 主题 关键词 共 现 分析 五 gephi 绘制 主题 知识 图谱 数据 准备 导入 数据 调整 参数 绘制 图谱 图谱 优化 六 总结 同时 推荐 前面 作者 另外 五个 python 系列 文章 从 年 开始 作者 主要 写了 三个 python 系列 文章 分 别是 基础知识 网络 爬虫 和数 据分析 年 陆续 增加了 python 图像识别 和 python 人工智能 专栏 python 基础知识 系列 python 基础知识 学习 与 提升 python 网络 爬虫 系列 python 爬虫 之 数据 分析 系列 知识 图谱 web 数据 挖掘 及 nlppython 图像识别 系列 python 图像 处理 及 图像识别 python 人工智能 系列 python 人工智能 及 知识 图谱 实战 前文 阅读 pyhon 大数 据分析 一 腾讯 实时 数据 爬 取 matplotlib 和 seaborn 可视化 分析 全国 各地区 某省 各城市 新增 趋势 pyhon 大数 据分析 二 pyecharts 绘制 全国 各地区 某省 各城市 地图 及 可视化 分析 pyhon 大数 据分析 三 新闻 信息 抓取 及 词 云 可视化 文本 聚 类 和 lda 主题 模型 文本 挖掘 pyhon 大数 据分析 四 微 博 话题 抓取 及 新 冠 肺炎 文本 挖掘 和 情感 分析 一 人民网 数据 抓取 本文 抓取 数据 为 人民网 某 专栏 的 新闻 数据 数据 包括 重要新闻 人民 评论 实况 武汉 各地 动态 八方支援 等 专栏 通过 抓取 新闻 数据 进行 主题 关键词 分析 和 知识 图谱 构建 下面 以 yq 快速 为 例 先 进行 网页 分析 再 抓取 相关 的 新闻 数据 本文 采用 selenium 和 beautifulsoup 进行 抓取 定位 网页 节点 关键 代码 如下 标题 链接 获取 标题 时间 链接 之后 我们 通过 访问 链接 获取 正文 信息 核心 代码 如下 zwsoupfind 完整 代码 写入 文件 pathosgetcwd writercsvwriter csvfile writerwriterow 序号 文章 标题 发布 时间 文章 链接 文章内容 yq 快讯 数据 抓取 chromedriverexe 置于 python 根目录 driverget url 打开 网页 网页 等待 加载 六秒 获取 标题 ttext href print nn 获取 正文 defgetcontent url print url url read 来源 lysoupfind attrsclassfl gettext print ly 正文 zwsoupfind 防止 某些 文章 仅 图片 zwzwreplace n elsezwprint zw print succeed except print zw returnlypage 写入 文件 kwhilekltlen titles 序号 numstr k 文章 标题 和 发布 时间 n 文件 链接 href 获取 来源 和 正文 lyzwgetcontent url content 文件 写入 操作 writerwriterow content kk 文件 关闭 csvfileclose 数据 抓取 如 下图 所示 存储 至 csv 文件 如 下图 所示 二 文本 关键词 提取 作者 抓 取了 多个 专栏 汇总 相关 数据 如 下图 所示 可从 github 下载 由于 论文 原因 作者 仅 公开 每个 专栏 的 篇 新闻 包括 八方支援 各地 动态 抗 疫 英雄 权威 解读 人民网 评 实况 武汉 一线 守护 等 数据 如 下图 所示 作者 提取 新闻 正文 内 容或 新闻标题 进行 词频 分析 存储 为 alldatatxt 接下来 的 代码 是 中文 分词 并 提取 每条 新闻 排名 前 的 关键词 作为 后续 的 共 现 分析 和 知识 图谱 构建 中文 分词 forlineinopen linelinestrip n 停 用词 过滤 lineresub amp ltgtsline seglistjiebacut linecutallfalse cutwords join seglist 计算 关键词 ccounter x n 词频 统计 结果 for kv incmostcommon print sd kv outputkfwrite outputn elsefclose 运行 结构 如 下图 所示 每 一行 表示 一条 新闻 的 top 关键词 接下来 需要 计算 它们 的 共 现 矩阵 三 共 现 矩阵 引文 分析 常见 的 包括 两类 一种 是 共 现 关系 另一种 是 引用 和 被 引用 关系 本文 主要 讲解 共 现 关系 假设 现在 存在 三 篇文章 如下 所示 文章 标题 作者 大 数据 发展 现状 分析 abcpython 网络 爬虫 adc 贵州省 大 数据 战略 db 首 先写 代码 抓取 该 领域 文章 的 所有 作者 或 关键词 即 abcd 接着 获取 对应 的 共 现 矩阵 比如 文章 大 数据 发展 现状 分析 则 认为 abc 共 现在 他们 之间 建立 一条 边 共 现 矩阵 如下 所示 abcdabcd 通过 共 现 矩阵 分别 获取 两两 关系 及 权重 再 写入 csv 或 excel 文件 中 如下 所示 将该 csv 文件 导入 gephi 中 并 绘制 相关 的 图形 因为 该 实例 节点 比 较少 下面 是 pyhton 调用 networkx 绘制 的 代码 及 图形 定义 有 向 图 dgnxgraph 添加 五个 节点 列表 dgaddnodesfrom abcd print dgnodes 添加 边 列表 dgaddedge abweight dgaddedge acweight dgaddedge adweight dgaddedge bcweight dgaddedge bdweight dgaddedge cdweight dgaddedgesfrom ab ac ad bc bd cd print dgedges 绘制 图形 设置 节 点名 显示 节点 大小 节点 颜色 pltshow 绘制 图形 如下 所示 大家 也 可以 采用 pyecharts 绘制 网络图 neoj 图 数据库 绘制 关系 图 由于 我们 的 数据 集 比 较多 故 推荐 大家 使用 gephi 软件 绘制 相关 图形 而且 图形 比较 美观 四 主题 关键词 共 现 分析 下面 的 代码 是 获取 每条 新闻 主题 关键词 的 共 现 矩阵 代码 如下 第一步 读取 数据 word 记录 关键词 fopen linefreadline n 过滤 换行 linelinestrip n forninlinesplit n linefreadline fclose print len word 关键词 总数 第二步 计算 共 现 矩阵 anpzeros print a 共 现 矩阵 len word len word dtypefloat memoryerror 矩阵 过大 汇报 内存 错误 采用 coomatrix 函数 解决 该 问题 print len word 类型 len word len word dtypenpint toarray print wordvectorshape fopen linefreadline n 过滤 换行 linelinestrip n 过滤 换行 numslinesplit 循环 遍历 关键词 所在位置 设置 wordvector 计数 ijwhileiltlen nums abcd 共 现 abacadbcbdcd 加 jiwnumsi 第一个 单词 whilejltlen nums wnumsj 第二个 单词 从 word 数组 中找到 单词 对应 的 下标 knwhilekltlen word 寻找 第二个 关键字 位置 knwhilekltlen word 重点 词频 矩阵 赋值 只 计 算上 三角 读取 新 内容 linefreadline fclose 第三步 txt 文件 写入 resopen iwhileiltlen word word wwordj 判断 两个 词 是否 共 现 共 现 amp 词频 不为 的 写入 文件 int wordvectorij reswrite wwstr int wordvectorij n jjiiresclose 第四步 csv 文件 写入 copen 解决 空行 cwrite codecsbomutf 防止 乱码 writercsvwriter c 写入 对象 writerwriterow wordwordweight iwhileiltlen word word wwordj 判断 两个 词 是否 共 现 共 现 词频 不为 的 写入 文件 写入 文件 w templistappend w templistappend str int wordvectorij templist jjiicclose 输出 结果 如下 所示 生成 如 下图 所示 共 现 关系 主题词 word 和 word 共 现 weight 词 共计 条 关系 由于 主题 关系 较 多会 影响 绘制 的 知识 图谱 而 我们 的 分析 目的 是 提取 核心 关键词 的 关联 关系 因此 接下来 需要 进行 数据 预处理 将 关系 权重 weight 小于 等于 的 都 过滤 最终 得到 文件 共计 条 关系 五 gephi 绘制 主题 知识 图谱 数据 准备 实体 构建 个 主题 关键词 或 实体 构建 实 体表 entitycsv 包括 id 编号 和 label 类 标 名称 共 个 主题 关键词 实体 如 下图 所示 这里 采用 的 方法 是 将 文件 的 word 和 word 关键词 复制 至 一列 并 删除 重复 项 而 真实 的 知识 图谱 需要 通过 命令 实体 识 别来 提取 如果 想知道 这 部分内容 后续 我 也 可以 尝试 分享 关系 构建 条 关系 构建 关系 表 relationshipcsv 包括 source 起始 实体 target 目标 实体 type 类型 无 方向 和 weight 权重 共 条 三元 关系 lt 实体 关系 实体 gt 如 下图 所示 导入 数据 第一步 新建 工程 并 选择 数据资料 输入 电子表格 第二步 导入 节点 表格 选择 entity 实 体表 第三步 导入 数据 如 下图 所示 设置 为 边 表格 注意 csv 表格 数据 一定 设置 为 source 起 始点 target 目标点 weight 权重 这个 必须 和 gephi 格式 一致 否则 导入 数据 会 提示 错误 导入 数据 如 下图 所示 它们 是 无 向 图 第四步 导入 成功 后 点击 概览 显示 如下 所示 接着就是 调整 参数 调整 参数 绘制 图谱 设置 外观 如 下图 所示 主要 包括 颜色 大小 标签 颜色 标签 尺寸 第一步 设置 节点 大小 和 颜色 选中 颜色 点击 数值 设定 选择 渲染 方式 为 度 显示 结果 如下 所示 接着 设置 节点 大小 数值 设 定为 度 最小 尺寸 为 最大 尺寸 为 第二步 设置 模块化 在 右边 统计 中 点击 运行 设置 模块 性 第三步 设置 平均 路径 长度 在 右边 统计 中 点击 运行 设置 边 概述 第四步 重新 设置 节点 属性 节点 大小 数值 设 定为 度 最小值 还是 最大值 还是 节点 颜色 数值 设 定为 modularityclass 表示 模块化 第五步 设置 边 大小 和 颜色 设置 边 颜色 的 数值 设 定为 边 的 权重 如 下图 所示 设置 边 的 大小 数值 设 定为 边 的 权重 第六步 在 布局 中 选择 调 整区 重力 和 速度 显示 结果 如下 所示 第七步 点击 预览 设置 宋体字 显示 标签 透明度 调整 为 如 下图 所示 最终 结构 如 下图 所示 导出 pngpdfsvg 如 下图 所示 图谱 优化 第一步 图谱 调整 选择 喜欢 的 颜色 边 的 厚度 调整 最终 显示 结果 如 下图 所示 第二步 权重 过滤 我们 可以 使用 滤波 功能 过滤 一些 不重要 的 点 让 重要 的 点 清晰可见 滤波 可 以对 节点 做 过滤 也 可以 对边 做 过滤 节点 过滤 在 属性 中 可以 做到 节点 的 过滤 可以 通过 节点 的 lableweight 做 等于 范围 值 非 空等 过滤 如 下图 就是 通过 节点 的 weight 进行了 范围 的 过滤 过滤 掉了 低 weight 值 的 节点 让 这个 图形 不重要 的 节点 变少 在 右上 有 一个 上下文 展示 的 节点 量 边 量 做完 过滤 之后 这块 会 展示 过滤 后 的 量 和 占 比做 完了 过滤 之后 仍然 可以 继续 执行 布局 的 自动 运行 直到 节点 的 排列 符合 你 的 目的 从 下图 可以 看到 一个 大 的 社群 由 三个 小 社群 组成 粉色 圈 黑色 圈 和 部分 灰色 圈 他们 之间 通过 两个 uid 彼此 链 接在 了 一起 将 一个 粉 圈 的 头目 和 一个 黑 圈 头目 看似 一点 也 不相关 的 账户 给 联系 在 了 一起 是不是 就 达 到了 通过 一个 用户 查 找到 群体 的 目的 呀 最后 删 除掉 无 关联 的 节点 可以 移 动到 一起 区域 删除 最终 得到 如 下图 所示 的 知识 图谱 不知道 是否 有 更好 的 方法 最终 得到 如 下图 所示 的 知识 图谱 我们 也 可以 设置 其他 布局 如 下图 所示 最终 如 下图 所示 如果 增加 停 用词 过滤 效果 更 好些 六 总结 写到 这里 第五篇 yq 分析 的 文章 就 讲解 完毕 希望 对 您 有所 帮助 尤其是 想 写 文本 挖掘 论文 的 读者 后续 还会 分享 舆情 分析 威胁 情报 溯源 预测 预警 及 ai 和 nlp 应用 等 如果 文章 对 您 有所 帮助 将是 我 写作 的 最大 动力 作者 将 源代码 上传 至 github 大家 可以 直接 下载 你们 的 支持 就是 我 撰写 的 最大 动力 加油 同时 向 钟 院士 致敬 向 一线 工作者 致敬 侠之大者 为国为民 咱们 中国人 一生 的 最高 追求 为 天地 立 心 为 生民 立 命为 往 圣 继 绝学 为 万世 开 太平 以 一人 之 力系 万民 康乐 以 一身 犯 险 保 大业 安全 他们 真是 做 到了 武汉 加油 中国 加油 byeastmount 周末 下午 点 于 贵阳 参考文献 关系 图谱 一 gephi 通过 共 现 矩阵 构建 知 网 作者 关系 图谱 关系 图谱 二 gephi 导入 共线 矩阵 构建 作者 关系 图谱 python 知识 图谱 一 哈工大 pyltp 安装 及 中文 分句 中文 分词 导入 词典 基本 用法 python 知识 图谱 二 哈工大 pyltp 词性 标注 命名 实体 识别 依存 句法分析 和 语义 角色 标注 python 知识 图谱 三 jieba 工具 中文 分词 添加 自定义 词典 及 词性 标注 详解 python 知识 图谱 四 python 和 gephi 实现 中国 知 网 合作关系 知识 图谱 知识 图谱 相关 会议 之 观后感 分享 与 学习 总结 中文 知识 图谱 研讨会 的 学习 总结 上 图谱 引入 百度 知心 搜狗 知 立方 搜索引擎 和 知识 图谱 那些 事 上 基础 篇 gephi 的 使 用以 社交 网络 图为 例 yanligephi 简易 学习 六 拓展 分析 红楼梦 数据 